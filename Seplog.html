<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Seplog.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="doc">
Separation logic. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk0"><span class="kn">From</span> Coq <span class="kn">Require Import</span> ZArith Lia Bool List Program.Equality.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> FunctionalExtensionality PropExtensionality.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> CDF <span class="kn">Require Import</span> Separation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> Z_scope.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">1. A language of pointers</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We now define a small programming language to work with pointers to
    mutable state.  The language has variables, but these variables are
    immutable.  This in unlike IMP but like ML: mutable variables are
    expressed as immutable pointers (references) to mutable state. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
As in ML too, we blur the distinction between expressions and commands.
    Every command returns a value, which we take to be an integer,
    in addition to possibly performing effects. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We use higher-order abstract syntax to represent commands in this
    language.  With first-order abstract syntax, a "let" binding
    <span class="inlinecode"><span class="id" title="keyword">let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="tactic">in</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> would be represented using the constructor 
<pre>
    LET: forall (x: ident) (a b: com), com
</pre>
    With higher-order syntax, we use a Coq function <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">‚áí</span> <span class="inlinecode"><span class="id" title="var">b</span></span> to
    represent the binding of <span class="inlinecode"><span class="id" title="var">x</span></span> inside <span class="inlinecode"><span class="id" title="var">b</span></span>:
<pre>
    LET: forall (a: com) (b: Z -&gt; com), com
</pre>
    As a benefit, we can use any Coq expression of type <span class="inlinecode"><span class="id" title="var">Z</span></span> as a
    pure command of the language, making it unnecessary to define
    syntax and semantics for a specific expression language.

</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoInductive</span> <span class="nf">com</span>: <span class="kt">Type</span> :=
  | PURE (x: Z)                         <span class="sd">(**r command without effects *)</span>
  | LET (c: com) (f: Z -&gt; com)          <span class="sd">(**r sequencing of commands *)</span>
  | IFTHENELSE (b: Z) (c1 c2: com)      <span class="sd">(**r conditional *)</span>
  | ALLOC (sz: nat)                     <span class="sd">(**r allocate [sz] words of storage *)</span>
  | GET (l: addr)                       <span class="sd">(**r dereference a pointer *)</span>
  | SET (l: addr) (v: Z)                <span class="sd">(**r assign through a pointer *)</span>
  | FREE (l: addr)                      <span class="sd">(**r free one word of storage *)</span>
  | PICK (n: Z).                        <span class="sd">(**r pick a number between 0 and [n] *)</span></span></span></pre><div class="doc">
Some derived forms. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">SKIP</span>: com := PURE <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">SEQ</span> (<span class="nv">c1</span> <span class="nv">c2</span>: com) := LET c1 (<span class="kr">fun</span> <span class="nv">_</span> =&gt; c2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">EITHER</span> (<span class="nv">c1</span> <span class="nv">c2</span>: com) := LET (PICK <span class="mi">2</span>) (<span class="kr">fun</span> <span class="nv">n</span> =&gt; IFTHENELSE n c1 c2).</span></span></pre><div class="doc">
Reduction semantics. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">red</span>: com * heap -&gt; com * heap -&gt; <span class="kt">Prop</span> :=
  | red_pick: <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">i</span> <span class="nv">h</span>,
      <span class="mi">0</span> &lt;= i &lt; n -&gt;
      <span class="nb">red</span> (PICK n, h) (PURE i, h)
  | red_let_done: <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">f</span> <span class="nv">h</span>,
      <span class="nb">red</span> (LET (PURE x) f, h) (f x, h)
  | red_let_step: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> <span class="nv">h</span> <span class="nv">c&#39;</span> <span class="nv">h&#39;</span>,
      <span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
      <span class="nb">red</span> (LET c f, h) (LET c&#39; f, h&#39;)
  | red_ifthenelse: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">h</span>,
      <span class="nb">red</span> (IFTHENELSE b c1 c2, h) ((<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1), h)
  | red_alloc: <span class="kr">forall</span> <span class="nv">sz</span> (<span class="nv">h</span>: heap) <span class="nv">l</span>,
      (<span class="kr">forall</span> <span class="nv">i</span>, l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
      l &lt;&gt; <span class="mi">0</span> -&gt;
      <span class="nb">red</span> (ALLOC sz, h) (PURE l, hinit l sz h)
  | red_get: <span class="kr">forall</span> <span class="nv">l</span> (<span class="nv">h</span>: heap) <span class="nv">v</span>,
      h l = Some v -&gt;
      <span class="nb">red</span> (GET l, h) (PURE v, h)
  | red_set: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> (<span class="nv">h</span>: heap),
      h l &lt;&gt; None -&gt;
      <span class="nb">red</span> (SET l v, h) (SKIP, hupdate l v h)
  | red_free: <span class="kr">forall</span> <span class="nv">l</span> (<span class="nv">h</span>: heap),
      h l &lt;&gt; None -&gt;
      <span class="nb">red</span> (FREE l, h) (SKIP, hfree l h).</span></span></pre><div class="doc">
Absence of run-time errors. <span class="inlinecode"><span class="id" title="var">immsafe</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> holds if <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">/</span> <span class="inlinecode"><span class="id" title="var">h</span></span> is not
    going to abort immediately on a run-time error, such as dereferencing 
    an invalid pointer. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">immsafe</span>: com * heap -&gt; <span class="kt">Prop</span> :=
  | immsafe_pure: <span class="kr">forall</span> <span class="nv">v</span> <span class="nv">h</span>,
      immsafe (PURE v, h)
  | immsafe_let: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> <span class="nv">h</span>,
      immsafe (c, h) -&gt; immsafe (LET c f, h)
  | immsafe_ifthenelse: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">h</span>,
      immsafe (IFTHENELSE b c1 c2, h)
  | immsafe_alloc: <span class="kr">forall</span> <span class="nv">sz</span> (<span class="nv">h</span>: heap) <span class="nv">l</span>,
      l &lt;&gt; <span class="mi">0</span> -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
      immsafe (ALLOC sz, h)
  | immsafe_get: <span class="kr">forall</span> <span class="nv">l</span> (<span class="nv">h</span>: heap),
      h l &lt;&gt; None -&gt; immsafe (GET l, h)
  | immsafe_set: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> (<span class="nv">h</span>: heap),
      h l &lt;&gt; None -&gt; immsafe (SET l v, h)
  | immsafe_free: <span class="kr">forall</span> <span class="nv">l</span> (<span class="nv">h</span>: heap),
      h l &lt;&gt; None -&gt; immsafe (FREE l, h)
  | immsafe_pick: <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">h</span>,
      immsafe (PICK n, h).</span></span></pre><div class="doc">
<a id="lab2"></a><h1 class="section">2.  The rules of separation logic</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">precond</span> := assertion.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">postcond</span> := Z -&gt; assertion.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">2.1.  Semantic definition of strong triples</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Instead of axiomatizing the rules of separation logic, then prove
    their soundness against the operational semantics, we define
    triples <span class="inlinecode"></span> <span class="inlinecode">‚¶É</span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">‚¶Ñ</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">‚¶É</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode">‚¶Ñ</span> <span class="inlinecode"></span> directly in terms of the
    operational semantics, then show the rules of separation logic as
    lemmas about these semantic triples.

<div class="paragraph"> </div>

    Note: the way triples are defined below, they are strong triples
    that guarantee termination.  However, we write them with braces
    instead of brackets, for consistency with the third lecture
    and with the literature on separation logic.
 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<span class="inlinecode"><span class="id" title="var">safe</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds if <span class="inlinecode"><span class="id" title="var">c</span></span> started in <span class="inlinecode"><span class="id" title="var">h</span></span> always terminates without errors,
    and when it terminates with value <span class="inlinecode"><span class="id" title="var">v</span></span>, the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> holds
    of the final heap. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">safe</span>: com -&gt; heap -&gt; postcond -&gt; <span class="kt">Prop</span> :=
  | safe_done: <span class="kr">forall</span> <span class="nv">v</span> <span class="nv">h</span> (<span class="nv">Q</span>: postcond),
      Q v h -&gt;
      safe (PURE v) h Q
  | safe_step: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span> <span class="nv">Q</span>,
      <span class="kr">match</span> c <span class="kr">with</span> PURE _ =&gt; <span class="kt">False</span> | _ =&gt; <span class="kt">True</span> <span class="kr">end</span> -&gt;
      immsafe (c, h) -&gt;
      (<span class="kr">forall</span> <span class="nv">c&#39;</span> <span class="nv">h&#39;</span>, <span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q) -&gt;
      safe c h Q.</span></span></pre><div class="doc">
We define semantic triples like we did for Hoare logic: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">triple</span> (<span class="nv">P</span>: precond) (<span class="nv">c</span>: com) (<span class="nv">Q</span>: postcond) :=
  <span class="kr">forall</span> <span class="nv">h</span>, P h -&gt; safe c h Q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ&quot;</span> := (triple P c Q) (<span class="kn">at level</span> <span class="mi">90</span>, c <span class="kn">at next level</span>).</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">2.2. The frame rule</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The frame rule is valid because the operational semantics has nice
    properties with respect to heap extension: if a command is safe
    in a small heap, it is safe in a bigger heap, and any reduction
    from the bigger heap is simulated by a reduction from the smaller heap. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">inv</span> H := <span class="nb">inversion</span> H; <span class="nb">clear</span> H; <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1"><span class="kn">Lemma</span> <span class="nf">immsafe_frame</span>: <span class="kr">forall</span> <span class="nv">h&#39;</span> <span class="nv">c</span> <span class="nv">h</span>,
  immsafe (c, h) -&gt; hdisjoint h h&#39; -&gt; immsafe (c, hunion h h&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h&#39;</span> : heap) (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap),
immsafe (c, h) -&gt;
hdisjoint h h&#39; -&gt; immsafe (c, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h&#39;</span> : heap) (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap),
immsafe (c, h) -&gt;
hdisjoint h h&#39; -&gt; immsafe (c, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3"><span class="nb">intros</span> h&#39; c h IMM; <span class="nb">dependent induction</span> IMM; <span class="nb">intros</span> DISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PURE v, hunion h h&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>IMM</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h)</span></span></span><br><span><var>IHIMM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h0</span> : heap),
(c0, h) = (c, h0) -&gt;
hdisjoint h0 h&#39; -&gt; immsafe (c, hunion h0 h&#39;)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk4"><hr></label><div class="goal-conclusion">immsafe (LET c0 f, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk5"><hr></label><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk6"><hr></label><div class="goal-conclusion">immsafe (ALLOC sz, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk7"><hr></label><div class="goal-conclusion">immsafe (GET l, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk8"><hr></label><div class="goal-conclusion">immsafe (SET l v, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk9"><hr></label><div class="goal-conclusion">immsafe (FREE l, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chka"><hr></label><div class="goal-conclusion">immsafe (PICK n, hunion h h&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PURE v, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>IMM</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h)</span></span></span><br><span><var>IHIMM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h0</span> : heap),
(c0, h) = (c, h0) -&gt;
hdisjoint h0 h&#39; -&gt; immsafe (c, hunion h0 h&#39;)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (LET c0 f, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf"><span class="nb">destruct</span> (isfinite (hunion h h&#39;)) <span class="kr">as</span> [l&#39; FIN].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10"><span class="nb">apply</span> immsafe_alloc <span class="kr">with</span> (Z.max <span class="mi">1</span> l&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z.max <span class="mi">1</span> l&#39; &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk11"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : Z,
Z.max <span class="mi">1</span> l&#39; &lt;= i &lt; Z.max <span class="mi">1</span> l&#39; + Z.of_nat sz -&gt;
hunion h h&#39; i = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : Z,
Z.max <span class="mi">1</span> l&#39; &lt;= i &lt; Z.max <span class="mi">1</span> l&#39; + Z.of_nat sz -&gt;
hunion h h&#39; i = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Z.max <span class="mi">1</span> l&#39; &lt;= i &lt; Z.max <span class="mi">1</span> l&#39; + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h h&#39; i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14"><span class="nb">apply</span> FIN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l&#39; &lt;= j -&gt; hunion h h&#39; j = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Z.max <span class="mi">1</span> l&#39; &lt;= i &lt; Z.max <span class="mi">1</span> l&#39; + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l&#39; &lt;= i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (GET l, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h h&#39; l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h&#39; l) &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h l); <span class="bp">congruence</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (SET l v, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk19"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h h&#39; l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h&#39; l) &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h l); <span class="bp">congruence</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (FREE l, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h h&#39; l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h&#39; l) &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h l); <span class="bp">congruence</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PICK n, hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f"><span class="kn">Lemma</span> <span class="nf">red_frame</span>: <span class="kr">forall</span> <span class="nv">h2</span> <span class="nv">c</span> <span class="nv">h1</span> <span class="nv">c&#39;</span> <span class="nv">h&#39;</span>,
  <span class="nb">red</span> (c, hunion h1 h2) (c&#39;, h&#39;) -&gt;
  immsafe (c, h1) -&gt;
  hdisjoint h1 h2 -&gt;
  <span class="kr">exists</span> <span class="nv">h1&#39;</span>, <span class="nb">red</span> (c, h1) (c&#39;, h1&#39;) /\ hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h2</span> : heap) (<span class="nv">c</span> : com) (<span class="nv">h1</span> : heap) (<span class="nv">c&#39;</span> : com)
  (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, hunion h1 h2) (c&#39;, h&#39;) -&gt;
immsafe (c, h1) -&gt;
hdisjoint h1 h2 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h1) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk20"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h2</span> : heap) (<span class="nv">c</span> : com) (<span class="nv">h1</span> : heap) (<span class="nv">c&#39;</span> : com)
  (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, hunion h1 h2) (c&#39;, h&#39;) -&gt;
immsafe (c, h1) -&gt;
hdisjoint h1 h2 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h1) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk21"><span class="nb">intros until</span> h&#39;; <span class="nb">intros</span> RED; <span class="nb">dependent induction</span> RED; <span class="nb">intros</span> IMM DISJ; inv IMM.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (PICK n, h1) (PURE i, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>x</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (PURE x, h1)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk22"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (LET (PURE x) f, h1) (f x, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk23" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, hunion h1 h2) (c&#39;0, h&#39;)</span></span></span><br><span><var>IHRED</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">h3</span> : heap) (<span class="nv">c</span> : com) 
  (<span class="nv">h4</span> : heap) (<span class="nv">c&#39;</span> : com) 
  (<span class="nv">h&#39;0</span> : heap),
(c0, hunion h1 h2) = (c, hunion h4 h3) -&gt;
(c&#39;0, h&#39;) = (c&#39;, h&#39;0) -&gt;
immsafe (c, h4) -&gt;
hdisjoint h4 h3 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h4) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h3 /\ h&#39;0 = hunion h1&#39; h3</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h1)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk23"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (LET c0 f, h1) (LET c&#39;0 f, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk24"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (IFTHENELSE b c1 c2, h1)
    (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk25"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (ALLOC sz, h1) (PURE l, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hinit l sz (hunion h1 h2) = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk26"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (GET l, h1) (PURE v, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk27" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk27"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (SET l v, h1) (PURE <span class="mi">0</span>, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hupdate l v (hunion h1 h2) = hunion h1&#39; h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk28"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (FREE l, h1) (PURE <span class="mi">0</span>, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hfree l (hunion h1 h2) = hunion h1&#39; h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk29">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (PICK n, h1) (PURE i, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a"><span class="kr">exists</span> <span class="nv">h1</span>; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (PICK n, h1) (PURE i, h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>x</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (PURE x, h1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (LET (PURE x) f, h1) (f x, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c"><span class="kr">exists</span> <span class="nv">h1</span>; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>x</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (PURE x, h1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (LET (PURE x) f, h1) (f x, h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, hunion h1 h2) (c&#39;0, h&#39;)</span></span></span><br><span><var>IHRED</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">h3</span> : heap) (<span class="nv">c</span> : com) 
  (<span class="nv">h4</span> : heap) (<span class="nv">c&#39;</span> : com) 
  (<span class="nv">h&#39;0</span> : heap),
(c0, hunion h1 h2) = (c, hunion h4 h3) -&gt;
(c&#39;0, h&#39;) = (c&#39;, h&#39;0) -&gt;
immsafe (c, h4) -&gt;
hdisjoint h4 h3 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h4) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h3 /\ h&#39;0 = hunion h1&#39; h3</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (LET c0 f, h1) (LET c&#39;0 f, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e"><span class="nb">edestruct</span> IHRED <span class="kr">as</span> (h1&#39; &amp; R &amp; D &amp; U); <span class="nb">eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, hunion h1 h2) (c&#39;0, h&#39;)</span></span></span><br><span><var>IHRED</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">h3</span> : heap) (<span class="nv">c</span> : com) 
  (<span class="nv">h4</span> : heap) (<span class="nv">c&#39;</span> : com) 
  (<span class="nv">h&#39;0</span> : heap),
(c0, hunion h1 h2) = (c, hunion h4 h3) -&gt;
(c&#39;0, h&#39;) = (c&#39;, h&#39;0) -&gt;
immsafe (c, h4) -&gt;
hdisjoint h4 h3 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h4) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h3 /\ h&#39;0 = hunion h1&#39; h3</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h1)</span></span></span><br><span><var>h1'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, h1) (c&#39;0, h1&#39;)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h&#39; = hunion h1&#39; h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (LET c0 f, h1) (LET c&#39;0 f, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ h&#39; = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f"><span class="kr">exists</span> <span class="nv">h1&#39;</span>; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, hunion h1 h2) (c&#39;0, h&#39;)</span></span></span><br><span><var>IHRED</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">h3</span> : heap) (<span class="nv">c</span> : com) 
  (<span class="nv">h4</span> : heap) (<span class="nv">c&#39;</span> : com) 
  (<span class="nv">h&#39;0</span> : heap),
(c0, hunion h1 h2) = (c, hunion h4 h3) -&gt;
(c&#39;0, h&#39;) = (c&#39;, h&#39;0) -&gt;
immsafe (c, h4) -&gt;
hdisjoint h4 h3 -&gt;
<span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (c, h4) (c&#39;, h1&#39;) /\
  hdisjoint h1&#39; h3 /\ h&#39;0 = hunion h1&#39; h3</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c0, h1)</span></span></span><br><span><var>h1'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c0, h1) (c&#39;0, h1&#39;)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h&#39; = hunion h1&#39; h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (LET c0 f, h1) (LET c&#39;0 f, h1&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk30">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (IFTHENELSE b c1 c2, h1)
    (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk31"><span class="kr">exists</span> <span class="nv">h1</span>; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (IFTHENELSE b c1 c2, h1)
  (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1, h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk32">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (ALLOC sz, h1) (PURE l, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hinit l sz (hunion h1 h2) = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33"><span class="kr">exists</span> (<span class="nv">hinit</span> <span class="nv">l</span> <span class="nv">sz</span> <span class="nv">h1</span>); <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (ALLOC sz, h1) (PURE l, hinit l sz h1)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk34"><hr></label><div class="goal-conclusion">hdisjoint (hinit l sz h1) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk35" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk35"><hr></label><div class="goal-conclusion">hinit l sz (hunion h1 h2) = hunion (hinit l sz h1) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (ALLOC sz, h1) (PURE l, hinit l sz h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : Z, l &lt;= i &lt; l + Z.of_nat sz -&gt; h1 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39"><span class="nb">apply</span> H <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a"><span class="nb">cbn</span> <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h1 i <span class="kr">then</span> h1 i <span class="kr">else</span> h2 i) = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 i); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hinit l sz h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c"><span class="nb">red</span>; <span class="nb">cbn</span>; <span class="nb">intros</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d"><span class="nb">assert</span> (EITHER: l &lt;= i &lt; l + Z.of_nat sz \/ (i &lt; l \/ l + Z.of_nat sz &lt;= i)) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>EITHER</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz \/
i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3e"><span class="nb">destruct</span> EITHER.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3f"><hr></label><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk40">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk41"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk42"><span class="nb">apply</span> H <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk43"><span class="nb">cbn</span> <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h1 i <span class="kr">then</span> h1 i <span class="kr">else</span> h2 i) = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 i), (h2 i); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk44">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz h1 i = None \/ h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk45"><span class="nb">rewrite</span> hinit_outside <span class="bp">by</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None \/ h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> DISJ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk46">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) = hunion (hinit l sz h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk47"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> i; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk48"><span class="nb">assert</span> (EITHER: l &lt;= i &lt; l + Z.of_nat sz \/ (i &lt; l \/ l + Z.of_nat sz &lt;= i)) <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>EITHER</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz \/
i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk49"><span class="nb">destruct</span> EITHER.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk4a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk4a"><hr></label><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk4b">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk4c"><span class="nb">rewrite</span> ! hinit_inside <span class="bp">by</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>l &lt;= i &lt; l + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk4d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit l sz (hunion h1 h2) i =
(<span class="kr">if</span> hinit l sz h1 i <span class="kr">then</span> hinit l sz h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk4e"><span class="nb">rewrite</span> ! hinit_outside <span class="bp">by</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hunion h1 h2 i = None</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>l = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>l0 = <span class="mi">0</span> -&gt; <span class="kt">False</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l0 &lt;= i &lt; l0 + Z.of_nat sz -&gt; h1 i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>i &lt; l \/ l + Z.of_nat sz &lt;= i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 i = (<span class="kr">if</span> h1 i <span class="kr">then</span> h1 i <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk4f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (GET l, h1) (PURE v, h1&#39;) /\
  hdisjoint h1&#39; h2 /\ hunion h1 h2 = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk50"><span class="kr">exists</span> <span class="nv">h1</span>; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (GET l, h1) (PURE v, h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk51"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk52"><span class="nb">cbn</span> <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = Some v</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 l); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk53">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (SET l v, h1) (PURE <span class="mi">0</span>, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hupdate l v (hunion h1 h2) = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk54"><span class="kr">exists</span> (<span class="nv">hupdate</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">h1</span>); <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (SET l v, h1) (PURE <span class="mi">0</span>, hupdate l v h1)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk55"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l v h1) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk56"><hr></label><div class="goal-conclusion">hupdate l v (hunion h1 h2) =
hunion (hupdate l v h1) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk57">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (SET l v, h1) (PURE <span class="mi">0</span>, hupdate l v h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk58">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l v h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk59"><span class="nb">intros</span> i; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> Some v <span class="kr">else</span> h1 i) = None \/
h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk5a"><span class="nb">generalize</span> (DISJ i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None \/ h2 i = None -&gt;
(<span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> Some v <span class="kr">else</span> h1 i) = None \/
h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l i); <span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk5b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v (hunion h1 h2) =
hunion (hupdate l v h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk5c"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> i; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l i
 <span class="kr">then</span> Some v
 <span class="kr">else</span> <span class="kr">if</span> h1 i <span class="kr">then</span> h1 i <span class="kr">else</span> h2 i) =
(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> Some v <span class="kr">else</span> h1 i
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> Some v <span class="kr">else</span> h1 i
 <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l i); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk5d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1&#39;</span> : heap,
  <span class="nb">red</span> (FREE l, h1) (PURE <span class="mi">0</span>, h1&#39;) /\
  hdisjoint h1&#39; h2 /\
  hfree l (hunion h1 h2) = hunion h1&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk5e"><span class="kr">exists</span> (<span class="nv">hfree</span> <span class="nv">l</span> <span class="nv">h1</span>); <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (FREE l, h1) (PURE <span class="mi">0</span>, hfree l h1)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk5f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk5f"><hr></label><div class="goal-conclusion">hdisjoint (hfree l h1) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk60" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk60"><hr></label><div class="goal-conclusion">hfree l (hunion h1 h2) = hunion (hfree l h1) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk61">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">red</span> (FREE l, h1) (PURE <span class="mi">0</span>, hfree l h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk62">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hfree l h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk63"><span class="nb">intros</span> i; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> None <span class="kr">else</span> h1 i) = None \/
h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk64"><span class="nb">generalize</span> (DISJ i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 i = None \/ h2 i = None -&gt;
(<span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> None <span class="kr">else</span> h1 i) = None \/
h2 i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l i); <span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk65">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfree l (hunion h1 h2) = hunion (hfree l h1) h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk66"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> i; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l i
 <span class="kr">then</span> None
 <span class="kr">else</span> <span class="kr">if</span> h1 i <span class="kr">then</span> h1 i <span class="kr">else</span> h2 i) =
(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> None <span class="kr">else</span> h1 i
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l i <span class="kr">then</span> None <span class="kr">else</span> h1 i
 <span class="kr">else</span> h2 i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk67"><span class="nb">destruct</span> (Z.eq_dec l i); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = h2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk68"><span class="nb">subst</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk69"><span class="nb">generalize</span> (DISJ l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h2, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = None -&gt; <span class="kt">False</span></span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = None -&gt; <span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = None \/ h2 l = None -&gt; None = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk6a"><span class="kn">Lemma</span> <span class="nf">safe_frame</span>:
  <span class="kr">forall</span> (<span class="nv">R</span>: assertion) <span class="nv">h&#39;</span>, R h&#39; -&gt;
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span> <span class="nv">Q</span>,
  safe c h Q -&gt; hdisjoint h h&#39; -&gt; safe c (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">h&#39;</span> : heap),
R h&#39; -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe c h Q -&gt;
hdisjoint h h&#39; -&gt;
safe c (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk6b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">h&#39;</span> : heap),
R h&#39; -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe c h Q -&gt;
hdisjoint h h&#39; -&gt;
safe c (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk6c"><span class="nb">induction</span> <span class="mi">2</span>; <span class="nb">intros</span> DISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk6d"><hr></label><div class="goal-conclusion">safe c (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk6e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk6f"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q v ** R) (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h</span>, h&#39;; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk70">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c (hunion h h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk71"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk72" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk72"><hr></label><div class="goal-conclusion">immsafe (c, hunion h h&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk73"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, h&#39;0) -&gt;
safe c&#39; h&#39;0 (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk74"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (c, hunion h h&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk75"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, h&#39;0) -&gt;
safe c&#39; h&#39;0 (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk76"><span class="nb">apply</span> immsafe_frame; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, h&#39;0) -&gt;
safe c&#39; h&#39;0 (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk77"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, h&#39;0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39;0 (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk78"><span class="nb">edestruct</span> red_frame <span class="kr">as</span> (h1&#39; &amp; RED1 &amp; D &amp; U); <span class="nb">eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, h&#39;0)</span></span></span><br><span><var>h1'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED1</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;, h1&#39;)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h&#39;</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h&#39;0 = hunion h1&#39; h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39;0 (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk79"><span class="nb">subst</span> h&#39;0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h&#39;</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;0) -&gt;
hdisjoint h&#39;0 h&#39; -&gt;
safe c&#39; (hunion h&#39;0 h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h1'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, hunion h h&#39;) (c&#39;, hunion h1&#39; h&#39;)</span></span></span><br><span><var>RED1</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;, h1&#39;)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; (hunion h1&#39; h&#39;) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H3; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7a"><span class="kn">Lemma</span> <span class="nf">triple_frame</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">R</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">R</span> : assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">R</span> : assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7c"><span class="nb">intros</span> P c Q R TR h (h1 &amp; h2 &amp; P1 &amp; R2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7d"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c (hunion h1 h2) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> safe_frame; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">2.3. The "small rules" for heap operations</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7e"><span class="kn">Lemma</span> <span class="nf">triple_get</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span>,
  ‚¶É contains l v ‚¶Ñ GET l ‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É contains l v ‚¶Ñ GET l
‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk7f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É contains l v ‚¶Ñ GET l
‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk80"><span class="nb">intros</span> l v h P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk81"><span class="nb">assert</span> (L: h l = Some v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk82" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk82"><hr></label><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk83">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk84"><span class="nb">red</span> <span class="kr">in</span> P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk85"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v hempty l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk86">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk87"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (GET l, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk88" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk88"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (GET l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk89">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (GET l, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8a"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (GET l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8c"><span class="nb">intros</span> c&#39; h&#39; RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (GET l, h) (c&#39;, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8d">inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h&#39; l = Some v</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h&#39;</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h&#39; l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v0) h&#39;
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8e"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h&#39; l = Some v</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v h&#39;</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h&#39; l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((v0 = v) //\\ contains l v) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk8f"><span class="kn">Lemma</span> <span class="nf">triple_set</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span>,
  ‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> =&gt; contains l v ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk90"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk91"><span class="nb">intros</span> l v h (v0 &amp; P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk92"><span class="nb">assert</span> (L: h l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk93"><hr></label><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk94">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span> <span class="kr">in</span> P; <span class="nb">subst</span> h; <span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk95">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk96"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (SET l v, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk97" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk97"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk98">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (SET l v, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk99"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9b"><span class="nb">intros</span> c&#39; h&#39; RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9c">inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe SKIP (hupdate l v h) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9d"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v (hupdate l v h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9e"><span class="nb">red</span> <span class="kr">in</span> P; <span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v, v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v (hupdate l v (hupdate l v0 hempty))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk9f"><span class="nb">red</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v, v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v (hupdate l v0 hempty) = hupdate l v hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka0"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> l&#39;; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v, v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some v
 <span class="kr">else</span> <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v0 <span class="kr">else</span> None) =
(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> None)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l l&#39;); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">valid_N</span> (<span class="nv">l</span>: addr) (<span class="nv">sz</span>: nat) : assertion :=
  <span class="kr">match</span> sz <span class="kr">with</span> O =&gt; emp | S sz =&gt; valid l ** valid_N (l + <span class="mi">1</span>) sz <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka1"><span class="kn">Remark</span> <span class="nf">valid_N_init</span>: <span class="kr">forall</span> <span class="nv">sz</span> <span class="nv">l</span>,
  (valid_N l sz) (hinit l sz hempty).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">sz</span> : nat) (<span class="nv">l</span> : addr),
valid_N l sz (hinit l sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">sz</span> : nat) (<span class="nv">l</span> : addr),
valid_N l sz (hinit l sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka3"><span class="nb">induction</span> sz <span class="kr">as</span> [ | sz]; <span class="nb">intros</span> l; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp hempty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chka4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chka4"><hr></label><div class="goal-conclusion">(valid l ** valid_N (l + <span class="mi">1</span>) sz)
  (hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz hempty))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l ** valid_N (l + <span class="mi">1</span>) sz)
  (hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz hempty))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chka7"><span class="kr">exists</span> (<span class="nv">hupdate</span> <span class="nv">l</span> <span class="mi">0</span> <span class="nv">hempty</span>), (hinit (l + <span class="mi">1</span>) sz hempty); <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (hupdate l <span class="mi">0</span> hempty)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chka8"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty)
  (hinit (l + <span class="mi">1</span>) sz hempty)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chka9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chka9"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz hempty) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz hempty)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkaa">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (hupdate l <span class="mi">0</span> hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkab"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l <span class="mi">0</span> (hupdate l <span class="mi">0</span> hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkac">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty)
  (hinit (l + <span class="mi">1</span>) sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkad"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> hempty x = None \/
hinit (l + <span class="mi">1</span>) sz hempty x = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkae"><span class="nb">unfold</span> hupdate, hempty; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None) = None \/
hinit (l + <span class="mi">1</span>) sz
  {|
    contents := <span class="kr">fun</span> <span class="nv">_</span> : addr =&gt; None;
    isfinite := Separation.hempty_obligation_1
  |} x = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkaf"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = None \/
hinit (l + <span class="mi">1</span>) sz
  {|
    contents := <span class="kr">fun</span> <span class="nv">_</span> : addr =&gt; None;
    isfinite := Separation.hempty_obligation_1
  |} x = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb0"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit (l + <span class="mi">1</span>) sz
  {|
    contents := <span class="kr">fun</span> <span class="nv">_</span> : addr =&gt; None;
    isfinite := Separation.hempty_obligation_1
  |} x = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb1"><span class="nb">rewrite</span> hinit_outside <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  contents := <span class="kr">fun</span> <span class="nv">_</span> : addr =&gt; None;
  isfinite := Separation.hempty_obligation_1
|} x = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz hempty) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb3"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz hempty) x =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz hempty)
  x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb4"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
valid_N l sz (hinit l sz hempty)</span></span></span><br><span><var>l, x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz hempty x) =
(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz hempty x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb5"><span class="kn">Lemma</span> <span class="nf">triple_alloc</span>: <span class="kr">forall</span> <span class="nv">sz</span>,
  ‚¶É emp ‚¶Ñ
  ALLOC sz
  ‚¶É <span class="kr">fun</span> <span class="nv">l</span> =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">sz</span> : nat,
‚¶É emp ‚¶Ñ ALLOC sz
‚¶É <span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">sz</span> : nat,
‚¶É emp ‚¶Ñ ALLOC sz
‚¶É <span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb7"><span class="nb">intros</span> sz h P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (ALLOC sz) h
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb8"><span class="nb">red</span> <span class="kr">in</span> P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (ALLOC sz) h
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkb9"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (ALLOC sz) hempty
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkba"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, hempty)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkbb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkbb"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (ALLOC sz, hempty) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkbc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkbd"><span class="nb">apply</span> immsafe_alloc <span class="kr">with</span> <span class="mi">1</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> &lt;= i &lt; <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkbe"><hr></label><div class="goal-conclusion">hempty i = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkbf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> &lt;&gt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc0">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> &lt;= i &lt; <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hempty i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (ALLOC sz, hempty) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc2"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hempty i = None</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE l) (hinit l sz hempty)
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc3"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hempty i = None</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz) (hinit l sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc4"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; hempty i = None</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid_N l sz (hinit l sz hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_N_init; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc5"><span class="kn">Lemma</span> <span class="nf">triple_free</span>: <span class="kr">forall</span> <span class="nv">l</span>,
  ‚¶É valid l ‚¶Ñ
  FREE l
  ‚¶É <span class="kr">fun</span> <span class="nv">_</span> =&gt; emp ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
‚¶É valid l ‚¶Ñ FREE l ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
‚¶É valid l ‚¶Ñ FREE l ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc7"><span class="nb">intros</span> l h (v0 &amp; P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>contains l v0 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc8"><span class="nb">red</span> <span class="kr">in</span> P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkc9"><span class="nb">assert</span> (L: h l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkca"><hr></label><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkcb">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkcc"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v0 hempty l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkcd">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkce"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (FREE l, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkcf"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (FREE l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (FREE l, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd1"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>h = hupdate l v0 hempty</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (FREE l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd3"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe SKIP (hfree l (hupdate l v0 hempty))
  (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd4"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp (hfree l (hupdate l v0 hempty))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd5"><span class="nb">red</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfree l (hupdate l v0 hempty) = hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd6"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfree l (hupdate l v0 hempty) x = hempty x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd7"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l &lt;&gt; None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x
 <span class="kr">then</span> None
 <span class="kr">else</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some v0 <span class="kr">else</span> None) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">2.4. Properties of the <span class="inlinecode"><span class="id" title="var">safe</span></span> predicate</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd8"><span class="kn">Lemma</span> <span class="nf">safe_pure</span>: <span class="kr">forall</span> <span class="nv">v</span> <span class="nv">h</span> <span class="nv">Q</span>,
  safe (PURE v) h Q -&gt; Q v h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe (PURE v) h Q -&gt; Q v h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkd9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe (PURE v) h Q -&gt; Q v h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkda"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>safe (PURE v) h Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkdb">inv H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkdc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (PURE v, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PURE v, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkdc"><hr></label><div class="goal-conclusion">Q v h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkdd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkde">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (PURE v, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PURE v, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkdf"><span class="kn">Lemma</span> <span class="nf">safe_red</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span> <span class="nv">Q</span> <span class="nv">c&#39;</span> <span class="nv">h&#39;</span>,
  safe  c h Q -&gt; <span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond) (<span class="nv">c&#39;</span> : com)
  (<span class="nv">h&#39;</span> : heap),
safe c h Q -&gt; <span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond) (<span class="nv">c&#39;</span> : com)
  (<span class="nv">h&#39;</span> : heap),
safe c h Q -&gt; <span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>safe c h Q</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke2">inv H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (PURE v, h) (c&#39;, h&#39;)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; Q</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chke3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;, h&#39;)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chke3"><hr></label><div class="goal-conclusion">safe c&#39; h&#39; Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (PURE v, h) (c&#39;, h&#39;)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">inv H0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;, h&#39;)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke6"><span class="kn">Lemma</span> <span class="nf">safe_immsafe</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span> <span class="nv">Q</span>,
  safe c h Q -&gt; immsafe (c, h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe c h Q -&gt; immsafe (c, h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap) (<span class="nv">Q</span> : postcond),
safe c h Q -&gt; immsafe (c, h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>safe c h Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (c, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chke9">inv H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PURE v, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkea" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkea"><hr></label><div class="goal-conclusion">immsafe (c, h)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkeb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PURE v, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkec">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (c, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chked"><span class="kn">Lemma</span> <span class="nf">safe_let</span>: <span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">R</span>: postcond) <span class="nv">f</span>,
  (<span class="kr">forall</span> <span class="nv">v</span> <span class="nv">h&#39;</span>, Q v h&#39; -&gt; safe (f v) h&#39; R) -&gt;
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span>,
  safe c h Q -&gt;
  safe (LET c f) h R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">R</span> : postcond) (<span class="nv">f</span> : Z -&gt; com),
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap), Q v h&#39; -&gt; safe (f v) h&#39; R) -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap),
safe c h Q -&gt; safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">R</span> : postcond) (<span class="nv">f</span> : Z -&gt; com),
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap), Q v h&#39; -&gt; safe (f v) h&#39; R) -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap),
safe c h Q -&gt; safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkef"><span class="nb">intros</span> Q R f POST.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap),
safe c h Q -&gt; safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf0"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET (PURE v) f) h R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkf1"><hr></label><div class="goal-conclusion">safe (LET c f) h R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET (PURE v) f) h R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf3"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (LET (PURE v) f, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkf4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkf4"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (LET (PURE v) f, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf5">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (LET (PURE v) f, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf6"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PURE v, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf7">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (LET (PURE v) f, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkf8"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (f v) h&#39; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkf9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (PURE v, h) (c&#39;0, h&#39;)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkf9"><hr></label><div class="goal-conclusion">safe (LET c&#39;0 f) h&#39; R</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkfa"><span class="nb">apply</span> POST; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (PURE v, h) (c&#39;0, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET c&#39;0 f) h&#39; R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">inv H1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkfb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkfc"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (LET c f, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chkfd"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (LET c f, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkfe">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (LET c f, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chkff">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (LET c f, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk100"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (PURE x, h&#39;)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (PURE x, h&#39;) (c&#39;, h&#39;0) -&gt; safe c&#39; h&#39;0 Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;0</span> : heap),
<span class="nb">red</span> (PURE x, h&#39;) (c&#39;, h&#39;0) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
 Q v h&#39; -&gt; safe (f v) h&#39; R) -&gt;
safe (LET c&#39; f) h&#39;0 R</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (f x) h&#39; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk101" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;0, h&#39;)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk101"><hr></label><div class="goal-conclusion">safe (LET c&#39;0 f) h&#39; R</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk102"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>POST</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap),
Q v h&#39; -&gt; safe (f v) h&#39; R</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;0</span> : heap),
 Q v h&#39;0 -&gt; safe (f v) h&#39;0 R) -&gt;
safe (LET c&#39; f) h&#39; R</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>c'0</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (c, h) (c&#39;0, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET c&#39;0 f) h&#39; R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk103"><span class="kn">Lemma</span> <span class="nf">safe_consequence</span>: <span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">Q&#39;</span>: postcond),
  (<span class="kr">forall</span> <span class="nv">v</span>, Q v --&gt;&gt; Q&#39; v) -&gt;
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">h</span>, safe c h Q -&gt; safe c h Q&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span> : postcond,
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap), safe c h Q -&gt; safe c h Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk104"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span> : postcond,
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt;
<span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap), safe c h Q -&gt; safe c h Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk105"><span class="nb">intros</span> Q Q&#39; IMP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">h</span> : heap), safe c h Q -&gt; safe c h Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk106"><span class="nb">induction</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) h Q&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk107" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt; safe c&#39; h&#39; Q&#39;</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk107"><hr></label><div class="goal-conclusion">safe c h Q&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk108">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) h Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk109"><span class="nb">apply</span> safe_done.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q&#39; v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10a"><span class="nb">apply</span> IMP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q v h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q', Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">match</span> c <span class="kr">with</span>
| PURE _ =&gt; <span class="kt">False</span>
| _ =&gt; <span class="kt">True</span>
<span class="kr">end</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>immsafe (c, h)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (c, h) (c&#39;, h&#39;) -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt; safe c&#39; h&#39; Q&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> safe_step; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab7"></a><h2 class="section">2.5. Rules for control structures</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10c"><span class="kn">Lemma</span> <span class="nf">triple_pure</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">v</span> (<span class="nv">Q</span>: postcond),
  P --&gt;&gt; Q v -&gt;
  ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10e"><span class="nb">intros</span>; <span class="nb">intros</span> h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk10f"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk110"><span class="kn">Lemma</span> <span class="nf">triple_let</span>:
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> (<span class="nv">P</span>: precond) (<span class="nv">Q</span> <span class="nv">R</span>: postcond),
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  (<span class="kr">forall</span> <span class="nv">v</span>, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
  ‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk111"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk112"><span class="nb">intros until</span> R; <span class="nb">intros</span> HR1 HR2 h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk113"><span class="nb">apply</span> safe_let <span class="kr">with</span> Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap), Q v h&#39; -&gt; safe (f v) h&#39; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk114" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk114"><hr></label><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk115"><span class="nb">apply</span> HR2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk116"><span class="nb">apply</span> HR1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk117"><span class="kn">Lemma</span> <span class="nf">triple_ifthenelse</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">P</span> <span class="nv">Q</span>,
  ‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk118"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk119"><span class="nb">intros until</span> Q; <span class="nb">intros</span> HR1 HR2 h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (IFTHENELSE b c1 c2) h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk11a"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk11b"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (IFTHENELSE b c1 c2, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk11c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk11d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (IFTHENELSE b c1 c2, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk11e"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1) h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk11f"><span class="nb">destruct</span> (Z.eqb_spec b <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c2 h&#39; Q</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk120" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk120"><hr></label><div class="goal-conclusion">safe c1 h&#39; Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk121">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c2 h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk122"><span class="nb">apply</span> HR2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((b = <span class="mi">0</span>) //\\ P) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk123">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c1 h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk124"><span class="nb">apply</span> HR1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((b &lt;&gt; <span class="mi">0</span>) //\\ P) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk125"><span class="kn">Lemma</span> <span class="nf">triple_consequence</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">c</span> <span class="nv">Q&#39;</span> <span class="nv">Q</span>,
  ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
  P --&gt;&gt; P&#39; -&gt; (<span class="kr">forall</span> <span class="nv">v</span>, Q&#39; v --&gt;&gt; Q v) -&gt;
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk126"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk127"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> safe_consequence <span class="kr">with</span> Q&#39;; <span class="nb">auto</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk128"><span class="kn">Lemma</span> <span class="nf">triple_pick</span>: <span class="kr">forall</span> <span class="nv">n</span>,
  ‚¶É emp ‚¶Ñ
  PICK n
  ‚¶É <span class="kr">fun</span> <span class="nv">i</span> =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : Z,
‚¶É emp ‚¶Ñ PICK n ‚¶É <span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk129"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : Z,
‚¶É emp ‚¶Ñ PICK n ‚¶É <span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12a"><span class="nb">intros</span> n h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PICK n) h (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12b"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PICK n, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk12c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk12c"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PICK n, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PICK n, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PICK n, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk12f"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE i) h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk130"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>emp h&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure (<span class="mi">0</span> &lt;= i &lt; n) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab8"></a><h2 class="section">2.6.  Useful derived rules</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The following rules are heavily used in the examples of section 3. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk131"><span class="kn">Lemma</span> <span class="nf">triple_consequence_pre</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  P --&gt;&gt; P&#39; -&gt;
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; P&#39; -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk132"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; P&#39; -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk133"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk134"><span class="nb">apply</span> triple_consequence <span class="kr">with</span> P&#39; Q; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk135"><span class="kn">Lemma</span> <span class="nf">triple_consequence_post</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
  (<span class="kr">forall</span> <span class="nv">v</span>, Q&#39; v --&gt;&gt; Q v) -&gt;
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : Z -&gt; assertion)
  (<span class="nv">Q&#39;</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk136"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : Z -&gt; assertion)
  (<span class="nv">Q&#39;</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk137"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk138"><span class="nb">apply</span> triple_consequence <span class="kr">with</span> P Q&#39;; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --&gt;&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk139"><span class="kn">Lemma</span> <span class="nf">triple_lift_pure</span>: <span class="kr">forall</span> (<span class="nv">P</span>: <span class="kt">Prop</span>) <span class="nv">P&#39;</span> <span class="nv">c</span> <span class="nv">Q</span>,
  (P -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt;
  ‚¶É P //\\ P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
(P -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt; ‚¶É P //\\ P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
(P -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt; ‚¶É P //\\ P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P //\\ P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13c"><span class="nb">intros</span> h [P1 P2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P&#39; h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13d"><span class="kn">Lemma</span> <span class="nf">triple_lift_exists</span>: <span class="kr">forall</span> (<span class="nv">X</span>: <span class="kt">Type</span>) (<span class="nv">P</span>: X -&gt; assertion) <span class="nv">c</span> <span class="nv">Q</span>,
  (<span class="kr">forall</span> <span class="nv">x</span>, ‚¶É P x ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt;
  ‚¶É aexists P ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ‚¶É P x ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt;
‚¶É aexists P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ‚¶É P x ‚¶Ñ c ‚¶É Q ‚¶Ñ) -&gt;
‚¶É aexists P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk13f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ‚¶É P x ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É aexists P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk140"><span class="nb">intros</span> h (x &amp; Px).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ‚¶É P x ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P x h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (H x); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk141"><span class="kn">Lemma</span> <span class="nf">triple_ifthen</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">P</span> <span class="nv">Q</span>,
  b &lt;&gt; <span class="mi">0</span> -&gt; ‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> : postcond),
b &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt; ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk142"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> : postcond),
b &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt; ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk143"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk144"><span class="nb">apply</span> triple_ifthenelse; <span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk145" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk145"><hr></label><div class="goal-conclusion">‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk146">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk147">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk148"><span class="kn">Lemma</span> <span class="nf">triple_ifelse</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">P</span> <span class="nv">Q</span>,
  b = <span class="mi">0</span> -&gt; ‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> : postcond),
b = <span class="mi">0</span> -&gt;
‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt; ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk149"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> : postcond),
b = <span class="mi">0</span> -&gt;
‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt; ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14b"><span class="nb">apply</span> triple_ifthenelse; <span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk14c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk14c"><hr></label><div class="goal-conclusion">‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk14f"><span class="kn">Lemma</span> <span class="nf">unroll_com</span>: <span class="kr">forall</span> <span class="nv">c</span>,
  c = <span class="kr">match</span> c <span class="kr">with</span>
      | PURE x =&gt; PURE x
      | LET c f =&gt; LET c f
      | IFTHENELSE b c1 c2 =&gt; IFTHENELSE b c1 c2
      | ALLOC sz =&gt; ALLOC sz
      | GET l =&gt; GET l
      | SET l v =&gt; SET l v
      | FREE l =&gt; FREE l
      | PICK n =&gt; PICK n
      <span class="kr">end</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">c</span> : com,
c =
<span class="kr">match</span> c <span class="kr">with</span>
| PURE x =&gt; PURE x
| LET c0 f =&gt; LET c0 f
| IFTHENELSE b c1 c2 =&gt; IFTHENELSE b c1 c2
| ALLOC sz =&gt; ALLOC sz
| GET l =&gt; GET l
| SET l v =&gt; SET l v
| FREE l =&gt; FREE l
| PICK n =&gt; PICK n
<span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk150"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">c</span> : com,
c =
<span class="kr">match</span> c <span class="kr">with</span>
| PURE x =&gt; PURE x
| LET c0 f =&gt; LET c0 f
| IFTHENELSE b c1 c2 =&gt; IFTHENELSE b c1 c2
| ALLOC sz =&gt; ALLOC sz
| GET l =&gt; GET l
| SET l v =&gt; SET l v
| FREE l =&gt; FREE l
| PICK n =&gt; PICK n
<span class="kr">end</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> c; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab9"></a><h1 class="section">3. Singly-linked lists</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab10"></a><h2 class="section">Representation predicate</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Here is a separation logic assertion that describes the in-memory
    representation of a list.
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">a</span></span> is the pointer to the list head (or 0 if the list is empty).

</li>
<li> <span class="inlinecode"><span class="id" title="var">l</span></span> is the Coq list of the list elements.

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">list_at</span> (<span class="nv">a</span>: addr) (<span class="nv">l</span>: list Z) : assertion :=
  <span class="kr">match</span> l <span class="kr">with</span>
  | nil =&gt; (a = <span class="mi">0</span>) //\\ emp
  | h :: t =&gt; (a &lt;&gt; <span class="mi">0</span>) //\\ aexists (<span class="kr">fun</span> <span class="nv">a&#39;</span> =&gt; contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
  <span class="kr">end</span>.</span></span></pre><div class="doc">
<a id="lab11"></a><h2 class="section">The "cons" operation</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">list_cons</span> (<span class="nv">n</span>: Z) (<span class="nv">a</span>: addr) : com :=
  LET (ALLOC <span class="mi">2</span>) (<span class="kr">fun</span> <span class="nv">a&#39;</span> =&gt; SEQ (SET a&#39; n) (SEQ (SET (a&#39; + <span class="mi">1</span>) a) (PURE a&#39;))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk151"><span class="kn">Lemma</span> <span class="nf">list_cons_correct</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">n</span> <span class="nv">l</span>,
    ‚¶É list_at a l ‚¶Ñ
  list_cons n a
    ‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> =&gt; list_at a&#39; (n :: l) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">n</span> : Z) (<span class="nv">l</span> : list Z),
‚¶É list_at a l ‚¶Ñ list_cons n a
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk152"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">n</span> : Z) (<span class="nv">l</span> : list Z),
‚¶É list_at a l ‚¶Ñ list_cons n a
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk153"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a l ‚¶Ñ list_cons n a
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk154"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a l ‚¶Ñ ALLOC <span class="mi">2</span> ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk155" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk155"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ SEQ (SET v n) (SEQ (SET (v + <span class="mi">1</span>) a) (PURE v))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk156"><span class="nb">rewrite</span> &lt;- sepconj_emp <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ** list_at a l ‚¶Ñ ALLOC <span class="mi">2</span> ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk157" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk157"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ SEQ (SET v n) (SEQ (SET (v + <span class="mi">1</span>) a) (PURE v))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk158"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ‚¶Ñ ALLOC <span class="mi">2</span> ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk159" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk159"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 ** list_at a l) v
‚¶Ñ SEQ (SET v n) (SEQ (SET (v + <span class="mi">1</span>) a) (PURE v))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15a"><span class="nb">apply</span> triple_alloc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l <span class="mi">2</span>) v0 **
   list_at a l) v
‚¶Ñ SEQ (SET v n) (SEQ (SET (v + <span class="mi">1</span>) a) (PURE v))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt; list_at a&#39; (n :: l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15b"><span class="nb">intros</span> b; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((b &lt;&gt; <span class="mi">0</span>) //\\ valid b ** valid (b + <span class="mi">1</span>) ** emp) **
  list_at a l
‚¶Ñ SEQ (SET b n) (SEQ (SET (b + <span class="mi">1</span>) a) (PURE b))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15c"><span class="nb">rewrite</span> lift_pureconj, ! sepconj_assoc, sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\
  valid b ** valid (b + <span class="mi">1</span>) ** list_at a l
‚¶Ñ SEQ (SET b n) (SEQ (SET (b + <span class="mi">1</span>) a) (PURE b))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15d"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid b ** valid (b + <span class="mi">1</span>) ** list_at a l
‚¶Ñ SEQ (SET b n) (SEQ (SET (b + <span class="mi">1</span>) a) (PURE b))
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk15e"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid b ** valid (b + <span class="mi">1</span>) ** list_at a l ‚¶Ñ SET b n
‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk15f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk15f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ SEQ (SET (b + <span class="mi">1</span>) a) (PURE b)
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk160"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid b ‚¶Ñ SET b n ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk161" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk161"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 ** valid (b + <span class="mi">1</span>) ** list_at a l)
    v ‚¶Ñ SEQ (SET (b + <span class="mi">1</span>) a) (PURE b)
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk162"><span class="nb">apply</span> triple_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains b n) v0 **
   valid (b + <span class="mi">1</span>) ** list_at a l) v
‚¶Ñ SEQ (SET (b + <span class="mi">1</span>) a) (PURE b)
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk163"><span class="nb">simpl</span>; <span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains b n ** valid (b + <span class="mi">1</span>) ** list_at a l
‚¶Ñ SEQ (SET (b + <span class="mi">1</span>) a) (PURE b)
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk164"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains b n ** valid (b + <span class="mi">1</span>) ** list_at a l
‚¶Ñ SET (b + <span class="mi">1</span>) a ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk165" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk165"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk166"><span class="nb">rewrite</span> sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid (b + <span class="mi">1</span>) ** contains b n ** list_at a l
‚¶Ñ SET (b + <span class="mi">1</span>) a ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk167" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk167"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk168"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid (b + <span class="mi">1</span>) ‚¶Ñ SET (b + <span class="mi">1</span>) a ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk169" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk169"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 ** contains b n ** list_at a l)
    v ‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16a"><span class="nb">apply</span> triple_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains (b + <span class="mi">1</span>) a) v0 **
   contains b n ** list_at a l) v ‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16b"><span class="nb">simpl</span>; <span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (b + <span class="mi">1</span>) a ** contains b n ** list_at a l
‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16c"><span class="nb">rewrite</span> sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l
‚¶Ñ PURE b
‚¶É <span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
  (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
     contains a&#39; n **
     contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16d"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l --&gt;&gt;
(b &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains b n ** contains (b + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16e"><span class="nb">intros</span> h A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((b &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains b n **
    contains (b + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk16f"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk170" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l)
  h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk170"><hr></label><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains b n ** contains (b + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)
  h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk171"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains b n ** contains (b + <span class="mi">1</span>) a ** list_at a l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains b n ** contains (b + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">   </span></span></pre><div class="doc">
<a id="lab12"></a><h2 class="section">Computing the length of a list</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Taking advantage of the coinductive nature of type <span class="inlinecode"><span class="id" title="var">com</span></span>,
    we use infinite commands to represent loops and tail-recursive functions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoFixpoint</span> <span class="nf">list_length_rec</span> (<span class="nv">a</span>: addr) (<span class="nv">len</span>: Z) : com :=
  IFTHENELSE a (LET (GET (a + <span class="mi">1</span>)) (<span class="kr">fun</span> <span class="nv">t</span> =&gt; list_length_rec t (len + <span class="mi">1</span>))) (PURE len).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">list_length</span> (<span class="nv">a</span>: addr) : com := list_length_rec a <span class="mi">0</span>.</span></span></pre><div class="doc">
Normally we would write
<pre>
   len = 0;
   while (a != 0) { a = get (a + 1); len = len + 1; }
</pre>
   With the coinductive definition, we write the equivalent infinite command
<pre>
   if (a == 0) return 0; else {
     a1 = get (a + 1);
     if (a1 == 0) return 1; else {
       a2 = get (a1 + 1);
       if (a2 == 0) return 2; else ...
</pre>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk172"><span class="kn">Lemma</span> <span class="nf">list_length_rec_correct</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">a</span> <span class="nv">len</span>,
    ‚¶É list_at a l ‚¶Ñ
  list_length_rec a len
    ‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> =&gt; (len&#39; = len + Z.of_nat (List.length l)) //\\ list_at a l ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a l ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (length l)) //\\ list_at a l
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk173"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a l ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (length l)) //\\ list_at a l
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk174"><span class="kn">Local</span> <span class="kn">Opaque</span> Z.of_nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a l ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (length l)) //\\ list_at a l
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk175"><span class="nb">induction</span> l <span class="kr">as</span> [ | h t]; <span class="nb">intros</span>; <span class="nb">rewrite</span> (unroll_com (list_length_rec a len)); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a = <span class="mi">0</span>) //\\ emp
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk176" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk176"><hr></label><div class="goal-conclusion">‚¶É (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk177">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a = <span class="mi">0</span>) //\\ emp
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk178"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intro</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk179"><span class="nb">apply</span> triple_ifelse; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ‚¶Ñ PURE len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17a"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp --&gt;&gt;
(len = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17b"><span class="nb">intros</span> h H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((len = len + Z.of_nat <span class="mi">0</span>) //\\ (a = <span class="mi">0</span>) //\\ emp) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">len = len + Z.of_nat <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk17d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk17d"><hr></label><div class="goal-conclusion">((a = <span class="mi">0</span>) //\\ emp) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17e"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a = <span class="mi">0</span>) //\\ emp) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk17f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk180"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intro</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk181"><span class="nb">apply</span> triple_lift_exists; <span class="nb">intros</span> a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>)))
    (PURE len)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk182"><span class="nb">apply</span> triple_ifthen; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t
‚¶Ñ LET (GET (a + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt; list_length_rec t (len + <span class="mi">1</span>))
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk183"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t
‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk184" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk184"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ list_length_rec v (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk185"><span class="nb">rewrite</span> sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ** contains a h ** list_at a&#39; t
‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk186" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk186"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ list_length_rec v (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk187"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk188" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk188"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 ** contains a h ** list_at a&#39; t)
    v ‚¶Ñ list_length_rec v (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk189"><span class="nb">apply</span> triple_get.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;)
     v0 ** contains a h ** list_at a&#39; t) v
‚¶Ñ list_length_rec v (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18a"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É ((v = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;) **
  contains a h ** list_at a&#39; t
‚¶Ñ list_length_rec v (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18b"><span class="nb">intros</span> a&#39;&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a&#39;&#39; = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;) **
  contains a h ** list_at a&#39; t
‚¶Ñ list_length_rec a&#39;&#39; (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18c"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a&#39;&#39; = a&#39;) //\\
  contains (a + <span class="mi">1</span>) a&#39; ** contains a h ** list_at a&#39; t
‚¶Ñ list_length_rec a&#39;&#39; (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18d"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a&#39;&#39; = a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ** contains a h ** list_at a&#39; t
‚¶Ñ list_length_rec a&#39;&#39; (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18e"><span class="nb">subst</span> a&#39;&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ** contains a h ** list_at a&#39; t
‚¶Ñ list_length_rec a&#39; (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk18f"><span class="nb">rewrite</span> sepconj_swap3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a&#39; t ** contains (a + <span class="mi">1</span>) a&#39; ** contains a h
‚¶Ñ list_length_rec a&#39; (len + <span class="mi">1</span>)
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (S (length t))) //\\
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a h **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk190"><span class="nb">eapply</span> triple_consequence_post.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a&#39; t ** contains (a + <span class="mi">1</span>) a&#39; ** contains a h
‚¶Ñ list_length_rec a&#39; (len + <span class="mi">1</span>) ‚¶É <span class="nl">?Q&#39;</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk191" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk191"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
<span class="nl">?Q&#39;</span> v --&gt;&gt;
(v = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk192"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a&#39; t ‚¶Ñ list_length_rec a&#39; (len + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk193" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk193"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 <span class="nl">?Q</span> v0 ** contains (a + <span class="mi">1</span>) a&#39; ** contains a h) v --&gt;&gt;
(v = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk194"><span class="nb">apply</span> IHt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 (<span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)) //\\
  list_at a&#39; t) v0 **
 contains (a + <span class="mi">1</span>) a&#39; ** contains a h) v --&gt;&gt;
(v = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk195"><span class="nb">intros</span> len&#39;; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)) //\\
 list_at a&#39; t) ** contains (a + <span class="mi">1</span>) a&#39; ** contains a h --&gt;&gt;
(len&#39; = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk196"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)) //\\
list_at a&#39; t ** contains (a + <span class="mi">1</span>) a&#39; ** contains a h --&gt;&gt;
(len&#39; = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk197"><span class="nb">rewrite</span> &lt;- sepconj_swap3, sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)) //\\
contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t --&gt;&gt;
(len&#39; = len + Z.of_nat (S (length t))) //\\
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk198"><span class="nb">intros</span> h1 (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((len&#39; = len + Z.of_nat (S (length t))) //\\
 (a &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a h **
    contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)) h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk199"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">len&#39; = len + Z.of_nat (S (length t))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (length t)) //\\
  list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk19a"><hr></label><div class="goal-conclusion">((a &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a h **
    contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)) h1</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk19b"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a h **
    contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)) h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk19c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk19d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt;
  (len&#39; = len + Z.of_nat (length t)) //\\
  list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk19d"><hr></label><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
  h1</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk19e"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">len</span> : Z),
‚¶É list_at a t ‚¶Ñ list_length_rec a len
‚¶É <span class="kr">fun</span> <span class="nv">len&#39;</span> : Z =&gt; (len&#39; = len + Z.of_nat (length t)) //\\ list_at a t ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>len</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', len'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>len&#39; = len + <span class="mi">1</span> + Z.of_nat (length t)</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a h **
 contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t) h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a h ** contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; t)
  h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a&#39;</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk19f"><span class="kn">Corollary</span> <span class="nf">list_length_correct</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">a</span>,
    ‚¶É list_at a l ‚¶Ñ
  list_length a
    ‚¶É <span class="kr">fun</span> <span class="nv">len</span> =&gt; (len = Z.of_nat (length l)) //\\ list_at a l ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr),
‚¶É list_at a l ‚¶Ñ list_length a
‚¶É <span class="kr">fun</span> <span class="nv">len</span> : Z =&gt;
  (len = Z.of_nat (length l)) //\\ list_at a l ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr),
‚¶É list_at a l ‚¶Ñ list_length a
‚¶É <span class="kr">fun</span> <span class="nv">len</span> : Z =&gt;
  (len = Z.of_nat (length l)) //\\ list_at a l ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a l ‚¶Ñ list_length a
‚¶É <span class="kr">fun</span> <span class="nv">len</span> : Z =&gt;
  (len = Z.of_nat (length l)) //\\ list_at a l ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> list_length_rec_correct.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab13"></a><h2 class="section">Concatenating two lists in-place</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In loop notation:
<pre>
  if (l1 == 0) return l2; else {
    t = get(l1 + 1);
    while (get (t + 1) != 0) t = get (t + 1);
    set (t + 1, l2);
    return l1;
  }
</pre>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoFixpoint</span> <span class="nf">list_concat_rec</span> (<span class="nv">a1</span> <span class="nv">a2</span>: addr) : com :=
  LET (GET (a1 + <span class="mi">1</span>)) (<span class="kr">fun</span> <span class="nv">t</span> =&gt; IFTHENELSE t (list_concat_rec t a2) (SET (a1 + <span class="mi">1</span>) a2)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">list_concat</span> (<span class="nv">a1</span> <span class="nv">a2</span>: addr) : com :=
  IFTHENELSE a1 (SEQ (list_concat_rec a1 a2) (PURE a1)) (PURE a2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a2"><span class="kn">Lemma</span> <span class="nf">list_concat_rec_correct</span>: <span class="kr">forall</span> <span class="nv">l2</span> <span class="nv">a2</span> <span class="nv">l1</span> <span class="nv">a1</span>,
  a1 &lt;&gt; <span class="mi">0</span> -&gt;
    ‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ
  list_concat_rec a1 a2
    ‚¶É <span class="kr">fun</span> <span class="nv">_</span> =&gt; list_at a1 (l1 ++ l2) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l2</span> : list Z) (<span class="nv">a2</span> : addr) (<span class="nv">l1</span> : list Z)
  (<span class="nv">a1</span> : Z),
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 l1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l2</span> : list Z) (<span class="nv">a2</span> : addr) (<span class="nv">l1</span> : list Z)
  (<span class="nv">a1</span> : Z),
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 l1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a4"><span class="nb">induction</span> l1 <span class="kr">as</span> [ | h1 t1]; <span class="nb">intros</span>; <span class="nb">rewrite</span> (unroll_com (list_concat_rec a1 a2)); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 = <span class="mi">0</span>) //\\ emp) ** list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2)) ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 l2
‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1a5"><hr></label><div class="goal-conclusion">‚¶É ((a1 &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a1 h1 **
      contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1)) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 = <span class="mi">0</span>) //\\ emp) ** list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2)) ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 l2
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a7"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 = <span class="mi">0</span>) //\\ emp ** list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2)) ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 l2
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a8"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ** list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2)) ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 l2
‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1a9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a1 h1 **
      contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1)) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1aa"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ab"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ac"><span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ad"><span class="nb">rewrite</span> lift_aexists.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">x</span> : Z =&gt;
     (contains a1 h1 **
      contains (a1 + <span class="mi">1</span>) x ** list_at x t1) **
     list_at a2 l2)
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ae"><span class="nb">apply</span> triple_lift_exists.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : Z,
‚¶É (contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) x ** list_at x t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1af"><span class="nb">intros</span> a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b0"><span class="nb">rewrite</span> sepconj_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a1 h1 **
  (contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2
‚¶Ñ LET (GET (a1 + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">t</span> : Z =&gt;
     IFTHENELSE t (list_concat_rec t a2)
       (SET (a1 + <span class="mi">1</span>) a2))
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b1"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a1 h1 **
  (contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2 ‚¶Ñ GET (a1 + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1b2"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v
‚¶Ñ IFTHENELSE v (list_concat_rec v a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains a1 h1 **
  (contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; t1) **
  list_at a2 l2 ‚¶Ñ GET (a1 + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b4"><span class="nb">rewrite</span> sepconj_assoc, sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ GET (a1 + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b5"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; ‚¶Ñ GET (a1 + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_get.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = a&#39;) //\\ contains (a1 + <span class="mi">1</span>) a&#39;)
     v0 **
   contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) v
‚¶Ñ IFTHENELSE v (list_concat_rec v a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b7"><span class="nb">intros</span> t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', t</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = a&#39;) //\\ contains (a1 + <span class="mi">1</span>) a&#39;)
     v **
   contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) t
‚¶Ñ IFTHENELSE t (list_concat_rec t a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', t</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((t = a&#39;) //\\ contains (a1 + <span class="mi">1</span>) a&#39;) **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ IFTHENELSE t (list_concat_rec t a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1b9"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', t</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (t = a&#39;) //\\
  contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ IFTHENELSE t (list_concat_rec t a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ba"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', t</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">t = a&#39; -&gt;
‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ IFTHENELSE t (list_concat_rec t a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1bb"><span class="nb">intros</span> H2; <span class="nb">subst</span> t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ IFTHENELSE a&#39; (list_concat_rec a&#39; a2)
    (SET (a1 + <span class="mi">1</span>) a2)
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1bc"><span class="nb">apply</span> triple_ifthenelse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a&#39; a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1bd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1bd"><hr></label><div class="goal-conclusion">‚¶É (a&#39; = <span class="mi">0</span>) //\\
  contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ SET (a1 + <span class="mi">1</span>) a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1be">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
  contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a&#39; a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1bf"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a&#39; a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c0"><span class="nb">intros</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a&#39; a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c1"><span class="nb">rewrite</span> &lt;- sepconj_assoc, sepconj_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (list_at a&#39; t1 ** list_at a2 l2) **
  contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1
‚¶Ñ list_concat_rec a&#39; a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c2"><span class="nb">eapply</span> triple_consequence_post.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (list_at a&#39; t1 ** list_at a2 l2) **
  contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1
‚¶Ñ list_concat_rec a&#39; a2 ‚¶É <span class="nl">?Q&#39;</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1c3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
<span class="nl">?Q&#39;</span> v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c4"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a&#39; a2 ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1c5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1c5"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 <span class="nl">?Q</span> v0 ** contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c6"><span class="nb">apply</span> IHt1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1c7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1c7"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a&#39; (t1 ++ l2)) v0 **
 contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c8"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a&#39; (t1 ++ l2)) v0 **
 contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1c9"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z -&gt;
list_at a&#39; (t1 ++ l2) **
contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ca"><span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a&#39; (t1 ++ l2) **
contains (a1 + <span class="mi">1</span>) a&#39; ** contains a1 h1 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1cb"><span class="nb">rewrite</span> sepconj_pick2, sepconj_swap3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2) --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1cc"><span class="nb">intros</span> h P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(contains a1 h1 **
 contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a1 &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a1 h1 **
    contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1cd"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(contains a1 h1 **
 contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a&#39;</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ce">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a&#39; = <span class="mi">0</span>) //\\
  contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ SET (a1 + <span class="mi">1</span>) a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1cf"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; = <span class="mi">0</span> -&gt;
‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ SET (a1 + <span class="mi">1</span>) a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d0"><span class="nb">intros</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ SET (a1 + <span class="mi">1</span>) a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt;
  (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 h1 **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d1"><span class="nb">eapply</span> triple_consequence_post.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; **
  contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2
‚¶Ñ SET (a1 + <span class="mi">1</span>) a2 ‚¶É <span class="nl">?Q&#39;</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1d2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1d2"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
<span class="nl">?Q&#39;</span> v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d3"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a1 + <span class="mi">1</span>) a&#39; ‚¶Ñ SET (a1 + <span class="mi">1</span>) a2 ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1d4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1d4"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 <span class="nl">?Q</span> v0 **
 contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d5"><span class="nb">eapply</span> triple_consequence_pre.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="nl">?P&#39;</span> ‚¶Ñ SET (a1 + <span class="mi">1</span>) a2 ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1d6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1d6"><hr></label><div class="goal-conclusion">contains (a1 + <span class="mi">1</span>) a&#39; --&gt;&gt; <span class="nl">?P&#39;</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1d7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1d7"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 <span class="nl">?Q</span> v0 **
 contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1d8"><span class="nb">apply</span> triple_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains (a1 + <span class="mi">1</span>) a&#39; --&gt;&gt; valid (a1 + <span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1d9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1d9"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains (a1 + <span class="mi">1</span>) a2) v0 **
 contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1da"><span class="nb">intros</span> h P; <span class="kr">exists</span> <span class="nv">a&#39;</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
 (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains (a1 + <span class="mi">1</span>) a2) v0 **
 contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2) v --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1db"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z -&gt;
contains (a1 + <span class="mi">1</span>) a2 **
contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1dc"><span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains (a1 + <span class="mi">1</span>) a2 **
contains a1 h1 ** list_at a&#39; t1 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1dd"><span class="nb">rewrite</span> sepconj_pick2, sepconj_pick3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 t1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (t1 ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a&#39; t1 **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; (t1 ++ l2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1de"><span class="nb">destruct</span> t1; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 nil ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (nil ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a&#39; = <span class="mi">0</span>) //\\ emp) **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1df" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1, z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 (z :: t1) ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 ((z :: t1) ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1df"><hr></label><div class="goal-conclusion">((a&#39; &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
    contains a&#39; z **
    contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 t1)) **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; **
   (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
      contains a&#39; z **
      contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 (t1 ++ l2)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e0">**</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 nil ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (nil ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a&#39; = <span class="mi">0</span>) //\\ emp) **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e1"><span class="nb">rewrite</span> lift_pureconj, sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 nil ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (nil ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a&#39; = <span class="mi">0</span>) //\\
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e2"><span class="nb">intros</span> h (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 nil ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (nil ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a1 h1 **
 contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a1 &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a1 h1 **
    contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l2)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e3"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 nil ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (nil ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(contains a1 h1 **
 contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l2) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a2</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e4">**</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1, z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 (z :: t1) ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 ((z :: t1) ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a&#39; &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
    contains a&#39; z **
    contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 t1)) **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; **
   (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
      contains a&#39; z **
      contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 (t1 ++ l2)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e5"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1, z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 (z :: t1) ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 ((z :: t1) ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a&#39; &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
   contains a&#39; z **
   contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 t1) **
contains a1 h1 **
contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2 --&gt;&gt;
(a1 &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a1 h1 **
   contains (a1 + <span class="mi">1</span>) a&#39; **
   (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
      contains a&#39; z **
      contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 (t1 ++ l2)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e6"><span class="nb">intros</span> h (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h1, z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>t1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHt1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a1</span> : Z,
a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É list_at a1 (z :: t1) ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 ((z :: t1) ++ l2) ‚¶Ñ</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H, H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>a&#39; = <span class="mi">0</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
    contains a&#39; z **
    contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 t1) **
 contains a1 h1 **
 contains (a1 + <span class="mi">1</span>) a2 ** list_at a2 l2) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a1 &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a1 h1 **
    contains (a1 + <span class="mi">1</span>) a&#39; **
    (a&#39; &lt;&gt; <span class="mi">0</span>) //\\
    aexists
      (<span class="kr">fun</span> <span class="nv">a&#39;0</span> : Z =&gt;
       contains a&#39; z **
       contains (a&#39; + <span class="mi">1</span>) a&#39;0 ** list_at a&#39;0 (t1 ++ l2))))
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e7"><span class="kn">Lemma</span> <span class="nf">list_concat_correct</span>: <span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">a1</span> <span class="nv">l2</span> <span class="nv">a2</span>,
    ‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ
  list_concat a1 a2
    ‚¶É <span class="kr">fun</span> <span class="nv">a</span> =&gt; list_at a (l1 ++ l2) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l1</span> : list Z) (<span class="nv">a1</span> : addr) (<span class="nv">l2</span> : list Z)
  (<span class="nv">a2</span> : addr),
‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ list_concat a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l1</span> : list Z) (<span class="nv">a1</span> : addr) (<span class="nv">l2</span> : list Z)
  (<span class="nv">a2</span> : addr),
‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ list_concat a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1e9"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ list_concat a1 a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ea"><span class="nb">unfold</span> list_concat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 l1 ** list_at a2 l2
‚¶Ñ IFTHENELSE a1
    (SEQ (list_concat_rec a1 a2) (PURE a1)) (PURE a2)
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1eb"><span class="nb">apply</span> triple_ifthenelse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 &lt;&gt; <span class="mi">0</span>) //\\ list_at a1 l1 ** list_at a2 l2
‚¶Ñ SEQ (list_concat_rec a1 a2) (PURE a1)
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1ec" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1ec"><hr></label><div class="goal-conclusion">‚¶É (a1 = <span class="mi">0</span>) //\\ list_at a1 l1 ** list_at a2 l2
‚¶Ñ PURE a2 ‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ed">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 &lt;&gt; <span class="mi">0</span>) //\\ list_at a1 l1 ** list_at a2 l2
‚¶Ñ SEQ (list_concat_rec a1 a2) (PURE a1)
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ee"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 l1 ** list_at a2 l2
‚¶Ñ SEQ (list_concat_rec a1 a2) (PURE a1)
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ef"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 l1 ** list_at a2 l2
‚¶Ñ list_concat_rec a1 a2 ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1f0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1f0"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ PURE a1 ‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f1"><span class="nb">apply</span> list_concat_rec_correct; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; list_at a1 (l1 ++ l2)) v ‚¶Ñ PURE a1
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f2"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z -&gt;
‚¶É list_at a1 (l1 ++ l2) ‚¶Ñ PURE a1
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f3"><span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 (l1 ++ l2) ‚¶Ñ PURE a1
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f4"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a1 (l1 ++ l2) --&gt;&gt; list_at a1 (l1 ++ l2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 = <span class="mi">0</span>) //\\ list_at a1 l1 ** list_at a2 l2
‚¶Ñ PURE a2 ‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f6"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a1 l1 ** list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a (l1 ++ l2) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f7"><span class="nb">destruct</span> l1; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 = <span class="mi">0</span>) //\\ emp) ** list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a l2 ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk1f8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk1f8"><hr></label><div class="goal-conclusion">‚¶É ((a1 &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a1 z **
      contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l1)) **
  list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt;
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a z **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; (l1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1f9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 = <span class="mi">0</span>) //\\ emp) ** list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt; list_at a l2 ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1fa"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a1 = <span class="mi">0</span>) //\\ emp) ** list_at a2 l2 --&gt;&gt;
list_at a2 l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1fb"><span class="nb">rewrite</span> lift_pureconj, sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a1 = <span class="mi">0</span>) //\\ list_at a2 l2 --&gt;&gt; list_at a2 l2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> h (A &amp; B); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1fc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a1 &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a1 z **
      contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l1)) **
  list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt;
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a z **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; (l1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1fd"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a1 &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 z **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l1) **
  list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt;
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a z **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; (l1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1fe"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l1</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l2</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a1 = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a1 &lt;&gt; <span class="mi">0</span> -&gt;
‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a1 z **
     contains (a1 + <span class="mi">1</span>) a&#39; ** list_at a&#39; l1) **
  list_at a2 l2 ‚¶Ñ PURE a2
‚¶É <span class="kr">fun</span> <span class="nv">a</span> : Z =&gt;
  (a &lt;&gt; <span class="mi">0</span>) //\\
  aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a z **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; (l1 ++ l2)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab14"></a><h2 class="section">List reversal in place</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In loop notation:
<pre>
  p = 0;
  while (l != 0) {
    n = get (l + 1);
    set (l + 1, p);
    p = l;
    l = n;
  }
  return p;
</pre>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">CoFixpoint</span> <span class="nf">list_rev_rec</span> (<span class="nv">a</span> <span class="nv">p</span>: addr) : com :=
  IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>)) (<span class="kr">fun</span> <span class="nv">n</span> =&gt;
     SEQ (SET (a + <span class="mi">1</span>) p)
         (list_rev_rec n a)))
    (PURE p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">list_rev</span> (<span class="nv">a</span>: addr) : com := list_rev_rec a <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk1ff"><span class="kn">Lemma</span> <span class="nf">list_rev_rec_correct</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">a</span> <span class="nv">l&#39;</span> <span class="nv">p</span>,
    ‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ
  list_rev_rec a p
    ‚¶É <span class="kr">fun</span> <span class="nv">x</span> =&gt; list_at x (List.rev_append l l&#39;) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z)
  (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk200"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : list Z) (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z)
  (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk201"><span class="nb">induction</span> l <span class="kr">as</span> [ | hd l]; <span class="nb">intros</span>; <span class="nb">rewrite</span> (unroll_com (list_rev_rec a p)); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a = <span class="mi">0</span>) //\\ emp) ** list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p) ‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x l&#39; ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk202" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk202"><hr></label><div class="goal-conclusion">‚¶É ((a &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a hd **
      contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)) **
  list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk203">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a = <span class="mi">0</span>) //\\ emp) ** list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p) ‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x l&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk204"><span class="nb">rewrite</span> lift_pureconj, sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a = <span class="mi">0</span>) //\\ list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p) ‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x l&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk205"><span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p) ‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x l&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk206"><span class="nb">apply</span> triple_ifelse; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at p l&#39; ‚¶Ñ PURE p ‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x l&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk207"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at p l&#39; --&gt;&gt; list_at p l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk208">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a &lt;&gt; <span class="mi">0</span>) //\\
   aexists
     (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
      contains a hd **
      contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l)) **
  list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk209"><span class="nb">rewrite</span> lift_pureconj; <span class="nb">apply</span> triple_lift_pure; <span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É aexists
    (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
     contains a hd **
     contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l) **
  list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk20a"><span class="nb">rewrite</span> lift_aexists; <span class="nb">apply</span> triple_lift_exists; <span class="nb">intros</span> a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l) **
  list_at p l&#39;
‚¶Ñ IFTHENELSE a
    (LET (GET (a + <span class="mi">1</span>))
       (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
        SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a)))
    (PURE p)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk20b"><span class="nb">apply</span> triple_ifthen; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l) **
  list_at p l&#39;
‚¶Ñ LET (GET (a + <span class="mi">1</span>))
    (<span class="kr">fun</span> <span class="nv">n</span> : Z =&gt;
     SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec n a))
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk20c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk20c"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l) **
  list_at p l&#39; ‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk20d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk20d"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec v a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk20e"><span class="nb">rewrite</span> ! sepconj_assoc, sepconj_pick2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk20f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk20f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec v a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk210"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ‚¶Ñ GET (a + <span class="mi">1</span>) ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk211" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk211"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   <span class="nl">?Q</span> v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec v a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk212"><span class="nb">apply</span> triple_get.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;)
     v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec v a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk213"><span class="nb">intros</span> a&#39;&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;)
     v **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) a&#39;&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39;&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk214"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É ((a&#39;&#39; = a&#39;) //\\ contains (a + <span class="mi">1</span>) a&#39;) **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39;&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk215"><span class="nb">rewrite</span> lift_pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (a&#39;&#39; = a&#39;) //\\
  contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39;&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk216"><span class="nb">apply</span> triple_lift_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39;&#39; = a&#39; -&gt;
‚¶É contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39;&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk217"><span class="nb">intros</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a', a''</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a&#39;&#39; = a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39;&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk218"><span class="nb">subst</span> a&#39;&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SEQ (SET (a + <span class="mi">1</span>) p) (list_rev_rec a&#39; a)
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk219"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ SET (a + <span class="mi">1</span>) p ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk21a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk21a"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É <span class="nl">?Q</span> v ‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk21b"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) a&#39; ‚¶Ñ SET (a + <span class="mi">1</span>) p ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk21c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk21c"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   <span class="nl">?Q</span> v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk21d"><span class="nb">eapply</span> triple_consequence_pre.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="nl">?P&#39;</span> ‚¶Ñ SET (a + <span class="mi">1</span>) p ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk21e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk21e"><hr></label><div class="goal-conclusion">contains (a + <span class="mi">1</span>) a&#39; --&gt;&gt; <span class="nl">?P&#39;</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk21f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk21f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   <span class="nl">?Q</span> v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk220"><span class="nb">apply</span> triple_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains (a + <span class="mi">1</span>) a&#39; --&gt;&gt; valid (a + <span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk221" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk221"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains (a + <span class="mi">1</span>) p) v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk222"><span class="nb">intros</span> h P; <span class="kr">exists</span> <span class="nv">a&#39;</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
   (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains (a + <span class="mi">1</span>) p) v0 **
   contains a hd ** list_at a&#39; l ** list_at p l&#39;) v
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk223"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z -&gt;
‚¶É contains (a + <span class="mi">1</span>) p **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk224"><span class="nb">intros</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains (a + <span class="mi">1</span>) p **
  contains a hd ** list_at a&#39; l ** list_at p l&#39;
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk225"><span class="nb">rewrite</span> sepconj_pick2, sepconj_pick3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a&#39; l **
  contains a hd ** contains (a + <span class="mi">1</span>) p ** list_at p l&#39;
‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk226"><span class="nb">eapply</span> triple_consequence_pre.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="nl">?P&#39;</span> ‚¶Ñ list_rev_rec a&#39; a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l (hd :: l&#39;)) ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk227" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk227"><hr></label><div class="goal-conclusion">list_at a&#39; l **
contains a hd ** contains (a + <span class="mi">1</span>) p ** list_at p l&#39; --&gt;&gt;
<span class="nl">?P&#39;</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk228"><span class="nb">apply</span> IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a&#39; l **
contains a hd ** contains (a + <span class="mi">1</span>) p ** list_at p l&#39; --&gt;&gt;
list_at a&#39; l ** list_at a (hd :: l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk229"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a&#39; l **
contains a hd ** contains (a + <span class="mi">1</span>) p ** list_at p l&#39; --&gt;&gt;
list_at a&#39; l **
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22a"><span class="nb">apply</span> sepconj_imp_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains a hd ** contains (a + <span class="mi">1</span>) p ** list_at p l&#39; --&gt;&gt;
(a &lt;&gt; <span class="mi">0</span>) //\\
aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22b"><span class="nb">intros</span> h A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains a hd **
 contains (a + <span class="mi">1</span>) p ** list_at p l&#39;) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a &lt;&gt; <span class="mi">0</span>) //\\
 aexists
   (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
    contains a hd **
    contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l&#39;)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22c"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>hd</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l&#39;</span> : list Z) (<span class="nv">p</span> : addr),
‚¶É list_at a l ** list_at p l&#39; ‚¶Ñ list_rev_rec a p
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l l&#39;) ‚¶Ñ</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(contains a hd **
 contains (a + <span class="mi">1</span>) p ** list_at p l&#39;) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists
  (<span class="kr">fun</span> <span class="nv">a&#39;</span> : Z =&gt;
   contains a hd **
   contains (a + <span class="mi">1</span>) a&#39; ** list_at a&#39; l&#39;) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">p</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22d"><span class="kn">Lemma</span> <span class="nf">list_rev_correct</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">l</span>,
    ‚¶É list_at a l ‚¶Ñ
  list_rev a
    ‚¶É <span class="kr">fun</span> <span class="nv">x</span> =&gt; list_at x (List.rev l) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l</span> : list Z),
‚¶É list_at a l ‚¶Ñ list_rev a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : addr) (<span class="nv">l</span> : list Z),
‚¶É list_at a l ‚¶Ñ list_rev a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk22f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a l ‚¶Ñ list_rev a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev l) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk230"><span class="nb">rewrite</span> List.rev_alt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É list_at a l ‚¶Ñ list_rev a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l nil) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk231"><span class="nb">eapply</span> triple_consequence_pre.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="nl">?P&#39;</span> ‚¶Ñ list_rev a
‚¶É <span class="kr">fun</span> <span class="nv">x</span> : Z =&gt; list_at x (rev_append l nil) ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk232" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk232"><hr></label><div class="goal-conclusion">list_at a l --&gt;&gt; <span class="nl">?P&#39;</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk233"><span class="nb">apply</span> list_rev_rec_correct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a l --&gt;&gt; list_at a l ** list_at <span class="mi">0</span> nil</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk234"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a l --&gt;&gt; list_at a l ** (<span class="mi">0</span> = <span class="mi">0</span>) //\\ emp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk235"><span class="nb">rewrite</span> sepconj_comm, lift_pureconj, sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_at a l --&gt;&gt; (<span class="mi">0</span> = <span class="mi">0</span>) //\\ list_at a l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> h A; <span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab15"></a><h1 class="section">4. An alternate definition of separation logic triples</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">AlternateSeplog</span>.</span></span></pre><div class="doc">
For some languages, the frame property for reductions (lemma
    <span class="inlinecode"><span class="id" title="var">red_frame</span></span> above) does not hold, e.g. because allocations are
    deterministic.  Or maybe we do not want to prove the <span class="inlinecode"><span class="id" title="var">red_frame</span></span>
    lemma.

<div class="paragraph"> </div>

    In this case, not all is lost: we can define our separation
    triples <span class="inlinecode"></span> <span class="inlinecode">‚¶É</span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">‚¶Ñ</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">‚¶É</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode">‚¶Ñ</span> <span class="inlinecode"></span> as Hoare triples plus framing. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Hoare</span> (<span class="nv">P</span>: precond) (<span class="nv">c</span>: com) (<span class="nv">Q</span>: postcond) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">h</span>, P h -&gt; safe c h Q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">triple</span> (<span class="nv">P</span>: precond) (<span class="nv">c</span>: com) (<span class="nv">Q</span>: postcond) :=
  <span class="kr">forall</span> (<span class="nv">R</span>: assertion), Hoare (P ** R) c (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk236"><span class="kn">Notation</span> <span class="s2">&quot;‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ&quot;</span> := (triple P c Q) (<span class="kn">at level</span> <span class="mi">90</span>, c <span class="kn">at next level</span>).</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;‚¶É _ ‚¶Ñ _ ‚¶É _ ‚¶Ñ&quot;</span> was already used.
[notation-overridden,parsing,default]</blockquote></div></div></small></span></pre><div class="doc">
This definition validates the frame rule. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk237"><span class="kn">Lemma</span> <span class="nf">triple_frame</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">R</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">R</span> : assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk238"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">R</span> : assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk239"><span class="nb">intros</span> P c Q R TR R&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare ((P ** R) ** R&#39;) c
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (Q v ** R) ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk23a"><span class="nb">rewrite</span> sepconj_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R ** R&#39;) c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (Q v ** R) ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk23b"><span class="nb">replace</span> (<span class="kr">fun</span> <span class="nv">v</span> =&gt; (Q v ** R) ** R&#39;) <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** (R ** R&#39;)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R ** R&#39;) c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ** R&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk23c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk23c"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ** R&#39;) =
(<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (Q v ** R) ** R&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk23d"><span class="nb">apply</span> TR.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ** R&#39;) =
(<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (Q v ** R) ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk23e"><span class="nb">apply</span> functional_extensionality; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>TR</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q x ** R ** R&#39; = (Q x ** R) ** R&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> sepconj_assoc; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
It also validates the "small rules" for heap operations. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk23f"><span class="kn">Lemma</span> <span class="nf">triple_get</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span>,
  ‚¶É contains l v ‚¶Ñ GET l ‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É contains l v ‚¶Ñ GET l
‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk240"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É contains l v ‚¶Ñ GET l
‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk241"><span class="nb">intros</span> l v R h (h1 &amp; h2 &amp; H1 &amp; H2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk242"><span class="nb">assert</span> (L1: h1 l = Some v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk243" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk243"><hr></label><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk244" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk244">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk245" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk245"><span class="nb">red</span> <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk246" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk246"><span class="nb">subst</span> h1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion (hupdate l v hempty) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v hempty) h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v hempty l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk247">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk248"><span class="nb">assert</span> (L: h l = Some v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk249" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk249"><hr></label><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk24a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk24b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk24c"><span class="nb">rewrite</span> U; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> L1; <span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk24d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk24d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (GET l) h
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk24e"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (GET l, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk24f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk24f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (GET l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39;
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk250">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (GET l, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk251" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk251"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk252">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (GET l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39;
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk253" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk253"><span class="nb">intros</span> c&#39; h&#39; RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (GET l, h) (c&#39;, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39;
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk254" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk254">inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v0) (hunion h1 h2)
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; ((v0 = v) //\\ contains l v) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk255" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk255"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(((v0 = v) //\\ contains l v) ** R) (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk256" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk256"><span class="kr">exists</span> <span class="nv">h1</span>, h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((v0 = v) //\\ contains l v) h1 /\
R h2 /\ hdisjoint h1 h2 /\ hunion h1 h2 = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk257" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk257"><span class="nb">unfold</span> pureconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(v0 = v /\ contains l v h1) /\
R h2 /\ hdisjoint h1 h2 /\ hunion h1 h2 = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk258" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk258"><span class="kn">Lemma</span> <span class="nf">triple_set</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span>,
  ‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> =&gt; contains l v ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk259" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk259"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z),
‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk25a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk25a"><span class="nb">intros</span> l v R h (h1 &amp; h2 &amp; H1 &amp; H2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid l h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk25b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk25b"><span class="nb">destruct</span> H1 <span class="kr">as</span> (v0 &amp; H1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk25c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk25c"><span class="nb">red</span> <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk25d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk25d"><span class="nb">assert</span> (L1: h1 l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk25e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk25e"><hr></label><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk25f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk25f">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">subst</span> h1; <span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk260" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk260">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk261" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk261"><span class="nb">assert</span> (L: h l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk262" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk262"><hr></label><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk263" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk263">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk264" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk264"><span class="nb">rewrite</span> U; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> L1; <span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk265" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk265">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (SET l v) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk266" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk266"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (SET l v, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk267" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk267"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk268" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk268">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (SET l v, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk269" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk269"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26b"><span class="nb">intros</span> c&#39; h&#39; RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l v0 hempty</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>RED</var><span class="hyp-type"><b>: </b><span><span class="nb">red</span> (SET l v, h) (c&#39;, h&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26c">inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe SKIP
  (hupdate l v (hunion (hupdate l v0 hempty) h2))
  (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26d"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contains l v ** R)
  (hupdate l v (hunion (hupdate l v0 hempty) h2))</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26e"><span class="kr">exists</span> (<span class="nv">hupdate</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">hempty</span>), h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v (hupdate l v hempty) /\
R h2 /\
hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk26f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk26f"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v (hupdate l v hempty)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk270" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk270"><hr></label><div class="goal-conclusion">R h2 /\
hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk271" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk271"><span class="nb">red</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v hempty = hupdate l v hempty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk272" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk272"><hr></label><div class="goal-conclusion">R h2 /\
hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk273" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk273"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R h2 /\
hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk274" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk274"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk275" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk275"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk276" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk276"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l v hempty) h2 /\
hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk277" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk277"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l v hempty) h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk278" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk278"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk279" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk279"><span class="nb">intro</span> l&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v hempty l&#39; = None \/ h2 l&#39; = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk27a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk27a"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk27b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk27b"><span class="nb">specialize</span> (D l&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l&#39; = None \/ h2 l&#39; = None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v hempty l&#39; = None \/ h2 l&#39; = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk27c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk27c"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk27d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk27d"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None) =
Some v0</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v0 <span class="kr">else</span> None) = None \/
h2 l&#39; = None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> None) = None \/
h2 l&#39; = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk27e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk27e"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk27f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk27f"><span class="nb">destruct</span> D; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None) =
Some v0</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v0 <span class="kr">else</span> None) = None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> None) = None \/
h2 l&#39; = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk280" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk280"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk281" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk281"><span class="nb">destruct</span> (Z.eq_dec l l&#39;); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None) =
Some v0</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = l&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Some v0 = None</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v0 <span class="kr">else</span> None
 <span class="kr">else</span> h2 l) &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some v = None \/ h2 l&#39; = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk282" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk282"><hr></label><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk283" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk283"><span class="bp">congruence</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v (hunion (hupdate l v0 hempty) h2) =
hunion (hupdate l v hempty) h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk284" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk284"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> l&#39;; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>hupdate l v0 hempty l = Some v0</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l v0 hempty) h2</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l v0 hempty) h2 l &lt;&gt; None</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some v
 <span class="kr">else</span>
  <span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v0 <span class="kr">else</span> None
  <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v0 <span class="kr">else</span> None
  <span class="kr">else</span> h2 l&#39;) =
(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> None
 <span class="kr">else</span> h2 l&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l l&#39;); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk285" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk285"><span class="kn">Remark</span> <span class="nf">valid_N_init</span>:
  <span class="kr">forall</span> (<span class="nv">R</span>: assertion) <span class="nv">sz</span> <span class="nv">l</span> <span class="nv">h</span>,
  R h -&gt;
  (<span class="kr">forall</span> <span class="nv">i</span>, l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
  (valid_N l sz ** R) (hinit l sz h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z, l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk286" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk286"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z, l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk287" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk287"><span class="nb">induction</span> sz <span class="kr">as</span> [ | sz]; <span class="nb">intros</span> l h Rh EMPTY; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat <span class="mi">0</span> -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** R) h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk288" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk288"><hr></label><div class="goal-conclusion">((valid l ** valid_N (l + <span class="mi">1</span>) sz) ** R)
  (hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk289" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk289">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat <span class="mi">0</span> -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk28a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk28a"><span class="nb">rewrite</span> sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat <span class="mi">0</span> -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk28b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk28b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((valid l ** valid_N (l + <span class="mi">1</span>) sz) ** R)
  (hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk28c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk28c"><span class="nb">rewrite</span> sepconj_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l ** valid_N (l + <span class="mi">1</span>) sz ** R)
  (hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk28d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk28d"><span class="kr">exists</span> (<span class="nv">hupdate</span> <span class="nv">l</span> <span class="mi">0</span> <span class="nv">hempty</span>), (hinit (l + <span class="mi">1</span>) sz h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (hupdate l <span class="mi">0</span> hempty) /\
(valid_N (l + <span class="mi">1</span>) sz ** R) (hinit (l + <span class="mi">1</span>) sz h) /\
hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk28e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk28e"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l (hupdate l <span class="mi">0</span> hempty)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk28f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk28f"><hr></label><div class="goal-conclusion">(valid_N (l + <span class="mi">1</span>) sz ** R) (hinit (l + <span class="mi">1</span>) sz h) /\
hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk290" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk290"><span class="kr">exists</span> <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l <span class="mi">0</span> (hupdate l <span class="mi">0</span> hempty)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk291" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk291"><hr></label><div class="goal-conclusion">(valid_N (l + <span class="mi">1</span>) sz ** R) (hinit (l + <span class="mi">1</span>) sz h) /\
hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk292" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk292"><span class="nb">red</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid_N (l + <span class="mi">1</span>) sz ** R) (hinit (l + <span class="mi">1</span>) sz h) /\
hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk293" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk293"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid_N (l + <span class="mi">1</span>) sz ** R) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk294" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk294"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk295" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk295"><span class="nb">apply</span> IHsz.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk296" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk296"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : Z,
l + <span class="mi">1</span> &lt;= i &lt; l + <span class="mi">1</span> + Z.of_nat sz -&gt; h i = None</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk297" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk297"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk298" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk298"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : Z,
l + <span class="mi">1</span> &lt;= i &lt; l + <span class="mi">1</span> + Z.of_nat sz -&gt; h i = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk299" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk299"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk29a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk29a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l + <span class="mi">1</span> &lt;= i &lt; l + <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h i = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk29b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk29b"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk29c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk29c"><span class="nb">apply</span> EMPTY.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l + <span class="mi">1</span> &lt;= i &lt; l + <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l &lt;= i &lt; l + Z.of_nat (S sz)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk29d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk29d"><hr></label><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk29e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk29e"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) /\
hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk29f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk29f"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2a0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2a0"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a1"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> hempty x = None \/
hinit (l + <span class="mi">1</span>) sz h x = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2a2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2a2"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a3"><span class="nb">unfold</span> hupdate, hempty; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None) = None \/
hinit (l + <span class="mi">1</span>) sz h x = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2a4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2a4"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a5"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = None \/ hinit (l + <span class="mi">1</span>) sz h x = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2a6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2a6"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a7"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit (l + <span class="mi">1</span>) sz h x = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2a8"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2a9"><span class="nb">rewrite</span> hinit_outside <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h x = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2aa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2aa"><hr></label><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ab"><span class="nb">apply</span> EMPTY; <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ac"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) x =
hunion (hupdate l <span class="mi">0</span> hempty) (hinit (l + <span class="mi">1</span>) sz h) x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ad"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">l</span> : Z) (<span class="nv">h</span> : heap),
R h -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : Z,
 l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None) -&gt;
(valid_N l sz ** R) (hinit l sz h)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Rh</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>EMPTY</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat (S sz) -&gt; h i = None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h x) =
(<span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None
 <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> None
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ae"><span class="kn">Lemma</span> <span class="nf">triple_alloc</span>: <span class="kr">forall</span> <span class="nv">sz</span>,
  ‚¶É emp ‚¶Ñ
  ALLOC sz
  ‚¶É <span class="kr">fun</span> <span class="nv">l</span> =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">sz</span> : nat,
‚¶É emp ‚¶Ñ ALLOC sz
‚¶É <span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2af" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2af"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">sz</span> : nat,
‚¶É emp ‚¶Ñ ALLOC sz
‚¶É <span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b0"><span class="nb">intros</span> sz R h H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(emp ** R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (ALLOC sz) h
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; ((v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b1"><span class="nb">rewrite</span> sepconj_emp <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (ALLOC sz) h
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; ((v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b2"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2b3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2b3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (ALLOC sz, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39;
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; ((v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz) ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b5"><span class="nb">destruct</span> (isfinite h) <span class="kr">as</span> (l0 &amp; FIN).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (ALLOC sz, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b6"><span class="nb">apply</span> immsafe_alloc <span class="kr">with</span> (Z.max l0 <span class="mi">1</span>); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z.max l0 <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2b7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Z.max l0 <span class="mi">1</span> &lt;= i &lt; Z.max l0 <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2b7"><hr></label><div class="goal-conclusion">h i = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b8">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Z.max l0 <span class="mi">1</span> &lt;&gt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2b9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Z.max l0 <span class="mi">1</span> &lt;= i &lt; Z.max l0 <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h i = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ba"><span class="nb">apply</span> FIN.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>FIN</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, l0 &lt;= j -&gt; h j = None</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Z.max l0 <span class="mi">1</span> &lt;= i &lt; Z.max l0 <span class="mi">1</span> + Z.of_nat sz</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l0 &lt;= i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2bb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (ALLOC sz, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39;
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; ((v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2bc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2bc"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE l) (hinit l sz h)
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; ((v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2bd"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(((l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz) ** R) (hinit l sz h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2be" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2be"><span class="nb">rewrite</span> lift_pureconj; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l &lt;&gt; <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2bf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2bf"><hr></label><div class="goal-conclusion">(valid_N l sz ** R) (hinit l sz h)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c0"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Z,
l &lt;= i &lt; l + Z.of_nat sz -&gt; h i = None</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid_N l sz ** R) (hinit l sz h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> valid_N_init; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c1"><span class="kn">Lemma</span> <span class="nf">triple_free</span>: <span class="kr">forall</span> <span class="nv">l</span>,
  ‚¶É valid l ‚¶Ñ
  FREE l
  ‚¶É <span class="kr">fun</span> <span class="nv">_</span> =&gt; emp ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
‚¶É valid l ‚¶Ñ FREE l ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
‚¶É valid l ‚¶Ñ FREE l ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c3"><span class="nb">intros</span> l R h (h1 &amp; h2 &amp; H1 &amp; H2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>valid l h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c4"><span class="nb">destruct</span> H1 <span class="kr">as</span> (v0 &amp; H1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c5"><span class="nb">assert</span> (L1: h1 l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2c6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2c6"><hr></label><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c7">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c8"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hupdate l v0 hempty l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hupdate_same.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2c9">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ca" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ca"><span class="nb">assert</span> (L: h l = Some v0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2cb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2cb"><hr></label><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2cc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2cc">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2cd"><span class="nb">rewrite</span> U; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ce"><span class="nb">rewrite</span> L1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some v0 = Some v0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2cf">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (FREE l) h (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d0"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (FREE l, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2d1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2d1"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (FREE l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (FREE l, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d3"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l &lt;&gt; None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>h l = Some v0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (FREE l, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d5"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe SKIP (hfree l (hunion h1 h2))
  (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d6"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** R) (hfree l (hunion h1 h2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d7"><span class="nb">rewrite</span> sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hfree l (hunion h1 h2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d8"><span class="nb">replace</span> (hfree l (hunion h1 h2)) <span class="kr">with</span> h2; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 = hfree l (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2d9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2d9"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 x = hfree l (hunion h1 h2) x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2da" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2da"><span class="nb">generalize</span> (D x); <span class="nb">rewrite</span> H1; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some v0 <span class="kr">else</span> None) = None \/
h2 x = None -&gt;
h2 x =
(<span class="kr">if</span> Z.eq_dec l x
 <span class="kr">then</span> None
 <span class="kr">else</span>
  <span class="kr">if</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some v0 <span class="kr">else</span> None
  <span class="kr">then</span> <span class="kr">if</span> Z.eq_dec l x <span class="kr">then</span> Some v0 <span class="kr">else</span> None
  <span class="kr">else</span> h2 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2db" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2db"><span class="nb">destruct</span> (Z.eq_dec l x); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>v0</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>contains l v0 h1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>L1</var><span class="hyp-type"><b>: </b><span>h1 l = Some v0</span></span></span><br><span><var>L</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = Some v0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l &lt;&gt; None</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some v0 = None \/ h2 x = None -&gt; h2 x = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The rules for control structures are also valid.  
    Proof plan: first show Hoare-style rules for the <span class="inlinecode"><span class="id" title="var">Hoare</span></span> triple,
    then frame by an arbitrary <span class="inlinecode"><span class="id" title="var">R</span></span> to obtain the separation triple. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2dc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2dc"><span class="kn">Lemma</span> <span class="nf">Hoare_pure</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">v</span> (<span class="nv">Q</span>: postcond),
  P --&gt;&gt; Q v -&gt;
  Hoare P (PURE v) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; Hoare P (PURE v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2dd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2dd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; Hoare P (PURE v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2de" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2de"><span class="nb">intros</span>; <span class="nb">intros</span> h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE v) h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2df" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2df"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e0"><span class="kn">Lemma</span> <span class="nf">triple_pure</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">v</span> (<span class="nv">Q</span>: postcond),
  P --&gt;&gt; Q v -&gt;
  ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : postcond),
P --&gt;&gt; Q v -&gt; ‚¶É P ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e2"><span class="nb">intros</span>; <span class="nb">intros</span> R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R) (PURE v) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e3"><span class="nb">apply</span> Hoare_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** R --&gt;&gt; Q v ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> sepconj_imp_l; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e4"><span class="kn">Lemma</span> <span class="nf">Hoare_let</span>:
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> (<span class="nv">P</span>: precond) (<span class="nv">Q</span> <span class="nv">R</span>: postcond),
  Hoare P c Q -&gt;
  (<span class="kr">forall</span> <span class="nv">v</span>, Hoare (Q v) (f v) R) -&gt;
  Hoare P (LET c f) R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
Hoare P c Q -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R) -&gt;
Hoare P (LET c f) R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
Hoare P c Q -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R) -&gt;
Hoare P (LET c f) R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e6"><span class="nb">intros until</span> R; <span class="nb">intros</span> HR1 HR2 h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare P c Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (LET c f) h R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e7"><span class="nb">apply</span> safe_let <span class="kr">with</span> Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare P c Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">v</span> : Z) (<span class="nv">h&#39;</span> : heap), Q v h&#39; -&gt; safe (f v) h&#39; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2e8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare P c Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2e8"><hr></label><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2e9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2e9"><span class="nb">apply</span> HR2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare P c Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ea" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ea"><span class="nb">apply</span> HR1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare P c Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Hoare (Q v) (f v) R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2eb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2eb"><span class="kn">Lemma</span> <span class="nf">triple_let</span>:
  <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> (<span class="nv">P</span>: precond) (<span class="nv">Q</span> <span class="nv">R</span>: postcond),
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  (<span class="kr">forall</span> <span class="nv">v</span>, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
  ‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ec" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ec"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">P</span> : precond)
  (<span class="nv">Q</span> <span class="nv">R</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ) -&gt;
‚¶É P ‚¶Ñ LET c f ‚¶É R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ed" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ed"><span class="nb">intros</span> c f P Q R TR1 TR2 R&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R&#39;) (LET c f) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; R v ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ee" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ee"><span class="nb">apply</span> Hoare_let <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R&#39;) c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2ef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2ef"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
Hoare (Q v ** R&#39;) (f v) (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; R v0 ** R&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f0"><span class="nb">apply</span> TR1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
Hoare (Q v ** R&#39;) (f v) (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; R v0 ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É Q v ‚¶Ñ f v ‚¶É R ‚¶Ñ</span></span></span><br><span><var>R'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (Q v ** R&#39;) (f v) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; R v ** R&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> TR2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f2"><span class="kn">Lemma</span> <span class="nf">Hoare_ifthenelse</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">P</span> <span class="nv">Q</span>,
  Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q -&gt;
  Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q -&gt;
  Hoare P (IFTHENELSE b c1 c2) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q -&gt;
Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q -&gt;
Hoare P (IFTHENELSE b c1 c2) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q -&gt;
Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q -&gt;
Hoare P (IFTHENELSE b c1 c2) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f4"><span class="nb">intros until</span> Q; <span class="nb">intros</span> HR1 HR2 h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (IFTHENELSE b c1 c2) h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f5"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2f6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2f6"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (IFTHENELSE b c1 c2, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (IFTHENELSE b c1 c2, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (IFTHENELSE b c1 c2, h) (c&#39;, h&#39;) -&gt; safe c&#39; h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2f9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2f9"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> c2 <span class="kr">else</span> c1) h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2fa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2fa"><span class="nb">destruct</span> (Z.eqb_spec b <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c2 h&#39; Q</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk2fb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk2fb"><hr></label><div class="goal-conclusion">safe c1 h&#39; Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2fc" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2fc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c2 h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2fd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2fd"><span class="nb">apply</span> HR2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((b = <span class="mi">0</span>) //\\ P) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2fe" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2fe">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c1 h&#39; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk2ff" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk2ff"><span class="nb">apply</span> HR1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>HR1</var><span class="hyp-type"><b>: </b><span>Hoare ((b &lt;&gt; <span class="mi">0</span>) //\\ P) c1 Q</span></span></span><br><span><var>HR2</var><span class="hyp-type"><b>: </b><span>Hoare ((b = <span class="mi">0</span>) //\\ P) c2 Q</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((b &lt;&gt; <span class="mi">0</span>) //\\ P) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk300" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk300"><span class="kn">Lemma</span> <span class="nf">triple_ifthenelse</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">P</span> <span class="nv">Q</span>,
  ‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
  ‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk301" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk301"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">P</span> : assertion)
  (<span class="nv">Q</span> : postcond),
‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ -&gt;
‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ -&gt;
‚¶É P ‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk302" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk302"><span class="nb">intros</span> b c1 c2 P Q TR1 TR2 R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>TR1</var><span class="hyp-type"><b>: </b><span>‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ P ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>TR2</var><span class="hyp-type"><b>: </b><span>‚¶É (b = <span class="mi">0</span>) //\\ P ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R) (IFTHENELSE b c1 c2)
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Hoare_ifthenelse; <span class="nb">rewrite</span> &lt;- lift_pureconj; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk303" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk303"><span class="kn">Lemma</span> <span class="nf">Hoare_consequence</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">c</span> <span class="nv">Q&#39;</span> <span class="nv">Q</span>,
  Hoare P&#39; c Q&#39; -&gt;
  P --&gt;&gt; P&#39; -&gt; (<span class="kr">forall</span> <span class="nv">v</span>, Q&#39; v --&gt;&gt; Q v) -&gt;
  Hoare P c Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
Hoare P&#39; c Q&#39; -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; Hoare P c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk304" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk304"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
Hoare P&#39; c Q&#39; -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; Hoare P c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk305" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk305"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Hoare P&#39; c Q&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> safe_consequence <span class="kr">with</span> Q&#39;; <span class="nb">auto</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk306" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk306"><span class="kn">Lemma</span> <span class="nf">triple_consequence</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">c</span> <span class="nv">Q&#39;</span> <span class="nv">Q</span>,
  ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
  P --&gt;&gt; P&#39; -&gt; (<span class="kr">forall</span> <span class="nv">v</span>, Q&#39; v --&gt;&gt; Q v) -&gt;
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk307" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk307"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : assertion) (<span class="nv">P&#39;</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : postcond) (<span class="nv">Q</span> : Z -&gt; assertion),
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ -&gt;
P --&gt;&gt; P&#39; -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v) -&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk308" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk308"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P ** R) c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk309" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk309"><span class="nb">apply</span> Hoare_consequence <span class="kr">with</span> (P&#39; ** R) (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q&#39; v ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (P&#39; ** R) c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q&#39; v ** R)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk30a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk30a"><hr></label><div class="goal-conclusion">P ** R --&gt;&gt; P&#39; ** R</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk30b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk30b"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v ** R --&gt;&gt; Q v ** R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk30c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk30c"><span class="nb">apply</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** R --&gt;&gt; P&#39; ** R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk30d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk30d"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v ** R --&gt;&gt; Q v ** R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk30e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk30e"><span class="nb">apply</span> sepconj_imp_l; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; P&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v --&gt;&gt; Q v</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, Q&#39; v ** R --&gt;&gt; Q v ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">apply</span> sepconj_imp_l; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk30f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk30f"><span class="kn">Lemma</span> <span class="nf">Hoare_pick</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">n</span>,
  Hoare P (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">n</span> : Z),
Hoare P (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk310" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk310"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">n</span> : Z),
Hoare P (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk311" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk311"><span class="nb">intros</span> P n h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PICK n) h (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk312" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk312"><span class="nb">constructor</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PICK n, h)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk313" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk313"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PICK n, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk314" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk314">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">immsafe (PICK n, h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">constructor</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk315" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk315">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c&#39;</span> : com) (<span class="nv">h&#39;</span> : heap),
<span class="nb">red</span> (PICK n, h) (c&#39;, h&#39;) -&gt;
safe c&#39; h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk316" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk316"><span class="nb">intros</span> c&#39; h&#39; RED; inv RED.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe (PURE i) h&#39; (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ P)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk317" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk317"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt;= i &lt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="mi">0</span> &lt;= i &lt; n) //\\ P) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk318" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk318"><span class="kn">Lemma</span> <span class="nf">triple_pick</span>: <span class="kr">forall</span> <span class="nv">n</span>,
  ‚¶É emp ‚¶Ñ
  PICK n
  ‚¶É <span class="kr">fun</span> <span class="nv">i</span> =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : Z,
‚¶É emp ‚¶Ñ PICK n ‚¶É <span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk319" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk319"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : Z,
‚¶É emp ‚¶Ñ PICK n ‚¶É <span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk31a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk31a"><span class="nb">intros</span>; <span class="nb">intros</span> R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare (emp ** R) (PICK n)
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= v &lt; n) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk31b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk31b"><span class="nb">rewrite</span> sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare R (PICK n) (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= v &lt; n) ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk31c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk31c"><span class="nb">eapply</span> Hoare_consequence <span class="kr">with</span> (P&#39; := R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Hoare R (PICK n) <span class="nl">?Q&#39;</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk31d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk31d"><hr></label><div class="goal-conclusion">R --&gt;&gt; R</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk31e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk31e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, <span class="nl">?Q&#39;</span> v --&gt;&gt; pure (<span class="mi">0</span> &lt;= v &lt; n) ** R</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk31f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk31f"><span class="nb">apply</span> Hoare_pick.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R --&gt;&gt; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk320" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk320"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ R) v --&gt;&gt;
pure (<span class="mi">0</span> &lt;= v &lt; n) ** R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk321" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk321"><span class="nb">red</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
(<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; (<span class="mi">0</span> &lt;= i &lt; n) //\\ R) v --&gt;&gt;
pure (<span class="mi">0</span> &lt;= v &lt; n) ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk322" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk322"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>((<span class="mi">0</span> &lt;= v &lt; n) //\\ R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure (<span class="mi">0</span> &lt;= v &lt; n) ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk323" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk323"><span class="nb">rewrite</span> pureconj_sepconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>((<span class="mi">0</span> &lt;= v &lt; n) //\\ R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="mi">0</span> &lt;= v &lt; n) //\\ R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">AlternateSeplog</span>.</span></span></pre><div class="doc">
<a id="lab16"></a><h1 class="section">5. Ramification</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Assume we have a triple <span class="inlinecode">{<span class="id" title="var">P'</span>}</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">{<span class="id" title="var">Q'</span>}</span> and we want to conclude <span class="inlinecode">{<span class="id" title="var">P</span>}</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">{<span class="id" title="var">Q</span>}</span>.
    In general, we need to frame the former triple by an appropriate <span class="inlinecode"><span class="id" title="var">R</span></span>,
    then use the consequence rule to conclude. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk324" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk324"><span class="kn">Lemma</span> <span class="nf">triple_frame_consequence</span>: <span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">P&#39;</span> <span class="nv">Q&#39;</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  P&#39; --&gt;&gt; P ** R -&gt;
  (<span class="kr">forall</span> <span class="nv">v</span>, Q v ** R --&gt;&gt; Q&#39; v) -&gt;
  ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond) (<span class="nv">P&#39;</span> : assertion)
  (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
P&#39; --&gt;&gt; P ** R -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v) -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk325" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk325"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com)
  (<span class="nv">Q</span> : postcond) (<span class="nv">P&#39;</span> : assertion)
  (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
P&#39; --&gt;&gt; P ** R -&gt;
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v) -&gt; ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk326" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk326"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** R</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk327" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk327"><span class="nb">apply</span> triple_consequence <span class="kr">with</span> (P ** R) (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** R</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_frame; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
This rule still needs the user to guess the framing predicate <span class="inlinecode"><span class="id" title="var">R</span></span>.
    An alternate presentation uses the magic wand instead.
    This approach is called "ramification" in the literature. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk328" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk328"><span class="kn">Lemma</span> <span class="nf">triple_ramification</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">P&#39;</span> <span class="nv">Q&#39;</span>,
 ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  P&#39; --&gt;&gt; P ** (aforall (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v --* Q&#39; v)) -&gt;
  ‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">P&#39;</span> : assertion) (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) -&gt;
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk329" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk329"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond)
  (<span class="nv">P&#39;</span> : assertion) (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) -&gt;
‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk32a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk32a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P&#39; ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk32b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk32b"><span class="nb">eapply</span> triple_frame_consequence <span class="kr">with</span> (R := aforall (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v --* Q&#39; v)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="nl">?P</span> ‚¶Ñ c ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk32c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk32c"><hr></label><div class="goal-conclusion">P&#39; --&gt;&gt; <span class="nl">?P</span> ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk32d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk32d"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
<span class="nl">?Q</span> v ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; Q v0 --* Q&#39; v0) --&gt;&gt;
Q&#39; v</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk32e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk32e"><span class="bp">eassumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk32f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk32f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
Q v ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; Q v0 --* Q&#39; v0) --&gt;&gt;
Q&#39; v</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk330" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk330"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
Q v ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; Q v0 --* Q&#39; v0) --&gt;&gt;
Q&#39; v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk331" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk331"><span class="nb">intros</span> v h (h1 &amp; h2 &amp; Q1 &amp; W2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q v h1</span></span></span><br><span><var>W2</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q&#39; v h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk332" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk332"><span class="nb">apply</span> (wand_cancel (Q v)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>P'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v)</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q v h1</span></span></span><br><span><var>W2</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q v ** (Q v --* Q&#39; v)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab17"></a><h1 class="section">6. Weakest preconditions</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab18"></a><h2 class="section">6.1.  Definition and characterization</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Here is one possible definition of the weakest precondition for
    command <span class="inlinecode"><span class="id" title="var">c</span></span> with postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">wp</span> (<span class="nv">c</span>: com) (<span class="nv">Q</span>: postcond) : precond :=
  aexists (<span class="kr">fun</span> <span class="nv">P</span> =&gt; ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ //\\ P).</span></span></pre><div class="doc">
What matters about <span class="inlinecode"><span class="id" title="var">wp</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is that it is a precondition... 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk333" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk333"><span class="kn">Lemma</span> <span class="nf">wp_precond</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É wp c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond), ‚¶É wp c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk334" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk334"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond), ‚¶É wp c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk335" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk335"><span class="nb">intros</span> c Q h (P &amp; T &amp; C).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk336" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk336"><span class="nb">apply</span> T.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
... and it is implied by any other precondition. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk337" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk337"><span class="kn">Lemma</span> <span class="nf">wp_weakest</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  P --&gt;&gt; wp c Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; wp c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk338" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk338"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; wp c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk339" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk339"><span class="nb">intros</span> P c Q T h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">P</span>; <span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
This leads to the following alternate definition of triples in terms
    of weakest preconditions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33a"><span class="kn">Corollary</span> <span class="nf">wp_equiv</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ &lt;-&gt; (P --&gt;&gt; wp c Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ &lt;-&gt; (P --&gt;&gt; wp c Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ &lt;-&gt; (P --&gt;&gt; wp c Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33c"><span class="nb">intros</span>; <span class="nb">split</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --&gt;&gt; wp c Q</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk33d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; wp c Q</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk33d"><hr></label><div class="goal-conclusion">‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --&gt;&gt; wp c Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wp_weakest; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk33f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk33f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; wp c Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_consequence_pre <span class="kr">with</span> (wp c Q); <span class="nb">auto using</span> wp_precond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Here is another definition of the weakest precondition, using the
    operational semantics directly. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">wp&#39;</span> (<span class="nv">c</span>: com) (<span class="nv">Q</span>: postcond) : precond :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; safe c h Q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk340" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk340"><span class="kn">Lemma</span> <span class="nf">wp&#39;_precond</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É wp&#39; c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond), ‚¶É wp&#39; c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk341" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk341"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond), ‚¶É wp&#39; c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk342" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk342"><span class="nb">intros</span> c Q h SAFE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>SAFE</var><span class="hyp-type"><b>: </b><span>wp&#39; c Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">safe c h Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> SAFE.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk343" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk343"><span class="kn">Lemma</span> <span class="nf">wp&#39;_weakest</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">c</span> <span class="nv">Q</span>,
  ‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt;
  P --&gt;&gt; wp&#39; c Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; wp&#39; c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk344" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk344"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : precond) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ -&gt; P --&gt;&gt; wp&#39; c Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk345" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk345"><span class="nb">intros</span>; <span class="nb">intros</span> h Ph.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp&#39; c Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk346" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk346"><span class="nb">apply</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>precond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>‚¶É P ‚¶Ñ c ‚¶É Q ‚¶Ñ</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab19"></a><h2 class="section">6.2. Structural rules for weakest preconditions</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk347" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk347"><span class="kn">Lemma</span> <span class="nf">wp_consequence</span>: <span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">Q&#39;</span>: postcond) <span class="nv">c</span>,
  (<span class="kr">forall</span> <span class="nv">v</span>, Q v --&gt;&gt; Q&#39; v) -&gt;
  wp c Q --&gt;&gt; wp c Q&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">Q&#39;</span> : postcond) (<span class="nv">c</span> : com),
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt; wp c Q --&gt;&gt; wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk348" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk348"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> <span class="nv">Q&#39;</span> : postcond) (<span class="nv">c</span> : com),
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v) -&gt; wp c Q --&gt;&gt; wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk349" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk349"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c Q --&gt;&gt; wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34a"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, Q'</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v --&gt;&gt; Q&#39; v</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c Q ‚¶Ñ c ‚¶É Q&#39; ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_consequence_post <span class="kr">with</span> Q; <span class="nb">auto using</span> wp_precond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34b"><span class="kn">Lemma</span> <span class="nf">wp_frame</span>: <span class="kr">forall</span> <span class="nv">R</span> <span class="nv">c</span> <span class="nv">Q</span>,
  wp c Q ** R --&gt;&gt; wp c (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
wp c Q ** R --&gt;&gt; wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond),
wp c Q ** R --&gt;&gt; wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c Q ** R --&gt;&gt; wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34e"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c Q ** R ‚¶Ñ c ‚¶É <span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk34f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk34f"><span class="nb">apply</span> triple_frame.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c Q ‚¶Ñ c ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wp_precond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk350" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk350"><span class="kn">Corollary</span> <span class="nf">wp_frame_consequence</span>: <span class="kr">forall</span> <span class="nv">R</span> <span class="nv">Q</span> <span class="nv">c</span> <span class="nv">Q&#39;</span>,
  (<span class="kr">forall</span> <span class="nv">v</span>, Q v ** R --&gt;&gt; Q&#39; v) -&gt;
  wp c Q ** R --&gt;&gt; wp c Q&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">Q</span> : Z -&gt; assertion) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v) -&gt;
wp c Q ** R --&gt;&gt; wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk351" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk351"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">R</span> : assertion) (<span class="nv">Q</span> : Z -&gt; assertion) (<span class="nv">c</span> : com)
  (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
(<span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v) -&gt;
wp c Q ** R --&gt;&gt; wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk352" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk352"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(wp c Q ** R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c Q&#39; h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk353" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk353"><span class="nb">apply</span> wp_consequence <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(wp c Q ** R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk354" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(wp c Q ** R) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk354"><hr></label><div class="goal-conclusion">wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk355" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk355"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">v</span> : Z, Q v ** R --&gt;&gt; Q&#39; v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(wp c Q ** R) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wp_frame; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk356" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk356"><span class="kn">Corollary</span> <span class="nf">wp_ramification</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span>,
  wp c Q ** aforall (<span class="kr">fun</span> <span class="nv">v</span> =&gt; Q v --* Q&#39; v) --&gt;&gt; wp c Q&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond) (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
wp c Q ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) --&gt;&gt;
wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk357" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk357"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">Q</span> : postcond) (<span class="nv">Q&#39;</span> : Z -&gt; assertion),
wp c Q ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) --&gt;&gt;
wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk358" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk358"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c Q ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) --&gt;&gt;
wp c Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk359" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk359"><span class="nb">apply</span> wp_frame_consequence.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
Q v ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; Q v0 --* Q&#39; v0) --&gt;&gt;
Q&#39; v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35a"><span class="nb">intros</span> v h (h1 &amp; h2 &amp; A &amp; B &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Q v h1</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q&#39; v h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35b"><span class="nb">apply</span> (wand_cancel (Q v)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>Q'</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Q v h1</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; Q v --* Q&#39; v) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q v ** (Q v --* Q&#39; v)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab20"></a><h2 class="section">6.3.  Weakest precondition rules for our language of pointers</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35c"><span class="kn">Lemma</span> <span class="nf">wp_pure</span>: <span class="kr">forall</span> (<span class="nv">Q</span>: postcond) <span class="nv">v</span>,
  Q v --&gt;&gt; wp (PURE v) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> : postcond) (<span class="nv">v</span> : Z), Q v --&gt;&gt; wp (PURE v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">Q</span> : postcond) (<span class="nv">v</span> : Z), Q v --&gt;&gt; wp (PURE v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v --&gt;&gt; wp (PURE v) Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk35f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk35f"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É Q v ‚¶Ñ PURE v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk360" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk360"><span class="nb">apply</span> triple_pure.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v --&gt;&gt; Q v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk361" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk361"><span class="kn">Lemma</span> <span class="nf">wp_let</span>: <span class="kr">forall</span> <span class="nv">c</span> <span class="nv">f</span> <span class="nv">Q</span>,
  wp c (<span class="kr">fun</span> <span class="nv">v</span> =&gt; wp (f v) Q) --&gt;&gt; wp (LET c f) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">Q</span> : postcond),
wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) --&gt;&gt; wp (LET c f) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk362" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk362"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">c</span> : com) (<span class="nv">f</span> : Z -&gt; com) (<span class="nv">Q</span> : postcond),
wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) --&gt;&gt; wp (LET c f) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk363" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk363"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) --&gt;&gt; wp (LET c f) Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk364" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk364"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) ‚¶Ñ LET c f ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk365" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk365"><span class="nb">eapply</span> triple_let.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) ‚¶Ñ c ‚¶É <span class="nl">?Q</span> ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk366" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk366"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z, ‚¶É <span class="nl">?Q</span> v ‚¶Ñ f v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk367" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk367"><span class="nb">apply</span> wp_precond.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">v</span> : Z,
‚¶É (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; wp (f v0) Q) v ‚¶Ñ f v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk368" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk368"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Z -&gt; com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; wp (f v) Q) v ‚¶Ñ f v ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wp_precond.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk369" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk369"><span class="kn">Lemma</span> <span class="nf">wp_ifthenelse</span>: <span class="kr">forall</span> <span class="nv">b</span> <span class="nv">c1</span> <span class="nv">c2</span> <span class="nv">Q</span>,
  (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt; wp (IFTHENELSE b c1 c2) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">Q</span> : postcond),
(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp (IFTHENELSE b c1 c2) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">b</span> : Z) (<span class="nv">c1</span> <span class="nv">c2</span> : com) (<span class="nv">Q</span> : postcond),
(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp (IFTHENELSE b c1 c2) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp (IFTHENELSE b c1 c2) Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36c"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É <span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q
‚¶Ñ IFTHENELSE b c1 c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36d"><span class="nb">apply</span> triple_ifthenelse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q)
‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk36e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk36e"><hr></label><div class="goal-conclusion">‚¶É (b = <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q)
‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk36f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk36f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (b &lt;&gt; <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q)
‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk370" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk370"><span class="nb">apply</span> triple_consequence_pre <span class="kr">with</span> (wp c1 Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c1 Q ‚¶Ñ c1 ‚¶É Q ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk371" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk371"><hr></label><div class="goal-conclusion">(b &lt;&gt; <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp c1 Q</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk372" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk372"><span class="nb">apply</span> wp_precond.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b &lt;&gt; <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp c1 Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk373" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk373"><span class="nb">intros</span> h (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; <span class="mi">0</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c1 Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk374" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk374"><span class="nb">rewrite</span> &lt;- Z.eqb_neq <span class="kr">in</span> A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(b =? <span class="mi">0</span>) = false</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c1 Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk375" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk375"><span class="nb">rewrite</span> A <span class="kr">in</span> B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>(b =? <span class="mi">0</span>) = false</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>wp c1 Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c1 Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk376" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk376">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É (b = <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q)
‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk377" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk377"><span class="nb">apply</span> triple_consequence_pre <span class="kr">with</span> (wp c2 Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É wp c2 Q ‚¶Ñ c2 ‚¶É Q ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk378" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk378"><hr></label><div class="goal-conclusion">(b = <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp c2 Q</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk379" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk379"><span class="nb">apply</span> wp_precond.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b = <span class="mi">0</span>) //\\ (<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) --&gt;&gt;
wp c2 Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37a"><span class="nb">intros</span> h (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>b = <span class="mi">0</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> b =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c2 Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37b"><span class="nb">subst</span> b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c1, c2</var><span class="hyp-type"><b>: </b><span>com</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>postcond</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> <span class="mi">0</span> =? <span class="mi">0</span> <span class="kr">then</span> wp c2 Q <span class="kr">else</span> wp c1 Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp c2 Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37c"><span class="kn">Lemma</span> <span class="nf">wp_alloc</span>: <span class="kr">forall</span> <span class="nv">sz</span> <span class="nv">Q</span>,
  aforall (<span class="kr">fun</span> <span class="nv">l</span> =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l) --&gt;&gt; wp (ALLOC sz) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">sz</span> : nat) (<span class="nv">Q</span> : Z -&gt; assertion),
aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l) --&gt;&gt;
wp (ALLOC sz) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">sz</span> : nat) (<span class="nv">Q</span> : Z -&gt; assertion),
aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l) --&gt;&gt;
wp (ALLOC sz) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37e"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (ALLOC sz) Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk37f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk37f"><span class="nb">apply</span> wp_ramification <span class="kr">with</span> (Q := <span class="kr">fun</span> <span class="nv">l</span> =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(wp (ALLOC sz)
   (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz) **
 aforall
   (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz --* Q v))
  h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk380" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk380"><span class="nb">apply</span> sepconj_imp_l <span class="kr">with</span> emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp --&gt;&gt;
wp (ALLOC sz)
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk381" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk381"><hr></label><div class="goal-conclusion">(emp **
 aforall
   (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz --* Q v))
  h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk382" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk382"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ‚¶Ñ ALLOC sz
‚¶É <span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz ‚¶Ñ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk383" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk383"><hr></label><div class="goal-conclusion">(emp **
 aforall
   (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz --* Q v))
  h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk384" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk384"><span class="nb">apply</span> triple_alloc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp **
 aforall
   (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz --* Q v))
  h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk385" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk385"><span class="nb">rewrite</span> sepconj_emp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall
  (<span class="kr">fun</span> <span class="nv">l</span> : Z =&gt; (l &lt;&gt; <span class="mi">0</span>) //\\ valid_N l sz --* Q l)
  h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall
  (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (v &lt;&gt; <span class="mi">0</span>) //\\ valid_N v sz --* Q v) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk386" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk386"><span class="kn">Lemma</span> <span class="nf">wp_get</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">Q</span>,
  contains l v ** (contains l v --* Q v) --&gt;&gt; wp (GET l) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
contains l v ** (contains l v --* Q v) --&gt;&gt;
wp (GET l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk387" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk387"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
contains l v ** (contains l v --* Q v) --&gt;&gt;
wp (GET l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk388" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk388"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v ** (contains l v --* Q v) --&gt;&gt;
wp (GET l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk389" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk389"><span class="nb">assert</span> (W: contains l v --&gt;&gt; wp (GET l) (<span class="kr">fun</span> <span class="nv">v&#39;</span> =&gt; (v&#39; = v) //\\ contains l v)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v --&gt;&gt;
wp (GET l) (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk38a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk38a"><hr></label><div class="goal-conclusion">contains l v ** (contains l v --* Q v) --&gt;&gt;
wp (GET l) Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38b">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v --&gt;&gt;
wp (GET l) (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38c" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38c"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É contains l v ‚¶Ñ GET l
‚¶É <span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_get.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v ** (contains l v --* Q v) --&gt;&gt;
wp (GET l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38e"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (GET l) Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk38f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk38f"><span class="nb">eapply</span> wp_ramification.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(wp (GET l) <span class="nl">?Q</span> **
 aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 --* Q v0)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk390" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk390"><span class="nb">eapply</span> sepconj_imp_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; wp (GET l) <span class="nl">?Q</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk391" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk391"><hr></label><div class="goal-conclusion">(<span class="nl">?P</span> ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 --* Q v0)) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk392" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk392"><span class="bp">eexact</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contains l v **
 aforall
   (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
    (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v) v0 --*
    Q v0)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk393" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk393"><span class="nb">eapply</span> sepconj_imp_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt;
aforall
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; (v0 = v) //\\ contains l v --* Q v0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk394" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk394"><hr></label><div class="goal-conclusion">(contains l v ** <span class="nl">?P</span>) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk395" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk395"><span class="mi">2</span>: <span class="bp">eexact</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v --* Q v --&gt;&gt;
aforall
  (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; (v0 = v) //\\ contains l v --* Q v0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk396" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk396"><span class="nb">intros</span> h&#39; H&#39; v&#39; h&#39;&#39; D (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(contains l v --* Q v) h&#39;</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h''</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h&#39; h&#39;&#39;</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>v&#39; = v</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>contains l v h&#39;&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v&#39; (hunion h&#39; h&#39;&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk397" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk397"><span class="nb">subst</span> v&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>contains l v --&gt;&gt;
wp (GET l)
  (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; (v&#39; = v) //\\ contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(contains l v ** (contains l v --* Q v)) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(contains l v --* Q v) h&#39;</span></span></span><br><span><var>h''</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h&#39; h&#39;&#39;</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>contains l v h&#39;&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v (hunion h&#39; h&#39;&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H&#39;; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk398" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk398"><span class="kn">Lemma</span> <span class="nf">wp_set</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">Q</span>,
  valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> =&gt; (contains l v --* Q v&#39;)) --&gt;&gt; wp (SET l v) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
valid l **
aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
wp (SET l v) Q</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk399" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk399"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
valid l **
aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
wp (SET l v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39a" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l **
aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
wp (SET l v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39b" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39b"><span class="nb">assert</span> (W: valid l --&gt;&gt; wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; contains l v)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l --&gt;&gt; wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk39c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk39c"><hr></label><div class="goal-conclusion">valid l **
aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
wp (SET l v) Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39d" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l --&gt;&gt; wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39e" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39e"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid l ‚¶Ñ SET l v ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_set.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk39f" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk39f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l **
aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
wp (SET l v) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a0"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (SET l v) Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a1"><span class="nb">eapply</span> wp_ramification.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(wp (SET l v) <span class="nl">?Q</span> **
 aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 --* Q v0)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a2"><span class="nb">eapply</span> sepconj_imp_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; wp (SET l v) <span class="nl">?Q</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3a3"><hr></label><div class="goal-conclusion">(<span class="nl">?P</span> ** aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; <span class="nl">?Q</span> v0 --* Q v0)) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a4"><span class="bp">eexact</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l **
 aforall
   (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt;
    (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v) v0 --* Q v0)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a5"><span class="nb">eapply</span> sepconj_imp_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; contains l v --* Q v0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3a6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3a6"><hr></label><div class="goal-conclusion">(valid l ** <span class="nl">?P</span>) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a7"><span class="mi">2</span>: <span class="bp">eexact</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; contains l v --* Q v&#39;) --&gt;&gt;
aforall (<span class="kr">fun</span> <span class="nv">v0</span> : Z =&gt; contains l v --* Q v0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a8"><span class="kn">Corollary</span> <span class="nf">wp_set&#39;</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">Q</span>,
  valid l ** (contains l v --* Q) --&gt;&gt; wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : assertion),
valid l ** (contains l v --* Q) --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3a9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">Q</span> : assertion),
valid l ** (contains l v --* Q) --&gt;&gt;
wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3aa"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** (contains l v --* Q)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (SET l v) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ab"><span class="nb">apply</span> wp_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** (contains l v --* Q)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l ** aforall (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v --* Q))
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ac"><span class="nb">eapply</span> sepconj_imp_r; <span class="nb">eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** (contains l v --* Q)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains l v --* Q --&gt;&gt;
aforall (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; contains l v --* Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ad"><span class="nb">intros</span> h&#39; H&#39; v&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** (contains l v --* Q)) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(contains l v --* Q) h&#39;</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contains l v --* Q) h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ae"><span class="kn">Lemma</span> <span class="nf">wp_free</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">Q</span>,
  valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> =&gt; Q v&#39;) --&gt;&gt; wp (FREE l) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">Q</span> : Z -&gt; assertion),
valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
wp (FREE l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3af" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3af"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">Q</span> : Z -&gt; assertion),
valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
wp (FREE l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b0"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
wp (FREE l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b1"><span class="nb">assert</span> (W: valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; emp)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3b2"><hr></label><div class="goal-conclusion">valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
wp (FREE l) Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b3">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b4"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É valid l ‚¶Ñ FREE l ‚¶É <span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_free.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b5">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
wp (FREE l) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b6"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (FREE l) Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b7"><span class="nb">eapply</span> wp_ramification.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(wp (FREE l) <span class="nl">?Q</span> ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; <span class="nl">?Q</span> v --* Q v))
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3b8"><span class="nb">eapply</span> sepconj_imp_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; wp (FREE l) <span class="nl">?Q</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3b9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3b9"><hr></label><div class="goal-conclusion">(<span class="nl">?P</span> ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; <span class="nl">?Q</span> v --* Q v)) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ba"><span class="bp">eexact</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l **
 aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp) v --* Q v))
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3bb"><span class="nb">eapply</span> sepconj_imp_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; emp --* Q v)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3bc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3bc"><hr></label><div class="goal-conclusion">(valid l ** <span class="nl">?P</span>) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3bd"><span class="mi">2</span>: <span class="bp">eexact</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) --&gt;&gt;
aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; emp --* Q v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3be" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3be"><span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br><span><var>h0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) h0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; emp --* Q v) h0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3bf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3bf"><span class="nb">intros</span> v h&#39; D E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br><span><var>h0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) h0</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h0 h&#39;</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v (hunion h0 h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c0"><span class="nb">rewrite</span> E <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br><span><var>h0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) h0</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h0 hempty</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v (hunion h0 hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c1"><span class="nb">rewrite</span> hunion_comm, hunion_empty <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>valid l --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; emp)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;)) h</span></span></span><br><span><var>h0</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">v&#39;</span> : Z =&gt; Q v&#39;) h0</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h0 hempty</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q v h0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H0.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c2"><span class="kn">Corollary</span> <span class="nf">wp_free&#39;</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">Q</span>,
  valid l ** Q --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">Q</span> : assertion),
valid l ** Q --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c3" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">Q</span> : assertion),
valid l ** Q --&gt;&gt; wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c4"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (FREE l) (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c5"><span class="nb">apply</span> wp_free.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(valid l ** aforall (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c6"><span class="nb">eapply</span> sepconj_imp_r; <span class="nb">eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q --&gt;&gt; aforall (<span class="kr">fun</span> <span class="nv">_</span> : Z =&gt; Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c7"><span class="nb">intros</span> h&#39; H&#39; v&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(valid l ** Q) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>Q h&#39;</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c8"><span class="kn">Lemma</span> <span class="nf">wp_pick</span>: <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">Q</span>,
  aforall (<span class="kr">fun</span> <span class="nv">i</span> =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt; wp (PICK n) Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
wp (PICK n) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3c9" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3c9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : Z) (<span class="nv">Q</span> : Z -&gt; assertion),
aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
wp (PICK n) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ca" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ca"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
wp (PICK n) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3cb" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3cb"><span class="nb">assert</span> (W: emp --&gt;&gt; wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp --&gt;&gt; wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3cc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3cc"><hr></label><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
wp (PICK n) Q</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3cd" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3cd">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp --&gt;&gt; wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3ce" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3ce"><span class="nb">apply</span> wp_weakest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚¶É emp ‚¶Ñ PICK n ‚¶É <span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) ‚¶Ñ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> triple_pick.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3cf" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3cf">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
wp (PICK n) Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d0" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d0"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">wp (PICK n) Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d1" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d1"><span class="nb">eapply</span> wp_ramification.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(wp (PICK n) <span class="nl">?Q</span> ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; <span class="nl">?Q</span> v --* Q v))
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d2" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d2"><span class="nb">eapply</span> sepconj_imp_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt; wp (PICK n) <span class="nl">?Q</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3d3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3d3"><hr></label><div class="goal-conclusion">(<span class="nl">?P</span> ** aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; <span class="nl">?Q</span> v --* Q v)) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d4" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d4"><span class="bp">eexact</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp **
 aforall
   (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt;
    (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n)) v --* Q v)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d5" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d5"><span class="nb">eapply</span> sepconj_imp_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?P</span> --&gt;&gt;
aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= v &lt; n) --* Q v)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Seplog-v-chk3d6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><label class="goal-separator" for="Seplog-v-chk3d6"><hr></label><div class="goal-conclusion">(emp ** <span class="nl">?P</span>) h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Seplog-v-chk3d7" style="display: none" type="checkbox"><label class="alectryon-input" for="Seplog-v-chk3d7"><span class="mi">2</span>: <span class="nb">rewrite</span> sepconj_emp; <span class="bp">eexact</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>Z -&gt; assertion</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>emp --&gt;&gt;
wp (PICK n) (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n))</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aforall (<span class="kr">fun</span> <span class="nv">i</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= i &lt; n) --* Q i) --&gt;&gt;
aforall (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; pure (<span class="mi">0</span> &lt;= v &lt; n) --* Q v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">red</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>