<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Separation.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="doc">
Heaps and heap assertions for separation logics. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk0"><span class="kn">From</span> Coq <span class="kn">Require Import</span> ZArith Lia Bool String List.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file ring_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file zify_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file micromega_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote><blockquote class="alectryon-message">[Loading ML file btauto_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> FunctionalExtensionality PropExtensionality.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> Z_scope.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">1. Memory heaps</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
A memory heap is a partial function from addresses (memory locations) 
    to values, with a finite domain. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">addr</span> := Z.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">heap</span> : <span class="kt">Type</span> := {
  contents :&gt; addr -&gt; option Z;
  isfinite :  <span class="kr">exists</span> <span class="nv">i</span>, <span class="kr">forall</span> <span class="nv">j</span>, i &lt;= j -&gt; contents j = None
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1"><span class="kn">Lemma</span> <span class="nf">heap_extensionality</span>:
  <span class="kr">forall</span> (<span class="nv">h1</span> <span class="nv">h2</span>: heap),
  (<span class="kr">forall</span> <span class="nv">l</span>, h1 l = h2 l) -&gt; h1 = h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = h2 l) -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = h2 l) -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = h2 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4"><span class="nb">destruct</span> h1 <span class="kr">as</span> [c1 fin1], h2 <span class="kr">as</span> [c2 fin2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c1</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c1 j = None</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c2 j = None</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
{| contents := c1; isfinite := fin1 |} l =
{| contents := c2; isfinite := fin2 |} l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{| contents := c1; isfinite := fin1 |} =
{| contents := c2; isfinite := fin2 |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk5"><span class="nb">assert</span> (c1 = c2) <span class="bp">by</span> (<span class="nb">apply</span> functional_extensionality; <span class="nb">auto</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c1</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c1 j = None</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c2 j = None</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
{| contents := c1; isfinite := fin1 |} l =
{| contents := c2; isfinite := fin2 |} l</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>c1 = c2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{| contents := c1; isfinite := fin1 |} =
{| contents := c2; isfinite := fin2 |}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6"><span class="nb">subst</span> c2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c1</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin1, fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c1 j = None</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
{| contents := c1; isfinite := fin1 |} l =
{| contents := c1; isfinite := fin2 |} l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{| contents := c1; isfinite := fin1 |} =
{| contents := c1; isfinite := fin2 |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>c1</var><span class="hyp-type"><b>: </b><span>addr -&gt; option Z</span></span></span><br><span><var>fin1, fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; c1 j = None</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
{| contents := c1; isfinite := fin1 |} l =
{| contents := c1; isfinite := fin2 |} l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin1 = fin2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> proof_irrelevance.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The empty heap. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">hempty</span> : heap :=
  {| contents := <span class="kr">fun</span> <span class="nv">l</span> =&gt; None |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z, <span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; None = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The heap that contains <span class="inlinecode"><span class="id" title="var">v</span></span> at address <span class="inlinecode"><span class="id" title="var">l</span></span> and is equal to <span class="inlinecode"><span class="id" title="var">h</span></span> on
    all other addresses. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">hupdate</span> (<span class="nv">l</span>: addr) (<span class="nv">v</span>: Z) (<span class="nv">h</span>: heap) : heap :=
  {| contents := <span class="kr">fun</span> <span class="nv">l&#39;</span> =&gt; <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> h l&#39; |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt;
  (<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> Some v <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka"><span class="nb">destruct</span> (isfinite h) <span class="kr">as</span> (i &amp; fin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt;
  (<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> Some v <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb"><span class="kr">exists</span> (<span class="nv">Z</span>.max i (l + <span class="mi">1</span>)); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i (l + <span class="mi">1</span>) &lt;= j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> Some v <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc"><span class="nb">destruct</span> (Z.eq_dec l j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i (l + <span class="mi">1</span>) &lt;= j</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some v = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i (l + <span class="mi">1</span>) &lt;= j</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; j</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkd"><hr></label><div class="goal-conclusion">h j = None</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i (l + <span class="mi">1</span>) &lt;= j</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h j = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf"><span class="kn">Lemma</span> <span class="nf">hupdate_same</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">h</span>, (hupdate l v h) l = Some v.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap),
hupdate l v h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap),
hupdate l v h l = Some v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l <span class="kr">then</span> Some v <span class="kr">else</span> h l) = Some v</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l l); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12"><span class="kn">Lemma</span> <span class="nf">hupdate_other</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span> <span class="nv">h</span> <span class="nv">l&#39;</span>, l &lt;&gt; l&#39; -&gt; (hupdate l v h) l&#39; = h l&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap) (<span class="nv">l&#39;</span> : addr),
l &lt;&gt; l&#39; -&gt; hupdate l v h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z) (<span class="nv">h</span> : heap) (<span class="nv">l&#39;</span> : addr),
l &lt;&gt; l&#39; -&gt; hupdate l v h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l'</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> Some v <span class="kr">else</span> h l&#39;) = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l l&#39;); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">hsingle</span> (<span class="nv">l</span>: addr) (<span class="nv">v</span>: Z) : heap :=
  hupdate l v hempty.</span></span></pre><div class="doc">
The heap <span class="inlinecode"><span class="id" title="var">h</span></span> after deallocating address <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">hfree</span> (<span class="nv">l</span>: addr) (<span class="nv">h</span>: heap) : heap :=
  {| contents := <span class="kr">fun</span> <span class="nv">l&#39;</span> =&gt; <span class="kr">if</span> Z.eq_dec l l&#39; <span class="kr">then</span> None <span class="kr">else</span> h l&#39; |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt;
  (<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> None <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16"><span class="nb">destruct</span> (isfinite h) <span class="kr">as</span> (i &amp; fin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt;
  (<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> None <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk17"><span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i &lt;= j -&gt; h j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>i &lt;= j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l j <span class="kr">then</span> None <span class="kr">else</span> h j) = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (Z.eq_dec l j); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The heap <span class="inlinecode"><span class="id" title="var">h</span></span> where addresses <span class="inlinecode"><span class="id" title="var">l</span>,</span> <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">sz</span></span> <span class="inlinecode">-</span> <span class="inlinecode">1</span> are initialized to 0. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">hinit</span> (<span class="nv">l</span>: addr) (<span class="nv">sz</span>: nat) (<span class="nv">h</span>: heap) : heap :=
  <span class="kr">match</span> sz <span class="kr">with</span> O =&gt; h | S sz =&gt; hupdate l <span class="mi">0</span> (hinit (l + <span class="mi">1</span>) sz h) <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk18"><span class="kn">Lemma</span> <span class="nf">hinit_inside</span>:
  <span class="kr">forall</span> <span class="nv">h</span> <span class="nv">sz</span> <span class="nv">l</span> <span class="nv">l&#39;</span>, l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt; hinit l sz h l&#39; = Some <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h</span> : heap) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> <span class="nv">l&#39;</span> : Z),
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt; hinit l sz h l&#39; = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk19"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h</span> : heap) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> <span class="nv">l&#39;</span> : Z),
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt; hinit l sz h l&#39; = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a"><span class="nb">induction</span> sz; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l&#39; = Some <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt;
hinit l sz h l&#39; = Some <span class="mi">0</span></span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat (S sz)</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1b"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h l&#39;) = Some <span class="mi">0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l&#39; = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt;
hinit l sz h l&#39; = Some <span class="mi">0</span></span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat (S sz)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h l&#39;) = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1e"><span class="nb">destruct</span> (Z.eq_dec l l&#39;); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt;
hinit l sz h l&#39; = Some <span class="mi">0</span></span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat (S sz)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit (l + <span class="mi">1</span>) sz h l&#39; = Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1f"><span class="nb">apply</span> IHsz.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l &lt;= l&#39; &lt; l + Z.of_nat sz -&gt;
hinit l sz h l&#39; = Some <span class="mi">0</span></span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l &lt;= l&#39; &lt; l + Z.of_nat (S sz)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l + <span class="mi">1</span> &lt;= l&#39; &lt; l + <span class="mi">1</span> + Z.of_nat sz</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk20"><span class="kn">Lemma</span> <span class="nf">hinit_outside</span>:
  <span class="kr">forall</span> <span class="nv">h</span> <span class="nv">sz</span> <span class="nv">l</span> <span class="nv">l&#39;</span>, l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt; hinit l sz h l&#39; = h l&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h</span> : heap) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> <span class="nv">l&#39;</span> : Z),
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">h</span> : heap) (<span class="nv">sz</span> : nat) (<span class="nv">l</span> <span class="nv">l&#39;</span> : Z),
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk22"><span class="nb">induction</span> sz; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat <span class="mi">0</span> &lt;= l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l&#39; = h l&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk23" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat (S sz) &lt;= l&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk23"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h l&#39;) = h l&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk24">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat <span class="mi">0</span> &lt;= l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk25">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat (S sz) &lt;= l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> Z.eq_dec l l&#39;
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> hinit (l + <span class="mi">1</span>) sz h l&#39;) = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk26"><span class="nb">destruct</span> (Z.eq_dec l l&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat (S sz) &lt;= l&#39;</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>l = l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = h l&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk27" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat (S sz) &lt;= l&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; l&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk27"><hr></label><div class="goal-conclusion">hinit (l + <span class="mi">1</span>) sz h l&#39; = h l&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk28"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>sz</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHsz</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> <span class="nv">l&#39;</span> : Z,
l&#39; &lt; l \/ l + Z.of_nat sz &lt;= l&#39; -&gt;
hinit l sz h l&#39; = h l&#39;</span></span></span><br><span><var>l, l'</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>l&#39; &lt; l \/ l + Z.of_nat (S sz) &lt;= l&#39;</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>l &lt;&gt; l&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hinit (l + <span class="mi">1</span>) sz h l&#39; = h l&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHsz; <span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
The disjoint union of two heaps. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">hdisjoint</span> (<span class="nv">h1</span> <span class="nv">h2</span>: heap) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">l</span>, h1 l = None \/ h2 l = None.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk29"><span class="kn">Lemma</span> <span class="nf">hdisjoint_sym</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span>, hdisjoint h1 h2 &lt;-&gt; hdisjoint h2 h1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
hdisjoint h1 h2 &lt;-&gt; hdisjoint h2 h1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
hdisjoint h1 h2 &lt;-&gt; hdisjoint h2 h1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">unfold</span> hdisjoint; <span class="nb">intros</span>; <span class="nb">split</span>; <span class="nb">intros</span> H l; <span class="nb">specialize</span> (H l); <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">hunion</span> (<span class="nv">h1</span> <span class="nv">h2</span>: heap) : heap :=
  {| contents := <span class="kr">fun</span> <span class="nv">l</span> =&gt; <span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2b"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt; (<span class="kr">if</span> h1 j <span class="kr">then</span> h1 j <span class="kr">else</span> h2 j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2c"><span class="nb">destruct</span> (isfinite h1) <span class="kr">as</span> (i1 &amp; fin1), (isfinite h2) <span class="kr">as</span> (i2 &amp; fin2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i1 &lt;= j -&gt; h1 j = None</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i2 &lt;= j -&gt; h2 j = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">i</span> : Z,
  <span class="kr">forall</span> <span class="nv">j</span> : Z,
  i &lt;= j -&gt; (<span class="kr">if</span> h1 j <span class="kr">then</span> h1 j <span class="kr">else</span> h2 j) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2d"><span class="kr">exists</span> (<span class="nv">Z</span>.max i1 i2); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i1 &lt;= j -&gt; h1 j = None</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i2 &lt;= j -&gt; h2 j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i1 i2 &lt;= j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 j <span class="kr">then</span> h1 j <span class="kr">else</span> h2 j) = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2e"><span class="nb">rewrite</span> fin1, fin2 <span class="bp">by</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>i1</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i1 &lt;= j -&gt; h1 j = None</span></span></span><br><span><var>i2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>fin2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">j</span> : Z, i2 &lt;= j -&gt; h2 j = None</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Z.max i1 i2 &lt;= j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk2f"><span class="kn">Lemma</span> <span class="nf">hunion_comm</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span>, hdisjoint h1 h2 -&gt; hunion h2 h1 = hunion h1 h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
hdisjoint h1 h2 -&gt; hunion h2 h1 = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
hdisjoint h1 h2 -&gt; hunion h2 h1 = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk31"><span class="nb">intros</span>; <span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h2 l <span class="kr">then</span> h2 l <span class="kr">else</span> h1 l) =
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk32"><span class="nb">specialize</span> (H l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h1 l = None \/ h2 l = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h2 l <span class="kr">then</span> h2 l <span class="kr">else</span> h1 l) =
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 l), (h2 l); <span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk33"><span class="kn">Lemma</span> <span class="nf">hunion_assoc</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span>, hunion (hunion h1 h2) h3 = hunion h1 (hunion h2 h3).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hunion (hunion h1 h2) h3 = hunion h1 (hunion h2 h3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hunion (hunion h1 h2) h3 = hunion h1 (hunion h2 h3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk35"><span class="nb">intros</span>; <span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> <span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l
 <span class="kr">then</span> <span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l
 <span class="kr">else</span> h3 l) =
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> <span class="kr">if</span> h2 l <span class="kr">then</span> h2 l <span class="kr">else</span> h3 l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 l); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk36"><span class="kn">Lemma</span> <span class="nf">hunion_empty</span>:
  <span class="kr">forall</span> <span class="nv">h</span>, hunion hempty h = h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hunion hempty h = h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk37"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hunion hempty h = h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk38"><span class="nb">intros</span>; <span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = h l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk39"><span class="kn">Lemma</span> <span class="nf">hunion_refl</span>:
  <span class="kr">forall</span> <span class="nv">h</span>, hunion h h = h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hunion h h = h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hunion h h = h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3b"><span class="nb">intros</span>; <span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h l) = h l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h l); <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Lemma hfree_hunion_hupdate:</span>
<span class="c">  forall h l v,</span>
<span class="c">  hdisjoint (hupdate l v hempty) h -&gt;</span>
<span class="c">  hfree l (hunion (hupdate l v hempty) h) = h.</span>
<span class="c">Proof.</span>
<span class="c">  intros; apply heap_extensionality; intros; cbn.</span>
<span class="c">  (* l is the location that is not in h *)</span>
<span class="c">  (* l0 is an arb location *)</span>
<span class="c">  destruct (Z.eq_dec l l0).</span>
<span class="c">  - (* suppose l0 is the location that is not in h.</span>
<span class="c">      use disjointness to show l0/l is not in h *)</span>
<span class="c">    subst.</span>
<span class="c">    unfold hdisjoint in H.</span>
<span class="c">    pose proof (H l0) as H0; destruct H0.</span>
<span class="c">    + rewrite hupdate_same in H0.</span>
<span class="c">      discriminate H0.</span>
<span class="c">    + auto.</span>
<span class="c">  - destruct (h l0); auto.</span>
<span class="c">Qed. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3c"><span class="kn">Lemma</span> <span class="nf">hdisjoint_empty</span>:
  <span class="kr">forall</span> <span class="nv">h</span>, hdisjoint hempty h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hdisjoint hempty h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, hdisjoint hempty h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint hempty h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk3f"><span class="nb">unfold</span> hdisjoint; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hempty l = None \/ h l = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk40"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hempty l = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk41"><span class="kn">Lemma</span> <span class="nf">hdisjoint_union_l</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span>,
  hdisjoint (hunion h1 h2) h3 &lt;-&gt; hdisjoint h1 h3 /\ hdisjoint h2 h3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hdisjoint (hunion h1 h2) h3 &lt;-&gt;
hdisjoint h1 h3 /\ hdisjoint h2 h3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk42"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hdisjoint (hunion h1 h2) h3 &lt;-&gt;
hdisjoint h1 h3 /\ hdisjoint h2 h3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk43"><span class="nb">unfold</span> hdisjoint, hunion; <span class="nb">cbn</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">l</span> : addr,
 (<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None) /\
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk44"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">l</span> : addr,
 (<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None) -&gt;
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None) /\
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk45"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None) /\
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : addr,
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk46">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">l</span> : addr,
 (<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None) -&gt;
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None) /\
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk47"><span class="nb">intros</span> D; <span class="nb">split</span>; <span class="nb">intros</span> l; <span class="nb">destruct</span> (D l); <span class="nb">auto</span>; <span class="nb">destruct</span> (h1 l); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr,
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/
h3 l = None</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Some z = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 l = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">discriminate</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk48">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None) /\
(<span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None) -&gt;
<span class="kr">forall</span> <span class="nv">l</span> : addr,
(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk49"><span class="nb">intros</span> [D1 D2] l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4a"><span class="nb">destruct</span> (D2 l); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h2 l = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4b"><span class="nb">destruct</span> (h1 l) <span class="nb">eqn</span>:H1; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h2 l = None</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = Some z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some z = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4c"><span class="nb">destruct</span> (D1 l); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h1 l = None \/ h3 l = None</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l</span> : addr, h2 l = None \/ h3 l = None</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h2 l = None</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h1 l = Some z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h1 l = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some z = None \/ h3 l = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4d"><span class="kn">Lemma</span> <span class="nf">hdisjoint_union_r</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span>,
  hdisjoint h1 (hunion h2 h3) &lt;-&gt; hdisjoint h1 h2 /\ hdisjoint h1 h3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hdisjoint h1 (hunion h2 h3) &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span> : heap,
hdisjoint h1 (hunion h2 h3) &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk4f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h1 (hunion h2 h3) &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk50"><span class="nb">rewrite</span> hdisjoint_sym.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hunion h2 h3) h1 &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk51"><span class="nb">rewrite</span> hdisjoint_union_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h2 h1 /\ hdisjoint h3 h1 &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk52"><span class="nb">rewrite</span> (hdisjoint_sym h2), (hdisjoint_sym h3).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h1 h2 /\ hdisjoint h1 h3 &lt;-&gt;
hdisjoint h1 h2 /\ hdisjoint h1 h3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Disjointness between three heaps. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">hdisj3</span> (<span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h3</span>: heap) :=
  hdisjoint h1 h2 /\ hdisjoint h1 h3 /\ hdisjoint h2 h3.</span></span></pre><div class="doc">
A tactic to prove disjointness statements. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">HDISJ</span> :=
  <span class="kr">match goal with</span>
  | [ H: hdisj3 _ _ _ |- _ ] =&gt;
      <span class="nb">destruct</span> H <span class="kr">as</span> (? &amp; ? &amp; ?); HDISJ
  | [ H: hdisjoint (hunion _ _) _ |- _ ] =&gt;
      <span class="nb">apply</span> hdisjoint_union_l <span class="kr">in</span> H; <span class="nb">destruct</span> H; HDISJ
  | [ H: hdisjoint _ (hunion _ _) |- _ ] =&gt;
      <span class="nb">apply</span> hdisjoint_union_r <span class="kr">in</span> H; <span class="nb">destruct</span> H; HDISJ
  | [ |- hdisj3 _ _ _ ] =&gt;
      <span class="nb">split</span>; [|<span class="nb">split</span>]; HDISJ
  | [ |- hdisjoint (hunion _ _) _ ] =&gt;
      <span class="nb">apply</span> hdisjoint_union_l; <span class="nb">split</span>; HDISJ
  | [ |- hdisjoint _ (hunion _ _) ] =&gt;
      <span class="nb">apply</span> hdisjoint_union_r; <span class="nb">split</span>; HDISJ
  | [ |- hdisjoint hempty _ ] =&gt;
      <span class="nb">red</span>; <span class="nb">auto</span>
  | [ |- hdisjoint _ hempty ] =&gt;
      <span class="nb">red</span>; <span class="nb">auto</span>
  | [ |- hdisjoint _ _ ] =&gt;
      <span class="bp">assumption</span> || (<span class="nb">apply</span> hdisjoint_sym; <span class="bp">assumption</span>) || <span class="kp">idtac</span>
  | _ =&gt; <span class="kp">idtac</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk53"><span class="kn">Lemma</span> <span class="nf">hunion_invert_r</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span>,
  hunion h h1 = hunion h h2 -&gt; hdisjoint h h1 -&gt; hdisjoint h h2 -&gt; h1 = h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span> : heap,
hunion h h1 = hunion h h2 -&gt;
hdisjoint h h1 -&gt; hdisjoint h h2 -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk54"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span> : heap,
hunion h h1 = hunion h h2 -&gt;
hdisjoint h h1 -&gt; hdisjoint h h2 -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk55"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h h1 = hunion h h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk56"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h h1 = hunion h h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk57"><span class="nb">assert</span> (hunion h h1 l = hunion h h2 l) <span class="bp">by</span> <span class="bp">congruence</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h h1 = hunion h h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h h1 l = hunion h h2 l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk58"><span class="nb">cbn</span> <span class="kr">in</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h h1 = hunion h h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h1 l) =
(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h2 l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk59"><span class="nb">specialize</span> (H0 l); <span class="nb">specialize</span> (H1 l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h h1 = hunion h h2</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h l = None \/ h1 l = None</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>h l = None \/ h2 l = None</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h1 l) =
(<span class="kr">if</span> h l <span class="kr">then</span> h l <span class="kr">else</span> h2 l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 l = h2 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h l); <span class="nb">intuition</span> <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk5a"><span class="kn">Lemma</span> <span class="nf">hunion_invert_l</span>:
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span>,
  hunion h1 h = hunion h2 h -&gt; hdisjoint h1 h -&gt; hdisjoint h2 h -&gt; h1 = h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span> : heap,
hunion h1 h = hunion h2 h -&gt;
hdisjoint h1 h -&gt; hdisjoint h2 h -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk5b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h</span> : heap,
hunion h1 h = hunion h2 h -&gt;
hdisjoint h1 h -&gt; hdisjoint h2 h -&gt; h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk5c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk5d"><span class="nb">apply</span> hunion_invert_r <span class="kr">with</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h h1 = hunion h h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk5e"><hr></label><div class="goal-conclusion">hdisjoint h h1</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk5f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk5f"><hr></label><div class="goal-conclusion">hdisjoint h h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk60"><span class="nb">rewrite</span> &lt;- ! (hunion_comm h) <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h = hunion h2 h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk61" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk61"><hr></label><div class="goal-conclusion">hdisjoint h h1</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk62" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk62"><hr></label><div class="goal-conclusion">hdisjoint h h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk63"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk64"><hr></label><div class="goal-conclusion">hdisjoint h h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk65">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>h1, h2, h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hunion h1 h = hunion h2 h</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">HDISJ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
<a id="lab2"></a><h1 class="section">2. Assertions for separation logic</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">assertion</span> : <span class="kt">Type</span> := heap -&gt; <span class="kt">Prop</span>.</span></span></pre><div class="doc">
Implication (entailment). 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">aimp</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">h</span>, P h -&gt; Q h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;P --&gt;&gt; Q&quot;</span> := (aimp P Q) (<span class="kn">at level</span> <span class="mi">95</span>, <span class="kn">no associativity</span>).</span></span></pre><div class="doc">
Quantification. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">aexists</span> {<span class="nv">A</span>: <span class="kt">Type</span>} (<span class="nv">P</span>: A -&gt; assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; <span class="kr">exists</span> <span class="nv">a</span>: A, P a h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">aforall</span> {<span class="nv">A</span>: <span class="kt">Type</span>} (<span class="nv">P</span>: A -&gt; assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; <span class="kr">forall</span> <span class="nv">a</span>: A, P a h.</span></span></pre><div class="doc">
The assertion "the heap is empty". 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">emp</span> : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; h = hempty.</span></span></pre><div class="doc">
The pure assertion: "the heap is empty and P holds". 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pure</span> (<span class="nv">P</span>: <span class="kt">Prop</span>) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; P /\ h = hempty.</span></span></pre><div class="doc">
The assertion "address <span class="inlinecode"><span class="id" title="var">l</span></span> contains value <span class="inlinecode"><span class="id" title="var">v</span></span>". 
    The domain of the heap must be the singleton <span class="inlinecode">{<span class="id" title="var">l</span>}</span>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">contains</span> (<span class="nv">l</span>: addr) (<span class="nv">v</span>: Z) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; h = hupdate l v hempty.</span></span></pre><div class="doc">
The assertion "address <span class="inlinecode"><span class="id" title="var">l</span></span> is valid" (i.e. in the domain of the heap). 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">valid</span> (<span class="nv">l</span>: addr) : assertion := aexists (contains l).</span></span></pre><div class="doc">
The separating conjunction. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">sepconj</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; <span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span>, P h1
                      /\ Q h2
                      /\ hdisjoint h1 h2  /\ h = hunion h1 h2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;P ** Q&quot;</span> := (sepconj P Q) (<span class="kn">at level</span> <span class="mi">60</span>, <span class="kn">right associativity</span>).</span></span></pre><div class="doc">
The conjunction of a simple assertion and a general assertion. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pureconj</span> (<span class="nv">P</span>: <span class="kt">Prop</span>) (<span class="nv">Q</span>: assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; P /\ Q h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;P //\\ Q&quot;</span> := (pureconj P Q) (<span class="kn">at level</span> <span class="mi">60</span>, <span class="kn">right associativity</span>).</span></span></pre><div class="doc">
Plain conjunction and disjunction. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">aand</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; P h /\ Q h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">aor</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; P h \/ Q h.</span></span></pre><div class="doc">
Extensional equality between assertions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk66"><span class="kn">Lemma</span> <span class="nf">assertion_extensionality</span>:
  <span class="kr">forall</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion),
  (<span class="kr">forall</span> <span class="nv">h</span>, P h &lt;-&gt; Q h) -&gt; P = Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
(<span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h) -&gt; P = Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk67"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
(<span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h) -&gt; P = Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk68"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P = Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk69"><span class="nb">apply</span> functional_extensionality.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : heap, P x = Q x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6a"><span class="nb">intros</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h = Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6b"><span class="nb">apply</span> propositional_extensionality.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">h</span> : heap, P h &lt;-&gt; Q h</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h &lt;-&gt; Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Properties of separating conjunction</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6c"><span class="kn">Lemma</span> <span class="nf">sepconj_comm</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>, P ** Q = Q ** P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q = Q ** P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q = Q ** P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk6e"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">h</span>, (P ** Q) h -&gt; (Q ** P) h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> <span class="nv">Q</span> : assertion) (<span class="nv">h</span> : heap),
(P ** Q) h -&gt; (Q ** P) h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk6f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> <span class="nv">Q</span> : assertion) (<span class="nv">h</span> : heap),
(P ** Q) h -&gt; (Q ** P) h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk6f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q = Q ** P</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk70">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> <span class="nv">Q</span> : assertion) (<span class="nv">h</span> : heap),
(P ** Q) h -&gt; (Q ** P) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk71"><span class="nb">intros</span> P Q h (h1 &amp; h2 &amp; P1 &amp; Q2 &amp; EQ &amp; DISJ); <span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q ** P) (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk72"><span class="kr">exists</span> <span class="nv">h2</span>, h1; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h2 h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk73"><hr></label><div class="goal-conclusion">hunion h1 h2 = hunion h2 h1</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk74"><span class="nb">apply</span> hdisjoint_sym; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 = hunion h2 h1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; <span class="nb">apply</span> hunion_comm; <span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk75">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> <span class="nv">Q</span> : assertion) (<span class="nv">h</span> : heap),
(P ** Q) h -&gt; (Q ** P) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q = Q ** P</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>; <span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk76"><span class="kn">Lemma</span> <span class="nf">sepconj_assoc</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>, (P ** Q) ** R = P ** (Q ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion, (P ** Q) ** R = P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk77"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion, (P ** Q) ** R = P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk78"><span class="nb">intros</span>; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) h -&gt; (P ** Q ** R) h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk79"><hr></label><div class="goal-conclusion">(P ** Q ** R) h -&gt; ((P ** Q) ** R) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) h -&gt; (P ** Q ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7b"><span class="nb">intros</span> (hx &amp; h3 &amp; (h1 &amp; h2 &amp; P1 &amp; Q2 &amp; EQ &amp; DISJ) &amp; R3 &amp; EQ&#39; &amp; DISJ&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, hx, h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hx = hunion h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint hx h3</span></span></span><br><span><var>DISJ'</var><span class="hyp-type"><b>: </b><span>h = hunion hx h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7c"><span class="nb">subst</span> hx h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q ** R) (hunion (hunion h1 h2) h3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7d"><span class="nb">rewrite</span> hdisjoint_union_l <span class="kr">in</span> EQ&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3 /\ hdisjoint h2 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q ** R) (hunion (hunion h1 h2) h3)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7e"><span class="nb">rewrite</span> hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3 /\ hdisjoint h2 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q ** R) (hunion h1 (hunion h2 h3))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk7f"><span class="kr">exists</span> <span class="nv">h1</span>, (hunion h2 h3); <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q ** R) (hunion h2 h3)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk80" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk80"><hr></label><div class="goal-conclusion">hdisjoint h1 (hunion h2 h3)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk81"><span class="kr">exists</span> <span class="nv">h2</span>, h3; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h3, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h1 (hunion h2 h3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hdisjoint_union_r; <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk82">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q ** R) h -&gt; ((P ** Q) ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk83"><span class="nb">intros</span> (h1 &amp; hx &amp; P1 &amp; (h2 &amp; h3 &amp; Q2 &amp; R3 &amp; EQ &amp; DISJ) &amp; EQ&#39; &amp; DISJ&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, hx</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hx = hunion h2 h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 hx</span></span></span><br><span><var>DISJ'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 hx</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk84"><span class="nb">subst</span> hx h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 (hunion h2 h3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) (hunion h1 (hunion h2 h3))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk85"><span class="nb">rewrite</span> hdisjoint_union_r <span class="kr">in</span> EQ&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2 /\ hdisjoint h1 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) (hunion h1 (hunion h2 h3))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk86"><span class="nb">rewrite</span> &lt;- hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>EQ'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2 /\ hdisjoint h1 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** Q) ** R) (hunion (hunion h1 h2) h3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk87"><span class="kr">exists</span> (<span class="nv">hunion</span> <span class="nv">h1</span> <span class="nv">h2</span>), h3; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q) (hunion h1 h2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk88" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk88"><hr></label><div class="goal-conclusion">hdisjoint (hunion h1 h2) h3</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk89"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2, h3</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>R3</var><span class="hyp-type"><b>: </b><span>R h3</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h3</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hunion h1 h2) h3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hdisjoint_union_l; <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8a"><span class="kn">Lemma</span> <span class="nf">sepconj_emp</span>: <span class="kr">forall</span> <span class="nv">P</span>, emp ** P = P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, emp ** P = P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, emp ** P = P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8c"><span class="nb">intros</span>; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** P) h -&gt; P h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk8d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk8d"><hr></label><div class="goal-conclusion">P h -&gt; (emp ** P) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** P) h -&gt; P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk8f"><span class="nb">intros</span> (h1 &amp; h2 &amp; EMP1 &amp; P2 &amp; EQ &amp; DISJ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>EMP1</var><span class="hyp-type"><b>: </b><span>emp h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk90"><span class="nb">red</span> <span class="kr">in</span> EMP1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>EMP1</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk91"><span class="nb">subst</span> h h1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hunion hempty h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_empty; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk92">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h -&gt; (emp ** P) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk93"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(emp ** P) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk94"><span class="kr">exists</span> <span class="nv">hempty</span>, h; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">emp hempty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk95"><hr></label><div class="goal-conclusion">hdisjoint hempty h</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk96" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk96"><hr></label><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk97"><span class="nb">red</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint hempty h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk98" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk98"><hr></label><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk99"><span class="nb">red</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_empty; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9a"><span class="kn">Lemma</span> <span class="nf">sepconj_imp_l</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  (P --&gt;&gt; Q) -&gt; (P ** R --&gt;&gt; Q ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P --&gt;&gt; Q -&gt; P ** R --&gt;&gt; Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P --&gt;&gt; Q -&gt; P ** R --&gt;&gt; Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9c"><span class="nb">intros</span> P Q R IMP h (h1 &amp; h2 &amp; P1 &amp; Q2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">intuition</span> <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9d"><span class="kn">Lemma</span> <span class="nf">sepconj_imp_r</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  (P --&gt;&gt; Q) -&gt; (R ** P --&gt;&gt; R ** Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P --&gt;&gt; Q -&gt; R ** P --&gt;&gt; R ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P --&gt;&gt; Q -&gt; R ** P --&gt;&gt; R ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk9f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R ** P --&gt;&gt; R ** Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka0"><span class="nb">rewrite</span> ! (sepconj_comm R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** R --&gt;&gt; Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> sepconj_imp_l; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">Other useful logical properties</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka1"><span class="kn">Lemma</span> <span class="nf">pure_sep</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>,
  pure (P /\ Q) = pure P ** pure Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : <span class="kt">Prop</span>, pure (P /\ Q) = pure P ** pure Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : <span class="kt">Prop</span>, pure (P /\ Q) = pure P ** pure Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure (P /\ Q) = pure P ** pure Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka4"><span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure (P /\ Q) h &lt;-&gt; (pure P ** pure Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka5"><span class="nb">unfold</span> pure, sepconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P /\ Q) /\ h = hempty &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
   (P /\ h1 = hempty) /\
   (Q /\ h2 = hempty) /\
   hdisjoint h1 h2 /\ h = hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka6"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P /\ Q) /\ h = hempty -&gt;
<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  (Q /\ h2 = hempty) /\
  hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chka7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chka7"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
   (P /\ h1 = hempty) /\
   (Q /\ h2 = hempty) /\
   hdisjoint h1 h2 /\ h = hunion h1 h2) -&gt;
(P /\ Q) /\ h = hempty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P /\ Q) /\ h = hempty -&gt;
<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  (Q /\ h2 = hempty) /\
  hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chka9"><span class="nb">intros</span> ((A &amp; B) &amp; C).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>h = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  (Q /\ h2 = hempty) /\
  hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkaa"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  (Q /\ h2 = hempty) /\
  hdisjoint h1 h2 /\ hempty = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkab"><span class="kr">exists</span> <span class="nv">hempty</span>, hempty; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint hempty hempty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkac" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkac"><hr></label><div class="goal-conclusion">hempty = hunion hempty hempty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkad"><span class="nb">intro</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hempty = hunion hempty hempty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_empty; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkae">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
   (P /\ h1 = hempty) /\
   (Q /\ h2 = hempty) /\
   hdisjoint h1 h2 /\ h = hunion h1 h2) -&gt;
(P /\ Q) /\ h = hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkaf"><span class="nb">intros</span> (h1 &amp; h2 &amp; (PP &amp; E1) &amp; (QQ &amp; E2) &amp; C &amp; D).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>E1</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>QQ</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br><span><var>E2</var><span class="hyp-type"><b>: </b><span>h2 = hempty</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P /\ Q) /\ h = hempty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb0"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>QQ</var><span class="hyp-type"><b>: </b><span>Q</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P /\ Q) /\ hunion hempty hempty = hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_empty; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb1"><span class="kn">Lemma</span> <span class="nf">pureconj_sepconj</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>,
  pure P ** Q = P //\\ Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> : assertion),
pure P ** Q = P //\\ Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> : assertion),
pure P ** Q = P //\\ Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure P ** Q = P //\\ Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb4"><span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure P ** Q) h &lt;-&gt; (P //\\ Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb5"><span class="nb">unfold</span> pure, sepconj, pureconj; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
   (P /\ h1 = hempty) /\
   Q h2 /\ hdisjoint h1 h2 /\ h = hunion h1 h2) -&gt;
P /\ Q h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkb6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkb6"><hr></label><div class="goal-conclusion">P /\ Q h -&gt;
<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  Q h2 /\ hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
   (P /\ h1 = hempty) /\
   Q h2 /\ hdisjoint h1 h2 /\ h = hunion h1 h2) -&gt;
P /\ Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb8"><span class="nb">intros</span> (h1 &amp; h2 &amp; (A &amp; B) &amp; C &amp; D &amp; E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P /\ Q h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkb9"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkba"><hr></label><div class="goal-conclusion">Q h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkbb"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkbc"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion hempty h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkbd"><span class="nb">rewrite</span> hunion_empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkbe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P /\ Q h -&gt;
<span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  Q h2 /\ hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkbf"><span class="nb">intros</span> (A &amp; B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">h1</span> <span class="nv">h2</span> : heap,
  (P /\ h1 = hempty) /\
  Q h2 /\ hdisjoint h1 h2 /\ h = hunion h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc0"><span class="kr">exists</span> <span class="nv">hempty</span>, h; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint hempty h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkc1"><hr></label><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></div></small><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc2"><span class="nb">intro</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hempty l = None \/ h l = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkc3"><hr></label><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc4"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h = hunion hempty h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_empty; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc5"><span class="kn">Lemma</span> <span class="nf">lift_pureconj</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>, (P //\\ Q) ** R = P //\\ (Q ** R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> <span class="nv">R</span> : assertion),
(P //\\ Q) ** R = P //\\ Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> <span class="nv">R</span> : assertion),
(P //\\ Q) ** R = P //\\ Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P //\\ Q) ** R = P //\\ Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc8"><span class="nb">rewrite</span> &lt;- ! pureconj_sepconj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure P ** Q) ** R = pure P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkc9"><span class="nb">rewrite</span> sepconj_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure P ** Q ** R = pure P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkca"><span class="kn">Lemma</span> <span class="nf">lift_aexists</span>: <span class="kr">forall</span> (<span class="nv">A</span>: <span class="kt">Type</span>) (<span class="nv">P</span>: A -&gt; assertion) <span class="nv">Q</span>,
  aexists P ** Q = aexists (<span class="kr">fun</span> <span class="nv">x</span> =&gt; P x ** Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : A -&gt; assertion) (<span class="nv">Q</span> : assertion),
aexists P ** Q = aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkcb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : A -&gt; assertion) (<span class="nv">Q</span> : assertion),
aexists P ** Q = aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkcc"><span class="nb">intros</span>; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aexists P ** Q) h -&gt;
aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q) h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkcd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkcd"><hr></label><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q) h -&gt;
(aexists P ** Q) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkce">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aexists P ** Q) h -&gt;
aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkcf"><span class="nb">intros</span> (h1 &amp; h2 &amp; (a &amp; P1) &amp; Q2 &amp; DISJ &amp; EQ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P a h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a</span>, h1, h2; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; P x ** Q) h -&gt;
(aexists P ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd1"><span class="nb">intros</span> (a &amp; h1 &amp; h2 &amp; P1 &amp; Q2 &amp; DISJ &amp; EQ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P a h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aexists P ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd2"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; assertion</span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P a h1</span></span></span><br><span><var>Q2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>EQ</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists P h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">a</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd3"><span class="kn">Lemma</span> <span class="nf">sepconj_swap3</span>: <span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span>, P ** Q ** R = R ** P ** Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q ** R = R ** P ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** Q ** R = R ** P ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd5"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R, P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q ** R = R ** P ** Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd6"><span class="nb">rewrite</span> &lt;- sepconj_assoc, sepconj_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R, P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R ** P ** Q = R ** P ** Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd7"><span class="kn">Lemma</span> <span class="nf">sepconj_swap4</span>: <span class="kr">forall</span> <span class="nv">S</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>, P ** Q ** R ** S = S ** P ** Q ** R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">S</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P ** Q ** R ** S = S ** P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">S</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P ** Q ** R ** S = S ** P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkd9"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S, P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q ** R ** S = S ** P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkda"><span class="nb">rewrite</span> &lt;- sepconj_assoc, sepconj_swap3, sepconj_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S, P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ** P ** Q ** R = S ** P ** Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkdb"><span class="kn">Lemma</span> <span class="nf">sepconj_pick2</span>: <span class="kr">forall</span> <span class="nv">Q</span> <span class="nv">P</span> <span class="nv">R</span>, P ** Q ** R = Q ** P ** R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">Q</span> <span class="nv">P</span> <span class="nv">R</span> : assertion, P ** Q ** R = Q ** P ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkdc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">Q</span> <span class="nv">P</span> <span class="nv">R</span> : assertion, P ** Q ** R = Q ** P ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkdd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, P, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q ** R = Q ** P ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkde"><span class="nb">rewrite</span> (sepconj_comm Q), &lt;- sepconj_assoc, sepconj_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Q, P, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q ** P ** R = Q ** P ** R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkdf"><span class="kn">Lemma</span> <span class="nf">sepconj_pick3</span>: <span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">S</span>, P ** Q ** R ** S = R ** P ** Q ** S.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">S</span> : assertion,
P ** Q ** R ** S = R ** P ** Q ** S</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">R</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">S</span> : assertion,
P ** Q ** R ** S = R ** P ** Q ** S</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R, P, Q, S</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q ** R ** S = R ** P ** Q ** S</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke2"><span class="nb">rewrite</span> (sepconj_pick2 R), (sepconj_pick2 P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R, P, Q, S</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** R ** Q ** S = P ** R ** Q ** S</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h2 class="section">Magic wand</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">wand</span> (<span class="nv">P</span> <span class="nv">Q</span>: assertion) : assertion :=
  <span class="kr">fun</span> <span class="nv">h</span> =&gt; <span class="kr">forall</span> <span class="nv">h&#39;</span>, hdisjoint h h&#39; -&gt; P h&#39; -&gt; Q (hunion h h&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;P --* Q&quot;</span> := (wand P Q) (<span class="kn">at level</span> <span class="mi">70</span>, <span class="kn">right associativity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke3"><span class="kn">Lemma</span> <span class="nf">wand_intro</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  P ** Q --&gt;&gt; R  -&gt;  P --&gt;&gt; Q --* R.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P ** Q --&gt;&gt; R -&gt; P --&gt;&gt; Q --* R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
P ** Q --&gt;&gt; R -&gt; P --&gt;&gt; Q --* R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke5"><span class="nb">intros</span> P Q R IMP h Ph h&#39; DISJ Qh&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span>P ** Q --&gt;&gt; R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Qh'</var><span class="hyp-type"><b>: </b><span>Q h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke6"><span class="nb">apply</span> IMP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>IMP</var><span class="hyp-type"><b>: </b><span>P ** Q --&gt;&gt; R</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph</var><span class="hyp-type"><b>: </b><span>P h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Qh'</var><span class="hyp-type"><b>: </b><span>Q h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q) (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h</span>, h&#39;; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke7"><span class="kn">Lemma</span> <span class="nf">wand_cancel</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>,
  P ** (P --* Q) --&gt;&gt; Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** (P --* Q) --&gt;&gt; Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion, P ** (P --* Q) --&gt;&gt; Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chke9"><span class="nb">intros</span> P Q h (h1 &amp; h2 &amp; Ph1 &amp; Wh2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>(P --* Q) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkea"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>(P --* Q) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkeb"><span class="nb">assert</span> (D&#39;: hdisjoint h2 h1) <span class="bp">by</span> (<span class="nb">apply</span> hdisjoint_sym; <span class="nb">auto</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>(P --* Q) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkec"><span class="nb">rewrite</span> hunion_comm <span class="bp">by</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>(P --* Q) h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h2 h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h2 h1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Wh2; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chked"><span class="kn">Lemma</span> <span class="nf">wand_charact</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>,
  (P --*Q) = (aexists (<span class="kr">fun</span> <span class="nv">R</span> =&gt; (P ** R --&gt;&gt; Q) //\\ R)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
(P --* Q) =
aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
(P --* Q) =
aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkef"><span class="nb">intros</span> P Q; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span> h; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* Q) h -&gt;
aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)
  h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkf0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkf0"><hr></label><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)
  h -&gt; (P --* Q) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* Q) h -&gt;
aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf2"><span class="nb">intros</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)
  h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf3"><span class="kr">exists</span> (<span class="nv">P</span> --* Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((P ** (P --* Q) --&gt;&gt; Q) //\\ (P --* Q)) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf4"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** (P --* Q) --&gt;&gt; Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wand_cancel.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aexists (<span class="kr">fun</span> <span class="nv">R</span> : assertion =&gt; (P ** R --&gt;&gt; Q) //\\ R)
  h -&gt; (P --* Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf6"><span class="nb">intros</span> (R &amp; A &amp; B) h&#39; D Ph&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P ** R --&gt;&gt; Q</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf7"><span class="nb">assert</span> (D&#39;: hdisjoint h&#39; h) <span class="bp">by</span> (<span class="nb">apply</span> hdisjoint_sym; <span class="nb">auto</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P ** R --&gt;&gt; Q</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h&#39; h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf8"><span class="nb">rewrite</span> hunion_comm <span class="bp">by</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P ** R --&gt;&gt; Q</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h&#39; h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h&#39; h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkf9"><span class="nb">apply</span> A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>P ** R --&gt;&gt; Q</span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>R h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h&#39; h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** R) (hunion h&#39; h)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">h&#39;</span>, h; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkfa"><span class="kn">Lemma</span> <span class="nf">wand_equiv</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  (P --&gt;&gt; (Q --* R)) &lt;-&gt; (P ** Q --&gt;&gt; R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P --&gt;&gt; Q --* R) &lt;-&gt; (P ** Q --&gt;&gt; R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkfb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P --&gt;&gt; Q --* R) &lt;-&gt; (P ** Q --&gt;&gt; R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkfc"><span class="nb">intros</span>; <span class="nb">split</span>; <span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q --* R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q --&gt;&gt; R</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P ** Q --&gt;&gt; R</span></span></span><br></div><label class="goal-separator" for="Separation-v-chkfd"><hr></label><div class="goal-conclusion">P --&gt;&gt; Q --* R</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkfe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q --* R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** Q --&gt;&gt; R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chkff"><span class="nb">intros</span> h (h1 &amp; h2 &amp; Ph1 &amp; Wh2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q --* R</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk100"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P --&gt;&gt; Q --* R</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Wh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk101">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P ** Q --&gt;&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --&gt;&gt; Q --* R</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wand_intro; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk102"><span class="kn">Lemma</span> <span class="nf">wand_imp_l</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">Q</span>,
  (P&#39; --&gt;&gt; P) -&gt; (P --* Q --&gt;&gt; P&#39; --* Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">Q</span> : assertion,
P&#39; --&gt;&gt; P -&gt; P --* Q --&gt;&gt; P&#39; --* Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk103"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">P&#39;</span> <span class="nv">Q</span> : assertion,
P&#39; --&gt;&gt; P -&gt; P --* Q --&gt;&gt; P&#39; --* Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk104"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, P', Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --* Q --&gt;&gt; P&#39; --* Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk105"><span class="nb">intros</span> h W h&#39; DISJ P&#39;h&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, P', Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>P&#39; --&gt;&gt; P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>P'h'</var><span class="hyp-type"><b>: </b><span>P&#39; h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> W; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk106"><span class="kn">Lemma</span> <span class="nf">wand_imp_r</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span>,
  (Q --&gt;&gt; Q&#39;) -&gt; (P --* Q --&gt;&gt; P --* Q&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span> : assertion,
Q --&gt;&gt; Q&#39; -&gt; P --* Q --&gt;&gt; P --* Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk107"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">Q&#39;</span> : assertion,
Q --&gt;&gt; Q&#39; -&gt; P --* Q --&gt;&gt; P --* Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk108"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, Q'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q --&gt;&gt; Q&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P --* Q --&gt;&gt; P --* Q&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk109"><span class="nb">intros</span> h W h&#39; DISJ Ph&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, Q'</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Q --&gt;&gt; Q&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q&#39; (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> H; <span class="nb">apply</span> W; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10a"><span class="kn">Lemma</span> <span class="nf">wand_idem</span>: <span class="kr">forall</span> <span class="nv">P</span>,
  emp --&gt;&gt; P --* P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, emp --&gt;&gt; P --* P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, emp --&gt;&gt; P --* P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10c"><span class="nb">intros</span> P h E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* P) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10d"><span class="nb">rewrite</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* P) hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10e"><span class="nb">red</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h&#39;</span> : heap,
hdisjoint hempty h&#39; -&gt; P h&#39; -&gt; P (hunion hempty h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk10f"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty h&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (hunion hempty h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk110"><span class="nb">rewrite</span> hunion_empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>emp h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint hempty h&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk111"><span class="kn">Lemma</span> <span class="nf">wand_pure_l</span>: <span class="kr">forall</span> (<span class="nv">P</span>: <span class="kt">Prop</span>) <span class="nv">Q</span>,
  P -&gt; (pure P --* Q) = Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> : assertion),
P -&gt; (pure P --* Q) = Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk112"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : <span class="kt">Prop</span>) (<span class="nv">Q</span> : assertion),
P -&gt; (pure P --* Q) = Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk113"><span class="nb">intros</span> P Q PP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure P --* Q) = Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk114"><span class="nb">apply</span> assertion_extensionality.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">h</span> : heap, (pure P --* Q) h &lt;-&gt; Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk115"><span class="nb">intros</span> h; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure P --* Q) h -&gt; Q h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk116" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk116"><hr></label><div class="goal-conclusion">Q h -&gt; (pure P --* Q) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk117">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pure P --* Q) h -&gt; Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk118"><span class="nb">intros</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(pure P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk119"><span class="nb">rewrite</span> &lt;- hunion_empty, hunion_comm <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(pure P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11a"><span class="nb">apply</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(pure P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h hempty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(pure P --* Q) h</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk11b"><hr></label><div class="goal-conclusion">pure P hempty</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11c">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(pure P --* Q) h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure P hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h -&gt; (pure P --* Q) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11e"><span class="nb">intros</span> Qh h&#39; DISJ (Ph&#39; &amp; E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Qh</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk11f"><span class="nb">subst</span> h&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Qh</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h hempty</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h hempty)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk120"><span class="nb">rewrite</span> hunion_comm, hunion_empty <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PP</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Qh</var><span class="hyp-type"><b>: </b><span>Q h</span></span></span><br><span><var>DISJ</var><span class="hyp-type"><b>: </b><span>hdisjoint h hempty</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk121"><span class="kn">Lemma</span> <span class="nf">wand_curry</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  (P ** Q --* R) = (P --* Q --* R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P ** Q --* R) = (P --* Q --* R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk122"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P ** Q --* R) = (P --* Q --* R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk123"><span class="nb">intros</span>; <span class="nb">apply</span> assertion_extensionality; <span class="nb">intros</span> h; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q --* R) h -&gt; (P --* Q --* R) h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk124" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk124"><hr></label><div class="goal-conclusion">(P --* Q --* R) h -&gt; (P ** Q --* R) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk125">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q --* R) h -&gt; (P --* Q --* R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk126"><span class="nb">intros</span> W h1 D1 Ph1 h2 D2 Qh2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion (hunion h h1) h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk127"><span class="nb">rewrite</span> hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion h (hunion h1 h2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk128"><span class="nb">apply</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h (hunion h1 h2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk129" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk129"><hr></label><div class="goal-conclusion">(P ** Q) (hunion h1 h2)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12a">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P ** Q) (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12b"><span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P ** Q --* R) h</span></span></span><br><span><var>h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D1</var><span class="hyp-type"><b>: </b><span>hdisjoint h h1</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h h1) h2</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h1 h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">HDISJ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* Q --* R) h -&gt; (P ** Q --* R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12d"><span class="nb">intros</span> W h&#39; D (h1 &amp; h2 &amp; Ph1 &amp; Qh2 &amp; D12 &amp; U12).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h h&#39;</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U12</var><span class="hyp-type"><b>: </b><span>h&#39; = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion h h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12e"><span class="nb">subst</span> h&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion h (hunion h1 h2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk12f"><span class="nb">rewrite</span> &lt;- hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R (hunion (hunion h h1) h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk130"><span class="nb">apply</span> W.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk131" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk131"><hr></label><div class="goal-conclusion">P h1</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk132" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk132"><hr></label><div class="goal-conclusion">hdisjoint (hunion h h1) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk133" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk133"><hr></label><div class="goal-conclusion">Q h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk134">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk135" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk135"><hr></label><div class="goal-conclusion">hdisjoint (hunion h h1) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk136" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk136"><hr></label><div class="goal-conclusion">Q h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk137"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hunion h h1) h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk138" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk138"><hr></label><div class="goal-conclusion">Q h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk139">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span>(P --* Q --* R) h</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h (hunion h1 h2)</span></span></span><br><span><var>Ph1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>Qh2</var><span class="hyp-type"><b>: </b><span>Q h2</span></span></span><br><span><var>D12</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13a"><span class="kn">Lemma</span> <span class="nf">wand_star</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span>,
  ((P --* Q) ** R ) --&gt;&gt; (P --* (Q ** R)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P --* Q) ** R --&gt;&gt; P --* Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> <span class="nv">R</span> : assertion,
(P --* Q) ** R --&gt;&gt; P --* Q ** R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13c"><span class="nb">intros</span>; <span class="nb">intros</span> h (h1 &amp; h2 &amp; W1 &amp; R2 &amp; D &amp; U).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>U</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* Q ** R) h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13d"><span class="nb">subst</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(P --* Q ** R) (hunion h1 h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13e"><span class="nb">intros</span> h&#39; D&#39; Ph&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Q ** R) (hunion (hunion h1 h2) h&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk13f"><span class="kr">exists</span> (<span class="nv">hunion</span> <span class="nv">h1</span> <span class="nv">h&#39;</span>), h2; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Q (hunion h1 h&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk140" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk140"><hr></label><div class="goal-conclusion">hdisjoint (hunion h1 h&#39;) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk141" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk141"><hr></label><div class="goal-conclusion">hunion (hunion h1 h2) h&#39; = hunion (hunion h1 h&#39;) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk142"><span class="nb">apply</span> W1; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h1 h&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk143" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk143"><hr></label><div class="goal-conclusion">hdisjoint (hunion h1 h&#39;) h2</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk144" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk144"><hr></label><div class="goal-conclusion">hunion (hunion h1 h2) h&#39; = hunion (hunion h1 h&#39;) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk145">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint (hunion h1 h&#39;) h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk146"><hr></label><div class="goal-conclusion">hunion (hunion h1 h2) h&#39; = hunion (hunion h1 h&#39;) h2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk147">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion (hunion h1 h2) h&#39; = hunion (hunion h1 h&#39;) h2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk148"><span class="nb">rewrite</span> ! hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 (hunion h2 h&#39;) = hunion h1 (hunion h&#39; h2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk149"><span class="nb">f_equal</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h2 h&#39; = hunion h&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14a"><span class="nb">apply</span> hunion_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q, R</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>W1</var><span class="hyp-type"><b>: </b><span>(P --* Q) h1</span></span></span><br><span><var>R2</var><span class="hyp-type"><b>: </b><span>R h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h1 h2) h&#39;</span></span></span><br><span><var>Ph'</var><span class="hyp-type"><b>: </b><span>P h&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h&#39; h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">HDISJ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab6"></a><h2 class="section">Precise assertions</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
An assertion is precise if "it unambiguously carves out an area of the heap"
   (in the words of Gotsman, Berdine, Cook, 2011). 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">precise</span> (<span class="nv">P</span>: assertion) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h1&#39;</span> <span class="nv">h2&#39;</span>,
  hdisjoint h1 h2 -&gt; hdisjoint h1&#39; h2&#39; -&gt; hunion h1 h2 = hunion h1&#39; h2&#39; -&gt;
  P h1 -&gt; P h1&#39; -&gt; h1 = h1&#39;.</span></span></pre><div class="doc">
A parameterized assertion is precise if, in addition, the parameter
   is uniquely determined as well. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">param_precise</span> {<span class="nv">X</span>: <span class="kt">Type</span>} (<span class="nv">P</span>: X -&gt; assertion) : <span class="kt">Prop</span> :=
  <span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">h1</span> <span class="nv">h2</span> <span class="nv">h1&#39;</span> <span class="nv">h2&#39;</span>,
  hdisjoint h1 h2 -&gt; hdisjoint h1&#39; h2&#39; -&gt; hunion h1 h2 = hunion h1&#39; h2&#39; -&gt;
  P x1 h1 -&gt; P x2 h1&#39; -&gt; x1 = x2 /\ h1 = h1&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14b"><span class="kn">Remark</span> <span class="nf">param_precise_precise</span>:
  <span class="kr">forall</span> (<span class="nv">X</span>: <span class="kt">Type</span>) (<span class="nv">P</span>: X -&gt; assertion),
  param_precise P -&gt; <span class="kr">forall</span> <span class="nv">x</span>, precise (P x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion),
param_precise P -&gt; <span class="kr">forall</span> <span class="nv">x</span> : X, precise (P x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion),
param_precise P -&gt; <span class="kr">forall</span> <span class="nv">x</span> : X, precise (P x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14d"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">edestruct</span> (H x x h1 h2 h1&#39; h2&#39;); <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14e"><span class="kn">Remark</span> <span class="nf">precise_param_precise</span>:
  <span class="kr">forall</span> <span class="nv">P</span>, precise P -&gt; param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion,
precise P -&gt; param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk14f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion,
precise P -&gt; param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk150"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk151"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk152" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P h1&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk152"><hr></label><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk153"><span class="nb">destruct</span> x1, x2; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>unit</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk154"><span class="kn">Lemma</span> <span class="nf">pure_precise</span>: <span class="kr">forall</span> <span class="nv">P</span>,
  precise (pure P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Prop</span>, precise (pure P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk155"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Prop</span>, precise (pure P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk156"><span class="nb">unfold</span> pure; <span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>P /\ h1 = hempty</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P /\ h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk157"><span class="nb">destruct</span> H2, H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Prop</span></span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk158"><span class="kn">Lemma</span> <span class="nf">pure_param_precise</span>: <span class="kr">forall</span> (<span class="nv">X</span>: <span class="kt">Type</span>) (<span class="nv">P</span>: X -&gt; <span class="kt">Prop</span>),
  (<span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span>, P x1 -&gt; P x2 -&gt; x1 = x2) -&gt;
  param_precise (<span class="kr">fun</span> <span class="nv">x</span> =&gt; pure (P x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; <span class="kt">Prop</span>),
(<span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2) -&gt;
param_precise (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; pure (P x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk159"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; <span class="kt">Prop</span>),
(<span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2) -&gt;
param_precise (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; pure (P x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15a"><span class="nb">unfold</span> pure; <span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x1 /\ h1 = hempty</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x2 /\ h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15b"><span class="nb">destruct</span> H3, H4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x1</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x1</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk15d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x1</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>h1&#39; = hempty</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk15d"><hr></label><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15e"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x1</span> <span class="nv">x2</span> : X, P x1 -&gt; P x2 -&gt; x1 = x2</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>P x1</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h1 = hempty</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>P x2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>h1&#39; = hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk15f"><span class="kn">Lemma</span> <span class="nf">contains_param_precise</span>: <span class="kr">forall</span> <span class="nv">l</span>,
  param_precise (<span class="kr">fun</span> <span class="nv">v</span> =&gt; contains l v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
param_precise (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk160"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr,
param_precise (<span class="kr">fun</span> <span class="nv">v</span> : Z =&gt; contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk161"><span class="nb">unfold</span> contains; <span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l x1 hempty</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>h1&#39; = hupdate l x2 hempty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk162"><span class="nb">assert</span> (E: hunion h1 h2 l = hunion h1&#39; h2&#39; l) <span class="bp">by</span> <span class="bp">congruence</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l x1 hempty</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>h1&#39; = hupdate l x2 hempty</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 l = hunion h1&#39; h2&#39; l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk163"><span class="nb">cbn</span> <span class="kr">in</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>h1 = hupdate l x1 hempty</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>h1&#39; = hupdate l x2 hempty</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h2 l) =
(<span class="kr">if</span> h1&#39; l <span class="kr">then</span> h1&#39; l <span class="kr">else</span> h2&#39; l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk164"><span class="nb">subst</span> h1 h1&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x1 hempty) h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l x1 hempty) h2 =
hunion (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> hupdate l x1 hempty l
 <span class="kr">then</span> hupdate l x1 hempty l
 <span class="kr">else</span> h2 l) =
(<span class="kr">if</span> hupdate l x2 hempty l
 <span class="kr">then</span> hupdate l x2 hempty l
 <span class="kr">else</span> h2&#39; l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ hupdate l x1 hempty = hupdate l x2 hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk165"><span class="nb">rewrite</span> ! hupdate_same <span class="kr">in</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x1 hempty) h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l x1 hempty) h2 =
hunion (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>Some x1 = Some x2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ hupdate l x1 hempty = hupdate l x2 hempty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk166"><span class="nb">replace</span> x2 <span class="kr">with</span> x1 <span class="bp">by</span> <span class="bp">congruence</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br><span><var>h2, h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x1 hempty) h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hunion (hupdate l x1 hempty) h2 =
hunion (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint (hupdate l x2 hempty) h2&#39;</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>Some x1 = Some x2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x1 /\ hupdate l x1 hempty = hupdate l x1 hempty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk167"><span class="kn">Lemma</span> <span class="nf">contains_precise</span>: <span class="kr">forall</span> <span class="nv">l</span> <span class="nv">v</span>,
  precise (contains l v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z), precise (contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk168"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">l</span> : addr) (<span class="nv">v</span> : Z), precise (contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk169"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">precise (contains l v)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16a"><span class="nb">apply</span> param_precise_precise.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">param_precise (contains l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> contains_param_precise.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16b"><span class="kn">Lemma</span> <span class="nf">aexists_precise</span>: <span class="kr">forall</span> (<span class="nv">X</span>: <span class="kt">Type</span>) (<span class="nv">P</span>: X -&gt; assertion),
  param_precise P -&gt; precise (aexists P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion),
param_precise P -&gt; precise (aexists P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : X -&gt; assertion),
param_precise P -&gt; precise (aexists P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16d"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>aexists P h1</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>aexists P h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16e"><span class="nb">destruct</span> H3 <span class="kr">as</span> (x1 &amp; P1), H4 <span class="kr">as</span> (x2 &amp; P2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P x1 h1</span></span></span><br><span><var>x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P x2 h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eapply</span> H; <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk16f"><span class="kn">Lemma</span> <span class="nf">valid_precise</span>: <span class="kr">forall</span> <span class="nv">l</span>,
  precise (valid l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr, precise (valid l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk170"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : addr, precise (valid l)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk171"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">precise (valid l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk172"><span class="nb">apply</span> aexists_precise.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">param_precise (contains l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> contains_param_precise.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk173"><span class="kn">Lemma</span> <span class="nf">sepconj_param_precise</span>: <span class="kr">forall</span> (<span class="nv">X</span>: <span class="kt">Type</span>) (<span class="nv">P</span> <span class="nv">Q</span>: X -&gt; assertion),
  param_precise P -&gt; (<span class="kr">forall</span> <span class="nv">x</span>, precise (Q x)) -&gt;
  param_precise (<span class="kr">fun</span> <span class="nv">x</span> =&gt; P x ** Q x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> <span class="nv">Q</span> : X -&gt; assertion),
param_precise P -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)) -&gt;
param_precise (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; P x ** Q x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk174"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">P</span> <span class="nv">Q</span> : X -&gt; assertion),
param_precise P -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)) -&gt;
param_precise (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; P x ** Q x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk175"><span class="nb">intros</span>; <span class="nb">red</span>; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>(P x1 ** Q x1) h1</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>(P x2 ** Q x2) h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk176"><span class="nb">destruct</span> H4 <span class="kr">as</span> (h3 &amp; h4 &amp; P3 &amp; Q4 &amp; D &amp; E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h1 = hunion h3 h4</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>(P x2 ** Q x2) h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk177"><span class="nb">destruct</span> H5 <span class="kr">as</span> (h3&#39; &amp; h4&#39; &amp; P3&#39; &amp; Q4&#39; &amp; D&#39; &amp; E&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h1, h2, h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion h1 h2 = hunion h1&#39; h2&#39;</span></span></span><br><span><var>h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h1 = hunion h3 h4</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h1&#39; = hunion h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk178"><span class="nb">subst</span> h1 h1&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk179"><span class="nb">assert</span> (x1 = x2 /\ h3 = h3&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h3 = h3&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk17a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>x1 = x2 /\ h3 = h3&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk17a"><hr></label><div class="goal-conclusion">x1 = x2 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk17b">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ h3 = h3&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk17c"><span class="nb">apply</span> H <span class="kr">with</span> (hunion h4 h2) (hunion h4&#39; h2&#39;); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h3 (hunion h4 h2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk17d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk17d"><hr></label><div class="goal-conclusion">hdisjoint h3&#39; (hunion h4&#39; h2&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk17e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk17e"><hr></label><div class="goal-conclusion">hunion h3 (hunion h4 h2) = hunion h3&#39; (hunion h4&#39; h2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk17f">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h3&#39; (hunion h4&#39; h2&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk180" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk180"><hr></label><div class="goal-conclusion">hunion h3 (hunion h4 h2) = hunion h3&#39; (hunion h4&#39; h2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk181">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h3 (hunion h4 h2) = hunion h3&#39; (hunion h4&#39; h2&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk182"><span class="nb">rewrite</span> &lt;- ! hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion (hunion h3 h4) h2 = hunion (hunion h3&#39; h4&#39;) h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk183">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>x1 = x2 /\ h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk184"><span class="nb">destruct</span> H4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1, x2</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x2 h3&#39;</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x2 h4&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>x1 = x2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x2 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk185"><span class="nb">subst</span> x2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x1 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk186"><span class="nb">assert</span> (h4 = h4&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h4 = h4&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk187" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>h4 = h4&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk187"><hr></label><div class="goal-conclusion">x1 = x1 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk188">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h4 = h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk189"><span class="nb">apply</span> (H0 x1) <span class="kr">with</span> (hunion h3 h2) (hunion h3&#39; h2&#39;); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h4 (hunion h3 h2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk18a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk18a"><hr></label><div class="goal-conclusion">hdisjoint h4&#39; (hunion h3&#39; h2&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="Separation-v-chk18b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk18b"><hr></label><div class="goal-conclusion">hunion h4 (hunion h3 h2) = hunion h4&#39; (hunion h3&#39; h2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk18c">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h4&#39; (hunion h3&#39; h2&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk18d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk18d"><hr></label><div class="goal-conclusion">hunion h4 (hunion h3 h2) = hunion h4&#39; (hunion h3&#39; h2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk18e">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h4 (hunion h3 h2) = hunion h4&#39; (hunion h3&#39; h2&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk18f"><span class="nb">rewrite</span> &lt;- ! hunion_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion (hunion h4 h3) h2 = hunion (hunion h4&#39; h3&#39;) h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk190"><span class="nb">rewrite</span> (hunion_comm h3) <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion (hunion h3 h4) h2 = hunion (hunion h4&#39; h3&#39;) h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk191"><span class="nb">rewrite</span> (hunion_comm h3&#39;) <span class="bp">by</span> HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion (hunion h3 h4) h2 = hunion (hunion h3&#39; h4&#39;) h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk192">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>X -&gt; assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>param_precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, precise (Q x)</span></span></span><br><span><var>x1</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>h2, h2', h3, h4</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3 h4) h2</span></span></span><br><span><var>h3', h4'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>hunion (hunion h3 h4) h2 =
hunion (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>hdisjoint (hunion h3&#39; h4&#39;) h2&#39;</span></span></span><br><span><var>P3</var><span class="hyp-type"><b>: </b><span>P x1 h3</span></span></span><br><span><var>Q4</var><span class="hyp-type"><b>: </b><span>Q x1 h4</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h3 h4</span></span></span><br><span><var>Q4'</var><span class="hyp-type"><b>: </b><span>Q x1 h4&#39;</span></span></span><br><span><var>P3'</var><span class="hyp-type"><b>: </b><span>P x1 h3&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h3&#39; h4&#39;</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>h3 = h3&#39;</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>h4 = h4&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x1 = x1 /\ hunion h3 h4 = hunion h3&#39; h4&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">subst</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk193"><span class="kn">Lemma</span> <span class="nf">sepconj_precise</span>: <span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span>,
  precise P -&gt; precise Q -&gt; precise (P ** Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
precise P -&gt; precise Q -&gt; precise (P ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk194"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> <span class="nv">Q</span> : assertion,
precise P -&gt; precise Q -&gt; precise (P ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk195"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">precise (P ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk196"><span class="nb">assert</span> (param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk197" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk197"><hr></label><div class="goal-conclusion">precise (P ** Q)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk198">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk199"><span class="nb">apply</span> sepconj_param_precise.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk19a"><hr></label><div class="goal-conclusion">unit -&gt; precise Q</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk19b"><span class="nb">apply</span> precise_param_precise; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unit -&gt; precise Q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk19c">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">precise (P ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk19d"><span class="nb">apply</span> param_precise_precise <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>precise (P ** Q)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">precise (P ** Q)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk19e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk19e"><hr></label><div class="goal-conclusion">unit</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk19f"><span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>param_precise (<span class="kr">fun</span> <span class="nv">_</span> : unit =&gt; P ** Q)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unit</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> tt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Distributivity laws for precise assertions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a0"><span class="kn">Lemma</span> <span class="nf">sepconj_and_distr_1</span>: <span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span>,
  aand P1 P2 ** Q --&gt;&gt; aand (P1 ** Q) (P2 ** Q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span> : assertion,
aand P1 P2 ** Q --&gt;&gt; aand (P1 ** Q) (P2 ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span> : assertion,
aand P1 P2 ** Q --&gt;&gt; aand (P1 ** Q) (P2 ** Q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> P1 P2 Q h (h1 &amp; h2 &amp; (P11 &amp; P21) &amp; Q2 &amp; D &amp; E); <span class="nb">split</span>; <span class="kr">exists</span> <span class="nv">h1</span>, h2; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a2"><span class="kn">Lemma</span> <span class="nf">sepconj_and_distr_2</span>: <span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span>,
  precise Q -&gt;
  aand (P1 ** Q) (P2 ** Q) --&gt;&gt; aand P1 P2 ** Q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span> : assertion,
precise Q -&gt;
aand (P1 ** Q) (P2 ** Q) --&gt;&gt; aand P1 P2 ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P1</span> <span class="nv">P2</span> <span class="nv">Q</span> : assertion,
precise Q -&gt;
aand (P1 ** Q) (P2 ** Q) --&gt;&gt; aand P1 P2 ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a4"><span class="nb">intros</span> P1 P2 Q PQ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aand (P1 ** Q) (P2 ** Q) --&gt;&gt; aand P1 P2 ** Q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a5"><span class="nb">rewrite</span> (sepconj_comm P1), (sepconj_comm P2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">aand (Q ** P1) (Q ** P2) --&gt;&gt; aand P1 P2 ** Q</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a6"><span class="nb">intros</span> h ((h1 &amp; h2 &amp; Q1 &amp; P12 &amp; D &amp; E) &amp; (h1&#39; &amp; h2&#39; &amp; Q1&#39; &amp; P22 &amp; D&#39; &amp; E&#39;)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a7"><span class="nb">assert</span> (h1 = h1&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h1 = h1&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1a8"><hr></label><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1a9">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1aa"><span class="nb">apply</span> PQ <span class="kr">with</span> h2 h2&#39;; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 = hunion h1&#39; h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1ab">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 = hunion h1&#39; h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1ac">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 = hunion h1&#39; h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1ad">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h1', h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1&#39;</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1&#39; h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1&#39; h2&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h1 = h1&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1ae"><span class="nb">subst</span> h1&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1af"><span class="nb">assert</span> (h2 = h2&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 = h2&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1b0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h2 = h2&#39;</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1b0"><hr></label><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b1">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h2 = h2&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hunion_invert_r <span class="kr">with</span> h1; <span class="nb">auto</span>; <span class="bp">congruence</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b2">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>h2'</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2&#39;</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2&#39;</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>h2 = h2&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b3"><span class="nb">subst</span> h2&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(aand P1 P2 ** Q) h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b4"><span class="nb">unfold</span> aand; <span class="kr">exists</span> <span class="nv">h2</span>, h1; <span class="nb">intuition</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h2 h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1b5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1b5"><hr></label><div class="goal-conclusion">h = hunion h2 h1</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b6">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P1, P2, Q</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>PQ</var><span class="hyp-type"><b>: </b><span>precise Q</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>Q1</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>P12</var><span class="hyp-type"><b>: </b><span>P1 h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>Q1'</var><span class="hyp-type"><b>: </b><span>Q h1</span></span></span><br><span><var>D'</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E'</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>P22</var><span class="hyp-type"><b>: </b><span>P2 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h = hunion h2 h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> hunion_comm <span class="bp">by</span> HDISJ; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Self-conjunction law for precise assertions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b7"><span class="kn">Lemma</span> <span class="nf">sepconj_self</span>: <span class="kr">forall</span> <span class="nv">P</span>,
  precise P -&gt;
  P ** P --&gt;&gt; P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, precise P -&gt; P ** P --&gt;&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : assertion, precise P -&gt; P ** P --&gt;&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1b9"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ** P --&gt;&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1ba"><span class="nb">intros</span> h (h1 &amp; h2 &amp; P1 &amp; P2 &amp; D &amp; E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1bb"><span class="nb">assert</span> (h1 = h2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h2</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1bc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h1 = h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1bc"><hr></label><div class="goal-conclusion">P h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1bd">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h1 = h2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1be"><span class="nb">apply</span> H <span class="kr">with</span> h2 h1; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hdisjoint h2 h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1bf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1bf"><hr></label><div class="goal-conclusion">hunion h1 h2 = hunion h2 h1</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c0">HDISJ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hunion h1 h2 = hunion h2 h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> hunion_comm; HDISJ.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c1">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1, h2</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h2</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h2</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h2</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h1 = h2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c2"><span class="nb">subst</span> h2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c3"><span class="nb">assert</span> (h = h1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h = h1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="Separation-v-chk1c4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h = h1</span></span></span><br></div><label class="goal-separator" for="Separation-v-chk1c4"><hr></label><div class="goal-conclusion">P h</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c5">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h = h1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c6"><span class="nb">apply</span> heap_extensionality; <span class="nb">intros</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">h l = h1 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c7"><span class="nb">rewrite</span> E; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>addr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> h1 l <span class="kr">then</span> h1 l <span class="kr">else</span> h1 l) = h1 l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (h1 l); <span class="nb">auto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="Separation-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="Separation-v-chk1c8">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>assertion</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>precise P</span></span></span><br><span><var>h, h1</var><span class="hyp-type"><b>: </b><span>heap</span></span></span><br><span><var>P1</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>h = hunion h1 h1</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span>hdisjoint h1 h1</span></span></span><br><span><var>P2</var><span class="hyp-type"><b>: </b><span>P h1</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>h = h1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>